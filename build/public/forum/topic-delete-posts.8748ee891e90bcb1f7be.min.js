"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[36558,70565,83014,99617,11383,74344,55253],{55253:(A,P,l)=>{var h,g;h=[l(3547),l(7927),l(74344)],g=function(d,a,m){const c={};let o,f,u,y;c.init=function(){y=ajaxify.data.tid,$(window).off("action:ajaxify.end",s).on("action:ajaxify.end",s),!o&&app.parseAndTranslate("modals/delete-posts",{},function(n){o=n,$("body").append(o),f=o.find("#delete_posts_confirm"),u=o.find("#purge_posts_confirm"),o.find("#delete_posts_cancel").on("click",e),d.init(function(){t(),p()}),p(),f.on("click",function(){i(f,r=>`/posts/${r}/state`)}),u.on("click",function(){i(u,r=>`/posts/${r}`)})})};function s(){(ajaxify.data.template.name!=="topic"||ajaxify.data.tid!==y)&&(e(),$(window).off("action:ajaxify.end",s))}function i(n,r){n.attr("disabled",!0),Promise.all(d.pids.map(E=>m.del(r(E),{}))).then(e).catch(a.error).finally(()=>{n.removeAttr("disabled")})}function p(){d.pids.length?o.find("#pids").translateHtml("[[topic:fork_pid_count, "+d.pids.length+"]]"):o.find("#pids").translateHtml("[[topic:fork_no_pids]]")}function t(){d.pids.length?(f.removeAttr("disabled"),u.removeAttr("disabled")):(f.attr("disabled",!0),u.attr("disabled",!0))}function e(){o&&(o.remove(),o=null,d.disable())}return c}.apply(P,h),g!==void 0&&(A.exports=g)},74344:(A,P,l)=>{l.r(P),l.d(P,{del:()=>p,get:()=>f,head:()=>u,patch:()=>s,post:()=>y,put:()=>i});var h=l(85233),g=l.n(h),d=l(63281),a=l.n(d);const m=config.relative_path+"/api/v3";function c(t,e){if(t.url=t.url.startsWith("/api")?config.relative_path+t.url:m+t.url,typeof e=="function"){o(t,e);return}return new Promise((n,r)=>{o(t,function(E,x){if(E)return E.message==="A valid login session was not found. Please log in and try again."?(0,d.confirm)("[[error:api.reauth-required]]",k=>{k&&ajaxify.go("login")}):r(E);n(x)})})}async function o(t,e){const{url:n}=t;delete t.url,t.data&&!(t.data instanceof FormData)&&(t.data=JSON.stringify(t.data||{}),t.headers["content-type"]="application/json; charset=utf-8"),{options:t}=await(0,h.fire)("filter:api.options",{options:t}),t.data&&(t.body=t.data,delete t.data);const r=await fetch(n,t),{headers:E}=r,x=E.get("content-type"),k=x&&x.startsWith("application/json");let _;if(k?_=await r.json():_=await r.text(),!r.ok)return e(new Error(k?_.status.message:_));e(null,k&&_.hasOwnProperty("status")&&_.hasOwnProperty("response")?_.response:_)}function f(t,e,n){return c({url:t+(e&&Object.keys(e).length?"?"+$.param(e):"")},n)}function u(t,e,n){return c({url:t+(e&&Object.keys(e).length?"?"+$.param(e):""),method:"head"},n)}function y(t,e,n){return c({url:t,method:"post",data:e,headers:{"x-csrf-token":config.csrf_token}},n)}function s(t,e,n){return c({url:t,method:"patch",data:e,headers:{"x-csrf-token":config.csrf_token}},n)}function i(t,e,n){return c({url:t,method:"put",data:e,headers:{"x-csrf-token":config.csrf_token}},n)}function p(t,e,n){return c({url:t,method:"delete",data:e,headers:{"x-csrf-token":config.csrf_token}},n)}},3547:(A,P,l)=>{var h,g;h=[l(7237)],g=function(d){const a={};let m;a.pids=[];let c=!1;a.init=function(s,i){a.pids.length=0,m=s,i=i||{},c=i.allowMainPostSelect||!1,$("#content").on("click",'[component="topic"] [component="post"]',o),u()};function o(s){s.stopPropagation();const i=$(this).attr("data-pid"),p=$('[component="topic"] [data-pid="'+i+'"]');!c&&parseInt($(this).attr("data-index"),10)===0||a.togglePostSelection(p,i)}a.disable=function(){a.pids.forEach(function(s){d.get("post","pid",s).toggleClass("selected",!1)}),$("#content").off("click",'[component="topic"] [component="post"]',o),y()},a.togglePostSelection=function(s,i){if(i){const p=a.pids.indexOf(i);p===-1?(a.pids.push(i),s.toggleClass("selected",!0)):(a.pids.splice(p,1),s.toggleClass("selected",!1)),a.pids.length&&a.pids.sort(function(t,e){return t-e}),typeof m=="function"&&m()}};function f(){return!1}function u(){$("#content").on("click",'[component="post"] button, [component="post"] a',f)}function y(){$("#content").off("click",'[component="post"] button, [component="post"] a',f)}return a}.apply(P,h),g!==void 0&&(A.exports=g)}}]);
