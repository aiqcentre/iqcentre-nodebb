"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[63388,48724,86815,61237],{59016:(C,g,s)=>{var d,u;d=[s(4695),s(80431),s(50395),s(7927)],u=function(p,f,h,l){const r={};r.prepareDOM=function(){app.user.uid>0&&p.initUnreadTopics(),f.prepareDOM(),h.prepareDOM(),t(),o(),e()};function t(){$('[component="header/usercontrol"] [data-status]').off("click").on("click",function(a){const n=$(this).attr("data-status");socket.emit("user.setStatus",n,function(i){if(i)return l.error(i);$('[data-uid="'+app.user.uid+'"] [component="user/status"], [component="header/profilelink"] [component="user/status"]').removeClass("away online dnd offline").addClass(n),$('[component="header/usercontrol"] [data-status]').each(function(){$(this).toggleClass("selected",$(this).attr("data-status")===n)}),app.user.status=n}),a.preventDefault()})}function o(){const a=utils.findBootstrapEnvironment();a==="xs"||a==="sm"||utils.isTouchDevice()||$("#header-menu #main-nav").tooltip({selector:".nav-item",placement:"bottom",trigger:"hover",container:"body",animation:!1})}function e(){$("body").on("click",'[component="user/logout"]',function(){return s.e(70145).then(function(){var a=[s(39002)];(function(n){n()}).apply(null,a)}).catch(s.oe),!1})}return r}.apply(g,d),u!==void 0&&(C.exports=u)},50395:(C,g,s)=>{var d,u;d=[s(7237),s(85233)],u=function(p,f){const h={};h.prepareDOM=function(){const e=$('[component="chat/dropdown"]');e.length&&(e.on("show.bs.dropdown",a=>{o("loadChatsDropdown",$(a.target).parent().find('[component="chat/list"]'))}),e.each((a,n)=>{const i=$(n).parent().find(".dropdown-menu");i.hasClass("show")&&o("loadChatsDropdown",i.find('[component="chat/list"]'))}),socket.removeListener("event:chats.receive",l),socket.on("event:chats.receive",l),socket.removeListener("event:user_status_change",r),socket.on("event:user_status_change",r),socket.removeListener("event:chats.roomRename",t),socket.on("event:chats.roomRename",t),socket.on("event:unread.updateChatCount",async function(a){if(a){const[m,v]=await app.require(["chat","forum/chats"]);if(m.isFromBlockedUser(a.fromUid)||m.isLookingAtRoom(a.roomId)||app.user.uid===parseInt(a.fromUid,10))return;v.markChatPageElUnread(a)}let n=await socket.emit("modules.chats.getUnreadCount",{});const i=p.get("chat/icon");n=Math.max(0,n),i.toggleClass("fa-comment",n>0).toggleClass("fa-comment-o",n<=0);const c=n>99?"99+":n;p.get("chat/icon").toggleClass("unread-count",n>0).attr("data-content",c),p.get("chat/count").toggleClass("hidden",n<=0).text(c),f.fire("action:chat.updateCount",{count:n})}))};function l(e){o("onChatMessageReceived",e)}function r(e){o("onUserStatusChange",e)}function t(e){o("onRoomRename",e)}async function o(e,a){(await app.require("chat"))[e](a)}return h}.apply(g,d),u!==void 0&&(C.exports=u)},80431:(C,g,s)=>{var d,u;d=[s(7237)],u=function(p){const f={};f.prepareDOM=function(){const t=p.get("notifications"),o=t.children("a"),e=p.get("notifications/list");o.on("click",function(a){a.preventDefault(),!t.hasClass("open")&&r("loadNotifications",e)}),o.parents(".dropdown").hasClass("open")&&r("loadNotifications",e),socket.removeListener("event:new_notification",h),socket.on("event:new_notification",h),socket.removeListener("event:notifications.updateCount",l),socket.on("event:notifications.updateCount",l)};function h(t){r("onNewNotification",t)}function l(t){r("updateNotifCount",t)}function r(t,o){Promise.all([s.e(38786),s.e(70071)]).then(function(){var e=[s(69986)];(function(a){a[t](o)}).apply(null,e)}).catch(s.oe)}return f}.apply(g,d),u!==void 0&&(C.exports=u)},4695:(C,g,s)=>{var d,u;d=[s(85233)],u=function(p){const f={},h={ignoring:1,notwatching:2,watching:3};f.initUnreadTopics=function(){const t=app.user.unreadData;function o(n){if(n&&n.posts&&n.posts.length&&t){const i=n.posts[0];if(parseInt(i.uid,10)===parseInt(app.user.uid,10)||!i.topic.isFollowing&&i.categoryWatchState!==h.watching)return;const c=i.topic.tid;(!t[""][c]||!t.new[c]||!t.watched[c]||!t.unreplied[c])&&a(c),t[""][c]||(e(""),t[""][c]=!0),i.isMain&&parseInt(i.uid,10)!==parseInt(app.user.uid,10)&&!t.new[c]&&(e("new"),t.new[c]=!0),parseInt(i.topic.postcount,10)<=1&&!t.unreplied[c]&&(e("unreplied"),t.unreplied[c]=!0),i.topic.isFollowing&&!t.watched[c]&&(e("watched"),t.watched[c]=!0)}}function e(n){const i="/unread"+(n?"?filter="+n:""),c=1+parseInt($('a[href="'+config.relative_path+i+'"].navigation-link i').attr("data-content"),10);r(i,c)}function a(n){$('[data-tid="'+n+'"]').addClass("unread")}$(window).on("action:ajaxify.end",function(){ajaxify.data.template.topic&&["","new","watched","unreplied"].forEach(function(n){delete t[n][ajaxify.data.tid]})}),socket.removeListener("event:new_post",o),socket.on("event:new_post",o),socket.removeListener("event:unread.updateCount",l),socket.on("event:unread.updateCount",l)};function l(t){r("/unread",t.unreadTopicCount),r("/unread?filter=new",t.unreadNewTopicCount),r("/unread?filter=watched",t.unreadWatchedTopicCount),r("/unread?filter=unreplied",t.unreadUnrepliedTopicCount)}function r(t,o){if(!utils.isNumber(o))return;o=Math.max(0,o);const e=o>99?"99+":o,a=$('a[href="'+config.relative_path+t+'"].navigation-link');a.find("i").toggleClass("unread-count",o>0).attr("data-content",e),a.find('[component="navigation/count"]').toggleClass("hidden",o<=0).text(o),$('#mobile-menu [data-unread-url="'+t+'"]').attr("data-content",e),$('[component="unread/count"][data-unread-url="'+t+'"]').toggleClass("hidden",o<=0).text(e),p.fire("action:unread.updateCount",{url:t,count:o})}return f.updateUnreadTopicCount=r,f}.apply(g,d),u!==void 0&&(C.exports=u)}}]);
