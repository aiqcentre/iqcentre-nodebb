"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[20670,66623,49286,11383],{25636:(h,C,g)=>{var p,f;p=[g(7237),g(3547),g(7927),g(50548)],f=function(k,c,m,d){const n={};let e,o,i,t;n.init=function(){i=ajaxify.data.tid,t=ajaxify.data.category,$(window).off("action:ajaxify.end",a).on("action:ajaxify.end",a),!e&&app.parseAndTranslate("modals/fork-topic",{selectedCategory:t},function(y){e=y,o=e.find("#fork_thread_commit"),$("body").append(e),d.init(e.find('[component="category-selector"]'),{onSelect:function(E){t=E},privilege:"moderate"}),e.find("#fork_thread_cancel").on("click",u),e.find("#fork-title").on("keyup",r),c.init(function(){r(),s()}),s(),o.on("click",l)})};function a(){(ajaxify.data.template.name!=="topic"||ajaxify.data.tid!==i)&&(u(),$(window).off("action:ajaxify.end",a))}function l(){t&&(o.attr("disabled",!0),socket.emit("topics.createTopicFromPosts",{title:e.find("#fork-title").val(),pids:c.pids,fromTid:i,cid:t.cid},function(y,E){function b(A){k.get("post","pid",A).fadeOut(500,function(){$(this).remove()})}if(o.removeAttr("disabled"),y)return m.error(y.message);m.alert({timeout:5e3,title:"[[global:alert.success]]",message:"[[topic:fork_success]]",type:"success",clickfn:function(){ajaxify.go("topic/"+E.slug)}}),c.pids.forEach(function(A){b(A)}),u()}))}function s(){c.pids.length?e.find("#fork-pids").translateHtml("[[topic:fork_pid_count, "+c.pids.length+"]]"):e.find("#fork-pids").translateHtml("[[topic:fork_no_pids]]")}function r(){e.find("#fork-title").val().length&&c.pids.length?o.removeAttr("disabled"):o.attr("disabled",!0)}function u(){e&&(e.remove(),e=null,c.disable())}return n}.apply(C,p),f!==void 0&&(h.exports=f)},22905:(h,C,g)=>{var p,f;p=[g(7927),g(73138)],f=function(k,c){const m={};return m.init=function(d,n){let e=null;n=n||{},n.privilege=n.privilege||"topics:read",n.states=n.states||["watching","notwatching","ignoring"],n.cacheList=n.hasOwnProperty("cacheList")?n.cacheList:!0;let o=[];Array.isArray(n.localCategories)&&(o=n.localCategories.map(s=>({...s}))),n.selectedCids=n.selectedCids||ajaxify.data.selectedCids||[];const i=d.find('[component="category-selector-search"]');if(!i.length)return;const t=i.parent('[component="category/dropdown"]').length>0||i.parent('[component="category-selector"]').length>0;d.on("show.bs.dropdown",function(){t&&(d.find(".dropdown-toggle").css({visibility:"hidden"}),i.removeClass("hidden"),i.css({"z-index":d.find(".dropdown-toggle").css("z-index")+1}));function s(){const r=i.find("input").val();r.length>1||!r&&!e?a(r,function(u){e=n.cacheList&&(e||u),l(u)}):!r&&e&&l(e)}i.on("click",function(r){r.preventDefault(),r.stopPropagation()}),i.find("input").val("").on("keyup",utils.debounce(s,300)),s()}),d.on("shown.bs.dropdown",function(){["xs","sm"].includes(utils.findBootstrapEnvironment())||i.find("input").focus()}),d.on("hide.bs.dropdown",function(){t&&(d.find(".dropdown-toggle").css({visibility:"inherit"}),i.addClass("hidden")),i.off("click"),i.find("input").off("keyup")});function a(s,r){socket.emit("categories.categorySearch",{search:s,query:utils.params(),parentCid:n.parentCid||0,selectedCids:n.selectedCids,privilege:n.privilege,states:n.states,showLinks:n.showLinks},function(u,y){if(u)return k.error(u);r(o.concat(y))})}function l(s){const r=n.selectedCids.map(String);s.forEach(function(u){u.selected=r.includes(String(u.cid))}),app.parseAndTranslate(n.template,{categoryItems:s.slice(0,200),selectedCategory:ajaxify.data.selectedCategory,allCategoriesUrl:ajaxify.data.allCategoriesUrl},function(u){d.find('[component="category/list"]').html(u.find('[component="category/list"]').html()),d.find('[component="category/list"] [component="category/no-matches"]').toggleClass("hidden",!!s.length);const y=c.Dropdown.getInstance(d.find(".dropdown-toggle").get(0));y&&y.update()})}},m}.apply(C,p),f!==void 0&&(h.exports=f)},50548:(h,C,g)=>{var p,f;p=[g(22905),g(63281),g(85233),g(32230)],f=function(k,c,m,d){const n={};return n.init=function(e,o){if(!e||!e.length)return;o=o||{};const i=o.onSelect||function(){};o.states=o.states||["watching","notwatching","ignoring"],o.template=o.template||"partials/category/selector-dropdown-left",m.fire("action:category.selector.options",{el:e,options:o}),k.init(e,o);const t={el:e,selectedCategory:null};e.on("click","[data-cid]",function(){const l=$(this);return l.hasClass("disabled")?!1:(t.selectCategory(l.attr("data-cid")),i(t.selectedCategory))});let a=t.el.find('[component="category-selector-selected"]').html();return d.translate(a,l=>{a=l}),t.selectCategory=function(l){const s=t.el.find('[data-cid="'+l+'"]');t.selectedCategory={cid:l,name:s.attr("data-name")},s.length?t.el.find('[component="category-selector-selected"]').html(s.find('[component="category-markup"]').html()):t.el.find('[component="category-selector-selected"]').html(a)},t.getSelectedCategory=function(){return t.selectedCategory},t.getSelectedCid=function(){return t.selectedCategory?t.selectedCategory.cid:0},o.hasOwnProperty("selectedCategory")&&app.parseAndTranslate(o.template,{selectedCategory:o.selectedCategory},function(l){t.el.find('[component="category-selector-selected"]').html(l.find('[component="category-selector-selected"]').html())}),t},n.modal=function(e){e=e||{},e.onSelect=e.onSelect||function(){},e.onSubmit=e.onSubmit||function(){},app.parseAndTranslate("admin/partials/categories/select-category",{message:e.message},function(o){const i=c.dialog({title:e.title||"[[modules:composer.select_category]]",message:o,buttons:{save:{label:"[[global:select]]",className:"btn-primary",callback:a}}}),t=n.init(i.find('[component="category-selector"]'),e);function a(l){return l.preventDefault(),t.selectedCategory&&(e.onSubmit(t.selectedCategory),i.modal("hide")),!1}e.openOnLoad&&i.on("shown.bs.modal",function(){i.find(".dropdown-toggle").dropdown("toggle")}),i.find("form").on("submit",a)})},n}.apply(C,p),f!==void 0&&(h.exports=f)},3547:(h,C,g)=>{var p,f;p=[g(7237)],f=function(k){const c={};let m;c.pids=[];let d=!1;c.init=function(t,a){c.pids.length=0,m=t,a=a||{},d=a.allowMainPostSelect||!1,$("#content").on("click",'[component="topic"] [component="post"]',n),o()};function n(t){t.stopPropagation();const a=$(this).attr("data-pid"),l=$('[component="topic"] [data-pid="'+a+'"]');!d&&parseInt($(this).attr("data-index"),10)===0||c.togglePostSelection(l,a)}c.disable=function(){c.pids.forEach(function(t){k.get("post","pid",t).toggleClass("selected",!1)}),$("#content").off("click",'[component="topic"] [component="post"]',n),i()},c.togglePostSelection=function(t,a){if(a){const l=c.pids.indexOf(a);l===-1?(c.pids.push(a),t.toggleClass("selected",!0)):(c.pids.splice(l,1),t.toggleClass("selected",!1)),c.pids.length&&c.pids.sort(function(s,r){return s-r}),typeof m=="function"&&m()}};function e(){return!1}function o(){$("#content").on("click",'[component="post"] button, [component="post"] a',e)}function i(){$("#content").off("click",'[component="post"] button, [component="post"] a',e)}return c}.apply(C,p),f!==void 0&&(h.exports=f)}}]);
