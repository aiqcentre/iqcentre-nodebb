"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[87171,70565,53375,83014,99617,74344],{17592:(D,w,i)=>{var m,E;m=[i(25142),i(59006),i(74344),i(63281),i(7927)],E=function(v,M,g,c,u){const s={};return s.init=function(){v.init(s.loadMoreGroups),$('button[data-action="new"]').on("click",function(){c.prompt("[[groups:new-group.group_name]]",function(a){a&&a.length&&g.post("/groups",{name:a}).then(f=>{ajaxify.go("groups/"+f.slug)}).catch(u.error)})});const l=utils.params();$("#search-sort").val(l.sort||"alpha"),$("#search-text").on("keyup",s.search),$("#search-button").on("click",s.search),$("#search-sort").on("change",function(){ajaxify.go("groups?sort="+$("#search-sort").val())})},s.loadMoreGroups=function(l){l<0||v.loadMore("groups.loadMore",{sort:$("#search-sort").val(),after:$('[component="groups/container"]').attr("data-nextstart")},function(a,f){a&&a.groups.length?M.render("partials/groups/list",{groups:a.groups}).then(function(y){$("#groups-list").append(y),f()}):f(),a&&a.nextStart&&$('[component="groups/container"]').attr("data-nextstart",a.nextStart)})},s.search=function(){const l=$("#groups-list"),a=$("#search-text"),f=$("#search-sort");return socket.emit("groups.search",{query:a.val(),options:{sort:f.val(),filterHidden:!0,showMembers:!0,hideEphemeralGroups:!0}},function(y,n){if(y)return u.error(y);n=n.filter(function(t){return t.name!=="registered-users"&&t.name!=="guests"}),M.render("partials/groups/list",{groups:n}).then(function(t){l.empty().append(t)})}),!1},s}.apply(w,m),E!==void 0&&(D.exports=E)},25142:(D,w,i)=>{var m,E;m=[i(85233),i(7927)],E=function(v,M){const g={};let c,u=0,s=!1,l,a=0;g.init=function(n,t){const e=$("body");typeof n=="function"?(c=n,l=e):(c=t,l=n||e),u=$(window).scrollTop(),$(window).off("scroll",f).on("scroll",f),e.height()<=$(window).height()&&c(1)};function f(){a&&clearTimeout(a),a=setTimeout(function(){a=0,y()},60)}function y(){const n=utils.findBootstrapEnvironment(),t=(n==="xs"||n==="sm")&&$("html").hasClass("composing");if(s||t||app.flags._glance)return;const e=$(window).scrollTop(),o=$(window).height(),r=l.height()-o,h=l.offset()?l.offset().top:0,p=100*(e-h)/(r<=0?o:r),x=15,d=85,T=e>u?1:-1;(p<x&&e<u||p>d&&e>u||p<0&&T>0&&r<0)&&c(T),u=e}return g.loadMore=function(n,t,e){if(s)return;s=!0;const o={method:n,data:t};v.fire("action:infinitescroll.loadmore",o),socket.emit(o.method,o.data,function(r,h){if(r)return s=!1,M.error(r);e(h,function(){s=!1})})},g.loadMoreXhr=function(n,t){if(s)return;s=!0;const e=config.relative_path+"/api"+location.pathname.replace(new RegExp("^"+config.relative_path),""),o={url:e,data:n};v.fire("action:infinitescroll.loadmore.xhr",o),$.get(e,n,function(r){t(r,function(){s=!1})}).fail(function(r){s=!1,M.error(String(r.responseJSON||"[[error:no-connection]]"))})},g.removeExtra=function(n,t,e){let o=$();if(n.length<=e)return o;const r=n.length-e;if(t>0){const h=$(document).height(),p=$(window).scrollTop();o=n.slice(0,r).remove(),$(window).scrollTop(p+($(document).height()-h))}else o=n.slice(n.length-r).remove();return o},g}.apply(w,m),E!==void 0&&(D.exports=E)},74344:(D,w,i)=>{i.r(w),i.d(w,{del:()=>n,get:()=>s,head:()=>l,patch:()=>f,post:()=>a,put:()=>y});var m=i(85233),E=i.n(m),v=i(63281),M=i.n(v);const g=config.relative_path+"/api/v3";function c(t,e){if(t.url=t.url.startsWith("/api")?config.relative_path+t.url:g+t.url,typeof e=="function"){u(t,e);return}return new Promise((o,r)=>{u(t,function(h,p){if(h)return h.message==="A valid login session was not found. Please log in and try again."?(0,v.confirm)("[[error:api.reauth-required]]",x=>{x&&ajaxify.go("login")}):r(h);o(p)})})}async function u(t,e){const{url:o}=t;delete t.url,t.data&&!(t.data instanceof FormData)&&(t.data=JSON.stringify(t.data||{}),t.headers["content-type"]="application/json; charset=utf-8"),{options:t}=await(0,m.fire)("filter:api.options",{options:t}),t.data&&(t.body=t.data,delete t.data);const r=await fetch(o,t),{headers:h}=r,p=h.get("content-type"),x=p&&p.startsWith("application/json");let d;if(x?d=await r.json():d=await r.text(),!r.ok)return e(new Error(x?d.status.message:d));e(null,x&&d.hasOwnProperty("status")&&d.hasOwnProperty("response")?d.response:d)}function s(t,e,o){return c({url:t+(e&&Object.keys(e).length?"?"+$.param(e):"")},o)}function l(t,e,o){return c({url:t+(e&&Object.keys(e).length?"?"+$.param(e):""),method:"head"},o)}function a(t,e,o){return c({url:t,method:"post",data:e,headers:{"x-csrf-token":config.csrf_token}},o)}function f(t,e,o){return c({url:t,method:"patch",data:e,headers:{"x-csrf-token":config.csrf_token}},o)}function y(t,e,o){return c({url:t,method:"put",data:e,headers:{"x-csrf-token":config.csrf_token}},o)}function n(t,e,o){return c({url:t,method:"delete",data:e,headers:{"x-csrf-token":config.csrf_token}},o)}}}]);
