"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[64422,54354],{7217:(p,h,c)=>{var u,s;u=[c(25142),c(78942),c(42840),c(14745),c(69241),c(50548),c(85233),c(7927)],s=function(C,m,g,S,f,e,o,i){const t={};$(window).on("action:ajaxify.start",function(a,d){String(d.url).startsWith("category/")||g.disable()}),t.init=function(){const a=ajaxify.data.cid;app.enterRoom("category_"+a),m.addShareHandlers(ajaxify.data.name),S.init("category",b),f.handleSort("categoryTopicSort","category/"+ajaxify.data.slug),config.usePagination?g.disable():g.init('[component="category/topic"]',ajaxify.data.topic_count,t.toTop,t.toBottom),l(),r(a),x(),e.init($('[component="category-selector"]'),{privilege:"find",parentCid:ajaxify.data.cid,onSelect:function(d){ajaxify.go("/category/"+d.cid)}}),o.fire("action:topics.loaded",{topics:ajaxify.data.topics}),o.fire("action:category.loaded",{cid:ajaxify.data.cid})};function l(){let a=ajaxify.data.topicIndex;a&&utils.isNumber(a)&&(a=Math.max(0,parseInt(a,10)),a&&window.location.search.indexOf("page=")===-1&&g.scrollToElement($('[component="category/topic"][data-index="'+a+'"]'),!0,0))}function r(a){$('[component="category/watching"], [component="category/ignoring"], [component="category/notwatching"]').on("click",function(){const n=$(this).attr("data-state");socket.emit("categories.setWatchState",{cid:a,state:n},function(y){if(y)return i.error(y);$('[component="category/watching/menu"]').toggleClass("hidden",n!=="watching"),$('[component="category/watching/check"]').toggleClass("fa-check",n==="watching"),$('[component="category/notwatching/menu"]').toggleClass("hidden",n!=="notwatching"),$('[component="category/notwatching/check"]').toggleClass("fa-check",n==="notwatching"),$('[component="category/ignoring/menu"]').toggleClass("hidden",n!=="ignoring"),$('[component="category/ignoring/check"]').toggleClass("fa-check",n==="ignoring"),i.success("[[category:"+n+".message]]")})})}function x(){$('[component="category/load-more-subcategories"]').on("click",function(){const a=$(this);return socket.emit("categories.loadMoreSubCategories",{cid:ajaxify.data.cid,start:ajaxify.data.nextSubCategoryStart},function(d,n){if(d)return i.error(d);a.toggleClass("hidden",!n.length||n.length<ajaxify.data.subCategoriesPerPage),n.length&&app.parseAndTranslate("category","children",{children:n},function(y){y.find(".timeago").timeago(),$('[component="category/subcategory/container"]').append(y),ajaxify.data.nextSubCategoryStart+=ajaxify.data.subCategoriesPerPage,ajaxify.data.subCategoriesLeft-=n.length,a.toggleClass("hidden",ajaxify.data.subCategoriesLeft<=0).translateText("[[category:x-more-categories, "+ajaxify.data.subCategoriesLeft+"]]")})}),!1})}t.toTop=function(){g.scrollTop(0)},t.toBottom=function(){socket.emit("categories.getTopicCount",ajaxify.data.cid,function(a,d){if(a)return i.error(a);g.scrollBottom(d-1)})};function b(a,d,n){n=n||function(){},o.fire("action:topics.loading");const y=utils.params();C.loadMore("categories.loadMore",{cid:ajaxify.data.cid,after:a,direction:d,query:y,categoryTopicSort:y.sort||config.categoryTopicSort},function(E,A){o.fire("action:topics.loaded",{topics:E.topics}),n(E,A)})}return t}.apply(h,u),s!==void 0&&(p.exports=s)},50548:(p,h,c)=>{var u,s;u=[c(22905),c(63281),c(85233),c(32230)],s=function(C,m,g,S){const f={};return f.init=function(e,o){if(!e||!e.length)return;o=o||{};const i=o.onSelect||function(){};o.states=o.states||["watching","notwatching","ignoring"],o.template=o.template||"partials/category/selector-dropdown-left",g.fire("action:category.selector.options",{el:e,options:o}),C.init(e,o);const t={el:e,selectedCategory:null};e.on("click","[data-cid]",function(){const r=$(this);return r.hasClass("disabled")?!1:(t.selectCategory(r.attr("data-cid")),i(t.selectedCategory))});let l=t.el.find('[component="category-selector-selected"]').html();return S.translate(l,r=>{l=r}),t.selectCategory=function(r){const x=t.el.find('[data-cid="'+r+'"]');t.selectedCategory={cid:r,name:x.attr("data-name")},x.length?t.el.find('[component="category-selector-selected"]').html(x.find('[component="category-markup"]').html()):t.el.find('[component="category-selector-selected"]').html(l)},t.getSelectedCategory=function(){return t.selectedCategory},t.getSelectedCid=function(){return t.selectedCategory?t.selectedCategory.cid:0},o.hasOwnProperty("selectedCategory")&&app.parseAndTranslate(o.template,{selectedCategory:o.selectedCategory},function(r){t.el.find('[component="category-selector-selected"]').html(r.find('[component="category-selector-selected"]').html())}),t},f.modal=function(e){e=e||{},e.onSelect=e.onSelect||function(){},e.onSubmit=e.onSubmit||function(){},app.parseAndTranslate("admin/partials/categories/select-category",{message:e.message},function(o){const i=m.dialog({title:e.title||"[[modules:composer.select_category]]",message:o,buttons:{save:{label:"[[global:select]]",className:"btn-primary",callback:l}}}),t=f.init(i.find('[component="category-selector"]'),e);function l(r){return r.preventDefault(),t.selectedCategory&&(e.onSubmit(t.selectedCategory),i.modal("hide")),!1}e.openOnLoad&&i.on("shown.bs.modal",function(){i.find(".dropdown-toggle").dropdown("toggle")}),i.find("form").on("submit",l)})},f}.apply(h,u),s!==void 0&&(p.exports=s)},69241:(p,h,c)=>{var u,s;u=[c(7237)],s=function(C){const m={};return m.handleSort=function(g,S){const f=C.get("thread/sort");f.find("i").removeClass("fa-check");const e=utils.params().sort||config[g];f.find('a[data-sort="'+e+'"]').find("i").addClass("fa-check"),$("body").off("click",'[component="thread/sort"] a').on("click",'[component="thread/sort"] a',function(){const i=$(this).attr("data-sort"),t=utils.params();t.sort=i;const l=decodeURIComponent($.param(t));ajaxify.go(S+(l?"?"+l:""))})},m}.apply(h,u),s!==void 0&&(p.exports=s)}}]);
