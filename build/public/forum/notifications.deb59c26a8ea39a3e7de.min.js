(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[80152,70071],{96105:(w,F,v)=>{"use strict";var C,p;C=[v(7237),v(69986)],p=function(l,c){const g={};return g.init=function(){const h=$(".notifications-list");h.on("click",'[component="notifications/item/link"]',function(){const m=$(this).parents("[data-nid]").attr("data-nid");c.markNotification(m,!0)}),c.handleUnreadButton(h),l.get("notifications/mark_all").on("click",function(){c.markAllRead(function(){l.get("notifications/item").removeClass("unread")})})},g}.apply(F,C),p!==void 0&&(w.exports=p)},69986:(w,F,v)=>{"use strict";var C,p;C=[v(32230),v(7237),v(42840),v(16943),v(85233),v(7927)],p=function(l,c,g,h,m,f){const o={};let s={};const I=({notifications:i})=>new Promise(a=>{for(let e=0;e<i.length;e+=1)i[e].timeagoLong=$.timeago(new Date(parseInt(i[e].datetime,10)));l.toggleTimeagoShorthand(function(){for(let e=0;e<i.length;e+=1)i[e].timeago=$.timeago(new Date(parseInt(i[e].datetime,10))),i[e].timeagoShort=i[e].timeago;l.toggleTimeagoShorthand(),a({notifications:i})})});m.on("filter:notifications.load",I),o.loadNotifications=function(i,a){a=a||function(){},socket.emit("notifications.get",null,function(e,r){if(e)return f.error(e);const k=r.unread.concat(r.read).sort(function(R,P){return parseInt(R.datetime,10)>parseInt(P.datetime,10)?-1:1});m.fire("filter:notifications.load",{notifications:k}).then(({notifications:R})=>{app.parseAndTranslate("partials/notifications_list",{notifications:R},function(P){i.html(P),i.off("click").on("click","[data-nid]",function(_){const D=$(this);if(B(D)&&(_.stopPropagation(),_.preventDefault(),c.get("notifications/list").dropdown("toggle")),!D.hasClass("unread"))return;const M=D.attr("data-nid");u(M,!0)}),c.get("notifications").on("click",".mark-all-read",o.markAllRead),o.handleUnreadButton(i),m.fire("action:notifications.loaded",{notifications:k,list:i}),a()})})})},o.handleUnreadButton=function(i){i.on("click",".mark-read",function(){const a=$(this),e=a.parents("[data-nid]"),r=e.hasClass("unread"),k=e.attr("data-nid");return u(k,r,function(){e.toggleClass("unread"),a.find(".unread").toggleClass("hidden",r),a.find(".read").toggleClass("hidden",!r)}),!1})},o.onNewNotification=function(i){ajaxify.currentPage==="notifications"&&ajaxify.refresh(),socket.emit("notifications.getCount",function(a,e){if(a)return f.error(a);o.updateNotifCount(e)}),s[i.nid]||(s[i.nid]=!0)},o.markNotification=function(i,a,e){u(i,a,e)};function u(i,a,e){socket.emit("notifications.mark"+(a?"Read":"Unread"),i,function(r){if(r)return f.error(r);a&&s[i]&&delete s[i],e&&e()})}function B(i){const a=i.attr("data-pid"),e=i.attr("data-path"),r=c.get("post","pid",a);return e.startsWith(config.relative_path+"/post/")&&a&&r.length&&ajaxify.data.template.topic?(g.scrollToIndex(r.attr("data-index"),!0),!0):!1}return o.updateNotifCount=function(i){const a=c.get("notifications/icon");i=Math.max(0,i),a.toggleClass("fa-bell",i>0).toggleClass("fa-bell-o",i<=0);const e=i>99?"99+":i;a.toggleClass("unread-count",i>0),a.attr("data-content",e),c.get("notifications/count").toggleClass("hidden",i<=0).text(e);const r={count:i,updateFavicon:!0};m.fire("action:notification.updateCount",r),r.updateFavicon&&h.setBubble(e),g.setAppBadge&&g.setAppBadge(i)},o.markAllRead=function(){socket.emit("notifications.markAllRead",function(i){i&&f.error(i),s={};const a=$('[component="notifications/list"] [data-nid]');a.removeClass("unread"),a.find(".mark-read .unread").addClass("hidden"),a.find(".mark-read .read").removeClass("hidden")})},o}.apply(F,C),p!==void 0&&(w.exports=p)},16943:(w,F,v)=>{var C,p;/*!
* Tinycon - A small library for manipulating the Favicon
* Tom Moor, http://tommoor.com
* Copyright (c) 2015 Tom Moor
* @license MIT Licensed
*/(function(){var l={},c=null,g=null,h=null,m=null,f={},o=Math.ceil(window.devicePixelRatio)||1,s=16*o,I={width:7,height:9,font:10*o+"px arial",color:"#ffffff",background:"#F03D25",fallback:!0,crossOrigin:!0,abbreviate:!0},u=function(){var t=navigator.userAgent.toLowerCase();return function(n){return t.indexOf(n)!==-1}}(),B={ie:u("trident"),chrome:u("chrome"),webkit:u("chrome")||u("safari"),safari:u("safari")&&!u("chrome"),mozilla:u("mozilla")&&!u("chrome")&&!u("safari")},i=function(){for(var t=document.getElementsByTagName("link"),n=0,d=t.length;n<d;n++)if((t[n].getAttribute("rel")||"").match(/\bicon\b/i))return t[n];return!1},a=function(){for(var t=document.getElementsByTagName("link"),n=0,d=t.length;n<d;n++){var T=typeof t[n]<"u";T&&(t[n].getAttribute("rel")||"").match(/\bicon\b/i)&&t[n].parentNode.removeChild(t[n])}},e=function(){if(!g||!c){var t=i();c=t?t.getAttribute("href"):"/favicon.ico",g||(g=c)}return c},r=function(){return m||(m=document.createElement("canvas"),m.width=s,m.height=s),m},k=function(t){if(t){a();var n=document.createElement("link");n.type="image/x-icon",n.rel="icon",n.href=t,document.getElementsByTagName("head")[0].appendChild(n)}},R=function(t){window.console&&window.console.log(t)},P=function(t,T){if(!r().getContext||B.ie||B.safari||f.fallback==="force")return _(t);var d=r().getContext("2d"),T=T||"#000000",S=e();h=document.createElement("img"),h.onload=function(){d.clearRect(0,0,s,s),d.drawImage(h,0,0,h.width,h.height,0,0,s,s),(t+"").length>0&&D(d,t,T),O()},!S.match(/^data/)&&f.crossOrigin&&(h.crossOrigin="anonymous"),h.src=S},_=function(t){if(f.fallback){var n=document.title;n[0]==="("&&(n=n.slice(n.indexOf(" "))),(t+"").length>0?document.title="("+t+") "+n:document.title=n}},D=function(t,n,d){typeof n=="number"&&n>99&&f.abbreviate&&(n=M(n));var T=(n+"").length-1,S=f.width*o+6*o*T,W=f.height*o,y=s-W,b=s-S-o,A=16*o,N=16*o,E=2*o;t.font=(B.webkit?"bold ":"")+f.font,t.fillStyle=f.background,t.strokeStyle=f.background,t.lineWidth=o,t.beginPath(),t.moveTo(b+E,y),t.quadraticCurveTo(b,y,b,y+E),t.lineTo(b,A-E),t.quadraticCurveTo(b,A,b+E,A),t.lineTo(N-E,A),t.quadraticCurveTo(N,A,N,A-E),t.lineTo(N,y+E),t.quadraticCurveTo(N,y,N-E,y),t.closePath(),t.fill(),t.beginPath(),t.strokeStyle="rgba(0,0,0,0.3)",t.moveTo(b+E/2,A),t.lineTo(N-E/2,A),t.stroke(),t.fillStyle=f.color,t.textAlign="right",t.textBaseline="top",t.fillText(n,o===2?29:15,B.mozilla?7*o:6*o)},O=function(){r().getContext&&k(r().toDataURL())},M=function(t){for(var n=[["G",1e9],["M",1e6],["k",1e3]],d=0;d<n.length;++d)if(t>=n[d][1]){t=U(t/n[d][1])+n[d][0];break}return t},U=function(t,n){var d=new Number(t);return d.toFixed(n)};l.setOptions=function(t){f={},t.colour&&(t.color=t.colour);for(var n in I)f[n]=t.hasOwnProperty(n)?t[n]:I[n];return this},l.setImage=function(t){return c=t,O(),this},l.setBubble=function(t,n){return t=t||"",P(t,n),this},l.reset=function(){c=g,k(g)},l.setOptions(I),C=l,p=typeof C=="function"?C.call(F,v,F,w):C,p!==void 0&&(w.exports=p)})()}}]);
