"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[53918,70565,83014,28253,99617,11383,74344,6111,86193],{6111:(k,E,d)=>{var m,g;m=[d(3547),d(86193),d(7927)],g=function(p,s,f){const h={};let c,u,i=0;h.init=function(n){c||app.parseAndTranslate("modals/change-owner",{},function(e){c=e,u=c.find("#change_owner_commit"),$("body").append(c),c.find("#change_owner_cancel").on("click",t),c.find("#username").on("keyup",a),p.init(o,{allowMainPostSelect:!0}),l(),n&&p.togglePostSelection(n,n.attr("data-pid")),u.on("click",function(){r()}),s.user(c.find("#username"),{filters:["notbanned"]},function(_,P){i=P.item.user.uid,a()})})};function l(){p.pids.length?c.find("#pids").translateHtml("[[topic:fork_pid_count, "+p.pids.length+"]]"):c.find("#pids").translateHtml("[[topic:fork_no_pids]]")}function a(){i&&c.find("#username").length&&c.find("#username").val().length&&p.pids.length?u.removeAttr("disabled"):u.attr("disabled",!0)}function o(){a(),l()}function r(){i&&socket.emit("posts.changeOwner",{pids:p.pids,toUid:i},function(n){if(n)return f.error(n);ajaxify.refresh(),t()})}function t(){c&&(c.remove(),c=null,p.disable())}return h}.apply(E,m),g!==void 0&&(k.exports=g)},74344:(k,E,d)=>{d.r(E),d.d(E,{del:()=>r,get:()=>u,head:()=>i,patch:()=>a,post:()=>l,put:()=>o});var m=d(85233),g=d.n(m),p=d(63281),s=d.n(p);const f=config.relative_path+"/api/v3";function h(t,n){if(t.url=t.url.startsWith("/api")?config.relative_path+t.url:f+t.url,typeof n=="function"){c(t,n);return}return new Promise((e,_)=>{c(t,function(P,C){if(P)return P.message==="A valid login session was not found. Please log in and try again."?(0,p.confirm)("[[error:api.reauth-required]]",A=>{A&&ajaxify.go("login")}):_(P);e(C)})})}async function c(t,n){const{url:e}=t;delete t.url,t.data&&!(t.data instanceof FormData)&&(t.data=JSON.stringify(t.data||{}),t.headers["content-type"]="application/json; charset=utf-8"),{options:t}=await(0,m.fire)("filter:api.options",{options:t}),t.data&&(t.body=t.data,delete t.data);const _=await fetch(e,t),{headers:P}=_,C=P.get("content-type"),A=C&&C.startsWith("application/json");let y;if(A?y=await _.json():y=await _.text(),!_.ok)return n(new Error(A?y.status.message:y));n(null,A&&y.hasOwnProperty("status")&&y.hasOwnProperty("response")?y.response:y)}function u(t,n,e){return h({url:t+(n&&Object.keys(n).length?"?"+$.param(n):"")},e)}function i(t,n,e){return h({url:t+(n&&Object.keys(n).length?"?"+$.param(n):""),method:"head"},e)}function l(t,n,e){return h({url:t,method:"post",data:n,headers:{"x-csrf-token":config.csrf_token}},e)}function a(t,n,e){return h({url:t,method:"patch",data:n,headers:{"x-csrf-token":config.csrf_token}},e)}function o(t,n,e){return h({url:t,method:"put",data:n,headers:{"x-csrf-token":config.csrf_token}},e)}function r(t,n,e){return h({url:t,method:"delete",data:n,headers:{"x-csrf-token":config.csrf_token}},e)}},86193:(k,E,d)=>{var m,g;m=[d(74344),d(7927)],g=function(p,s){const f={},h={delay:200,appendTo:null};f.init=u=>{const i={...h,...u},{input:l,onSelect:a}=i;app.loadJQueryUI(function(){l.autocomplete({...i,open:function(){$(this).autocomplete("widget").css("z-index",100005)},select:function(o,r){c(l,a,o,r)}})})},f.user=function(u,i,l){typeof i=="function"&&(l=i,i={}),i=i||{},f.init({input:u,onSelect:l,source:(a,o)=>{i.query=a.term,p.get("/api/users",i,function(r,t){if(r)return s.error(r);if(t&&t.users){const n=t.users.map(function(e){const _=$("<div></div>").html(e.username).text();return e&&{label:_,value:_,user:{uid:e.uid,name:e.username,slug:e.userslug,username:e.username,userslug:e.userslug,picture:e.picture,banned:e.banned,"icon:text":e["icon:text"],"icon:bgColor":e["icon:bgColor"]}}});o(n)}$(".ui-autocomplete a").attr("data-ajaxify","false")})}})},f.group=function(u,i){f.init({input:u,onSelect:i,source:(l,a)=>{socket.emit("groups.search",{query:l.term},function(o,r){if(o)return s.error(o);if(r&&r.length){const t=r.map(function(n){return n&&{label:n.name,value:n.name,group:n}});a(t)}$(".ui-autocomplete a").attr("data-ajaxify","false")})}})},f.tag=function(u,i){f.init({input:u,onSelect:i,delay:100,source:(l,a)=>{socket.emit("topics.autocompleteTags",{query:l.term,cid:ajaxify.data.cid||0},function(o,r){if(o)return s.error(o);r&&a(r),$(".ui-autocomplete a").attr("data-ajaxify","false")})}})};function c(u,i,l,a){i=i||function(){};const o=jQuery.Event("keypress");o.which=13,o.keyCode=13,setTimeout(function(){u.trigger(o)},100),i(l,a)}return f}.apply(E,m),g!==void 0&&(k.exports=g)},3547:(k,E,d)=>{var m,g;m=[d(7237)],g=function(p){const s={};let f;s.pids=[];let h=!1;s.init=function(a,o){s.pids.length=0,f=a,o=o||{},h=o.allowMainPostSelect||!1,$("#content").on("click",'[component="topic"] [component="post"]',c),i()};function c(a){a.stopPropagation();const o=$(this).attr("data-pid"),r=$('[component="topic"] [data-pid="'+o+'"]');!h&&parseInt($(this).attr("data-index"),10)===0||s.togglePostSelection(r,o)}s.disable=function(){s.pids.forEach(function(a){p.get("post","pid",a).toggleClass("selected",!1)}),$("#content").off("click",'[component="topic"] [component="post"]',c),l()},s.togglePostSelection=function(a,o){if(o){const r=s.pids.indexOf(o);r===-1?(s.pids.push(o),a.toggleClass("selected",!0)):(s.pids.splice(r,1),a.toggleClass("selected",!1)),s.pids.length&&s.pids.sort(function(t,n){return t-n}),typeof f=="function"&&f()}};function u(){return!1}function i(){$("#content").on("click",'[component="post"] button, [component="post"] a',u)}function l(){$("#content").off("click",'[component="post"] button, [component="post"] a',u)}return s}.apply(E,m),g!==void 0&&(k.exports=g)}}]);
