"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[27424,70565,9126,83014,99617,10999,74344],{9872:(x,w,o)=>{var h,v;h=[o(85233),o(32230),o(86569)],v=function(g,y){const l={_capsState:!1};return l.init=function(){const a=$("#login-error-notify"),p=$("#login"),_=$("#login-form");p.on("click",function(f){if(f.preventDefault(),!$("#username").val()||!$("#password").val())a.find("p").translateText("[[error:invalid-username-or-password]]"),a.show();else{if(a.hide(),p.hasClass("disabled"))return;p.addClass("disabled"),g.fire("action:app.login"),_.ajaxSubmit({headers:{"x-csrf-token":config.csrf_token},beforeSend:function(){app.flags._login=!0},success:function(d){g.fire("action:app.loggedIn",d);const m=utils.urlToLocation(d.next).pathname,u=utils.params({url:d.next});u.loggedin=!0,delete u.register;const L=decodeURIComponent($.param(u));window.location.href=m+"?"+L},error:function(d){let m=d.responseText;const u=d.responseJSON;d.status===403&&d.responseText==="Forbidden"?window.location.href=config.relative_path+"/login?error=csrf-invalid":u&&u.hasOwnProperty("banned_until")&&(m=u.banned_until?y.compile("error:user-banned-reason-until",new Date(u.banned_until).toLocaleString(),u.reason):"[[error:user-banned-reason, "+u.reason+"]]"),a.find("p").translateText(m),a.show(),p.removeClass("disabled"),$("#password:focus").length&&$("#password").select()}})}}),l.capsLockCheck(document.querySelector("#password"),document.querySelector("#caps-lock-warning")),$("#login-error-notify button").on("click",function(f){return f.preventDefault(),a.hide(),!1}),$("#content #username").val()?$("#content #password").val("").focus():$("#content #username").focus(),$("#content #noscript").val("false")},l.capsLockCheck=(a,p)=>{const _=f=>{p.classList[f?"remove":"add"]("hidden"),p.parentNode.classList[f?"add":"remove"]("has-warning")};a&&(a.addEventListener("keyup",function(f){if(l._capsState&&f.key==="CapsLock"){_(!1),l._capsState=!l._capsState;return}l._capsState=f.getModifierState&&f.getModifierState("CapsLock"),_(l._capsState)}),l._capsState&&_(!0))},l}.apply(w,h),v!==void 0&&(x.exports=v)},70935:(x,w,o)=>{var h,v;h=[o(32230),o(22568),o(74344),o(63281),o(9872),o(21322),o(86569)],v=function(g,y,l,a,p,_){const f={};let d=!1;const m="";f.init=function(){const n=$("#username"),r=$("#password"),s=$("#password-confirm"),c=$("#register");C(),$("#content #noscript").val("false");const D=utils.params();D.token&&$("#token").val(D.token),n.on("keyup",function(){$("#yourUsername").text(this.value.length>0?y(this.value):"username")}),n.on("blur",function(){n.val().length&&u(n.val())}),r.on("blur",function(){r.val().length&&L(r.val(),s.val())}),s.on("blur",function(){s.val().length&&e(r.val(),s.val())});function k(P){d=!1,L(r.val(),s.val()),e(r.val(),s.val()),u(n.val(),P)}p.capsLockCheck(document.querySelector("#password"),document.querySelector("#caps-lock-warning")),c.on("click",function(P){const A=$(this),b=$("#register-error-notify");b.addClass("hidden"),P.preventDefault(),k(function(){d||(A.addClass("disabled"),A.parents("form").ajaxSubmit({headers:{"x-csrf-token":config.csrf_token},success:function(E){if(A.removeClass("disabled"),!!E)if(E.next){const S=utils.urlToLocation(E.next).pathname,O=utils.params({url:E.next});O.registered=!0;const T=decodeURIComponent($.param(O));window.location.href=S+"?"+T}else E.message&&g.translate(E.message,function(S){a.alert(S),ajaxify.go("/")})},error:function(E){g.translate(E.responseText,config.defaultLang,function(S){E.status===403&&E.responseText==="Forbidden"?window.location.href=config.relative_path+"/register?error=csrf-invalid":(b.find("p").text(S),b.removeClass("hidden"),A.removeClass("disabled"))})}}))})}),$("#username").focus()};function u(n,r){r=r||function(){};const s=$("#username-notify"),c=y(n);n.length<ajaxify.data.minimumUsernameLength||c.length<ajaxify.data.minimumUsernameLength?t(s,"[[error:username-too-short]]"):n.length>ajaxify.data.maximumUsernameLength?t(s,"[[error:username-too-long]]"):!utils.isUserNameValid(n)||!c?t(s,"[[error:invalid-username]]"):Promise.allSettled([l.head(`/users/bySlug/${c}`,{}),l.head(`/groups/${n}`,{})]).then(D=>{D.every(k=>k.status==="rejected")?i(s,m):t(s,"[[error:username-taken]]"),r()})}function L(n,r){const s=$("#password-notify"),c=$("#password-confirm-notify");try{if(utils.assertPasswordValidity(n,_),n===$("#username").val())throw new Error("[[user:password_same_as_username]]");i(s,m)}catch(D){t(s,D.message)}n!==r&&r!==""&&t(c,"[[user:change_password_error_match]]")}function e(n,r){const s=$("#password-notify"),c=$("#password-confirm-notify");!n||s.hasClass("alert-error")||(n!==r?t(c,"[[user:change_password_error_match]]"):i(c,m))}function t(n,r){g.translate(r,function(s){n.html(s),n.parent().removeClass("register-success").addClass("register-danger"),n.show()}),d=!0}function i(n,r){g.translate(r,function(s){n.html(s),n.parent().removeClass("register-danger").addClass("register-success"),n.show()})}function C(){if(!app.user.uid&&config.defaultLang!==config.userLang){const n=$('[component="register/local"]'),r=$('<input type="hidden" name="userLang" value="'+config.userLang+'" />');n.append(r)}}return f}.apply(w,h),v!==void 0&&(x.exports=v)},74344:(x,w,o)=>{o.r(w),o.d(w,{del:()=>L,get:()=>_,head:()=>f,patch:()=>m,post:()=>d,put:()=>u});var h=o(85233),v=o.n(h),g=o(63281),y=o.n(g);const l=config.relative_path+"/api/v3";function a(e,t){if(e.url=e.url.startsWith("/api")?config.relative_path+e.url:l+e.url,typeof t=="function"){p(e,t);return}return new Promise((i,C)=>{p(e,function(n,r){if(n)return n.message==="A valid login session was not found. Please log in and try again."?(0,g.confirm)("[[error:api.reauth-required]]",s=>{s&&ajaxify.go("login")}):C(n);i(r)})})}async function p(e,t){const{url:i}=e;delete e.url,e.data&&!(e.data instanceof FormData)&&(e.data=JSON.stringify(e.data||{}),e.headers["content-type"]="application/json; charset=utf-8"),{options:e}=await(0,h.fire)("filter:api.options",{options:e}),e.data&&(e.body=e.data,delete e.data);const C=await fetch(i,e),{headers:n}=C,r=n.get("content-type"),s=r&&r.startsWith("application/json");let c;if(s?c=await C.json():c=await C.text(),!C.ok)return t(new Error(s?c.status.message:c));t(null,s&&c.hasOwnProperty("status")&&c.hasOwnProperty("response")?c.response:c)}function _(e,t,i){return a({url:e+(t&&Object.keys(t).length?"?"+$.param(t):"")},i)}function f(e,t,i){return a({url:e+(t&&Object.keys(t).length?"?"+$.param(t):""),method:"head"},i)}function d(e,t,i){return a({url:e,method:"post",data:t,headers:{"x-csrf-token":config.csrf_token}},i)}function m(e,t,i){return a({url:e,method:"patch",data:t,headers:{"x-csrf-token":config.csrf_token}},i)}function u(e,t,i){return a({url:e,method:"put",data:t,headers:{"x-csrf-token":config.csrf_token}},i)}function L(e,t,i){return a({url:e,method:"delete",data:t,headers:{"x-csrf-token":config.csrf_token}},i)}},22568:(x,w,o)=>{var h,v,g;(function(y){v=[o(20648)],h=y,g=typeof h=="function"?h.apply(w,v):h,g!==void 0&&(x.exports=g)})(function(y){const l=y("[^\\p{L}\\s\\d\\-_]","g"),a=/[^\w\s\d\-_]/g,p=/^\s+|\s+$/g,_=/\s+/g,f=/-+/g,d=/-$/g,m=/^-/g,u=/^[\w\d\s.,\-@]+$/;return function(e,t){return e?(e=String(e).replace(p,""),u.test(e)?e=e.replace(a,"-"):e=y.replace(e,l,"-"),e=t?e:e.toLocaleLowerCase(),e=e.replace(_,"-"),e=e.replace(f,"-"),e=e.replace(d,""),e=e.replace(m,""),e):""}})}}]);
