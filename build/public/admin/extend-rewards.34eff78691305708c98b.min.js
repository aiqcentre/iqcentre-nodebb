"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[12249],{48842:(v,p,b)=>{var o,d;o=[b(7927)],d=function(c){const l={};let r,f,u,m;l.init=function(){r=ajaxify.data.rewards,f=ajaxify.data.active,u=ajaxify.data.conditions,m=ajaxify.data.conditionals,$("[data-selected]").each(function(){g($(this))}),$("#active").on("change","[data-selected]",function(){k($(this))}).on("click",".delete",function(){const t=$(this).parents("[data-id]"),a=t.attr("data-id");return socket.emit("admin.rewards.delete",{id:a},function(e){e?c.error(e):c.success("[[admin/extend/rewards:alert.delete-success]]")}),t.remove(),!1}).on("click",".toggle",function(){const t=$(this),a=t.hasClass("btn-success");return t.toggleClass("btn-warning").toggleClass("btn-success").translateHtml("[[admin/extend/rewards:"+(a?"disable":"enable")+"]]"),!1}),$("#new").on("click",y),$("#save").on("click",E),_()};function g(t){switch(t.val(t.attr("data-selected")),t.attr("name")){case"rid":h(t);break}}function k(t){switch(t.attr("data-selected",t.val()),t.attr("name")){case"rid":h(t);break}}function h(t){const a=t.parents("[data-rid]"),e=a.find(".inputs");let s,n="";for(const i in r)if(r.hasOwnProperty(i)&&r[i].rid===t.attr("data-selected")){s=r[i].inputs,a.attr("data-rid",r[i].rid);break}if(!s)return c.error("[[admin/extend/rewards:alert.no-inputs-found]] "+t.attr("data-selected"));s.forEach(function(i){switch(n+='<label for="'+i.name+'">'+i.label+"<br />",i.type){case"select":n+='<select class="form-select form-select-sm" name="'+i.name+'">',i.values.forEach(function(w){n+='<option value="'+w.value+'">'+w.name+"</option>"});break;case"text":n+='<input type="text" class="form-control form-control-sm" name="'+i.name+'" />';break}n+="</label>"}),e.html(n)}function _(){$("[data-rid]").each(function(t){const a=$(this).find(".inputs"),e=f[t].rewards;for(const s in e)e.hasOwnProperty(s)&&a.find('[name="'+s+'"]').val(e[s])})}function y(){const t=$("#active"),a={active:[{disabled:!0,value:"",claimable:1,rid:null,id:null}],conditions:u,conditionals:m,rewards:r};app.parseAndTranslate("admin/extend/rewards","active",a,function(e){t.append(e),e.find("select").val("")})}function E(){const t=[];$("#active li").each(function(){const a={rewards:{}},e=$(this).find("form.main").serializeArray(),s=$(this).find("form.rewards").serializeArray();e.forEach(function(n){a[n.name]=n.value}),s.forEach(function(n){a.rewards[n.name]=n.value}),a.id=$(this).attr("data-id"),a.disabled=$(this).find(".toggle").hasClass("btn-success"),t.push(a)}),socket.emit("admin.rewards.save",t,function(a,e){if(a)return c.error(a);const s=document.getElementById("save");s.classList.toggle("saved",!0),setTimeout(()=>{s.classList.toggle("saved",!1)},5e3),$("#active li").each(function(n){$(this).attr("data-id")||$(this).attr("data-id",e[n].id)})})}return l}.apply(p,o),d!==void 0&&(v.exports=d)}}]);
