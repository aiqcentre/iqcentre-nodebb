(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[33701,25655],{14490:(R,v,l)=>{R.exports=l(3343)},18340:(R,v,l)=>{"use strict";var k,m;k=[l(85233),l(7927)],m=function(x,y){let f,p=[],h=0,a;function u(e,t){typeof e!="string"&&(e=$(e),e=e.data("type")||e.attr("type")||e.prop("tagName"));const i=f.plugins[e.toLowerCase()];if(i==null)return;const n=i[t];return typeof n=="function"?n:null}return a={deepClone:function(e){return typeof e=="object"?JSON.parse(JSON.stringify(e)):e},createElement:function(e,t,i){const n=document.createElement(e);for(const s in t)t.hasOwnProperty(s)&&n.setAttribute(s,t[s]);return i&&n.appendChild(document.createTextNode(i)),n},initElement:function(e){const t=u(e,"init");t?.call(f,$(e))},destructElement:function(e){const t=u(e,"destruct");t?.call(f,$(e))},createElementOfType:function(e,t,i){let n;const s=u(e,"create");return s!=null?n=$(s.call(f,e,t,i)):(i==null&&(i={}),e!=null&&(i.type=e),n=$(a.createElement(t||"input",i))),n.data("type",e),a.initElement(n),n},cleanArray:function(e,t,i){const n=[];if(!t&&i)return e;for(let s=0;s<e.length;s+=1){let o=e[s];t&&(o===!!o?o=+o:o&&typeof o.trim=="function"&&(o=o.trim())),(i||o!=null&&o.length)&&n.push(o)}return n},isTrue:function(e){return e==="true"||+e==1},isFalse:function(e){return e==="false"||+e==0},readValue:function(e){let t=!a.isFalse(e.data("empty"));const i=!a.isFalse(e.data("trim")),n=e.data("split"),s=u(e,"get");let o;if(s!=null)return s.call(f,e,i,t);if(n!=null){t=a.isTrue(e.data("empty")),o=e.val();const d=o!=null&&o.split(n||",")||[];return a.cleanArray(d,i,t)}if(o=e.val(),i&&o!=null&&typeof o.trim=="function"&&(o=o.trim()),t||o!==void 0&&(o==null||o.length!==0))return o},fillField:function(e,t){const i=u(e,"set");let n=e.data("trim");if(n=n!=="false"&&+n!=0,i!=null)return i.call(f,e,t,n);t instanceof Array&&(t=t.join(e.data("split")||(n?", ":","))),n&&t&&typeof t.trim=="function"?(t=t.trim(),typeof t.toString=="function"&&(t=t.toString())):t!=null?(typeof t.toString=="function"&&(t=t.toString()),n&&(t=t.trim())):t="",t!==void 0&&e.val(t)},initFields:function(e){$("[data-key]",e).each(function(t,i){i=$(i);const n=u(i,"init"),s=i.data("key").split(".");let o=f.get();n?.call(f,i);for(let d=0;d<s.length;d+=1){const r=s[d];r&&o!=null&&(o=o[r])}a.fillField(i,o)})},registerReadyJobs:function(e){return h+=e,h},beforeReadyJobsDecreased:function(e){if(e==null&&(e=1),h>0&&(h-=e,h<=0)){for(let t=0;t<p.length;t+=1)p[t]();p=[]}},whenReady:function(e){h<=0?e():p.push(e)},serializeForm:function(e){const t=e.serializeObject();return e.find('input[type="checkbox"]').each(function(i,n){n=$(n),n.is(":checked")||(t[n.attr("name")]="off")}),e.find("select[multiple]").each(function(i,n){n=$(n),t[n.attr("name")]=JSON.stringify(n.val())}),t},persistSettings:function(e,t,i,n){t!=null&&t._!=null&&typeof t._!="string"&&(t=a.deepClone(t),t._=JSON.stringify(t._)),socket.emit("admin.settings.set",{hash:e,values:t},function(s){i&&(s?y.alert({title:"[[admin/admin:changes-not-saved]]",type:"danger",message:`[[admin/admin/changes-not-saved-message, ${s.message}]]`,timeout:5e3}):y.alert({title:"[[admin/admin:changes-saved]]",type:"success",message:"[[admin/admin:changes-saved-message]]",timeout:2500})),typeof n=="function"&&n(s)})},use:function(e){try{e._=JSON.parse(e._)}catch{}f.cfg=e}},f={helper:a,plugins:{},cfg:{},get:function(){return f.cfg!=null&&f.cfg._!==void 0?f.cfg._:f.cfg},registerPlugin:function(e,t){t==null?t=e.types:e.types=t,typeof e.use=="function"&&e.use.call(f);for(let i=0;i<t.length;i+=1){const n=t[i].toLowerCase();f.plugins[n]==null&&(f.plugins[n]=e)}},set:function(e,t,i,n,s){s==null&&(s=!0),a.whenReady(function(){a.use(t),a.initFields(i||"form"),a.persistSettings(e,t,s,n)})},sync:function(e,t,i){socket.emit("admin.settings.get",{hash:e},function(n,s){n?typeof i=="function"&&i(n):a.whenReady(function(){a.use(s),a.initFields(t||"form"),typeof i=="function"&&i()})})},persist:function(e,t,i,n){const s=[],o=$("[data-key]",t||"form").toArray();n==null&&(n=!0);for(let d=0;d<o.length;d+=1){const r=$(o[d]),g=a.readValue(r);let c=f.get();const A=r.data("key").split("."),P=A[A.length-1];if(A.length>1)for(let S=0;S<A.length-1;S+=1){const C=A[S];C&&c!=null&&(c=c[C])}c!=null?g!=null?c[P]=g:delete c[P]:s.push(r.data("key"))}s.length&&y.alert({title:"Attributes Not Saved",message:"'"+s.join(", ")+"' could not be saved. Please contact the plugin-author!",type:"danger",timeout:5e3}),a.persistSettings(e,f.cfg,n,i)},load:function(e,t,i){i=i||function(){};const n=t.attr("data-socket-get");socket.emit(n||"admin.settings.get",{hash:e},function(s,o){if(s)return i(s);$(t).find("select[multiple]").each(function(r,g){const c=$(g).attr("name");if(c&&o.hasOwnProperty(c))try{o[c]=JSON.parse(o[c])}catch{}}),ajaxify.data[n?e:"settings"]=o,a.whenReady(function(){$(t).find("[data-sorted-list]").each(function(r,g){u(g,"get").call(f,$(g),e)})}),$(t).deserialize(o),x.fire("action:admin.settingsLoaded"),$(t).on("change","input, select, textarea",function(){app.flags=app.flags||{},app.flags._unsaved=!0});const d=document.getElementById("save");d&&l.e(42441).then(function(){var r=[l(42441)];(function(g){g.bind("ctrl+s",function(c){d.click(),c.preventDefault()})}).apply(null,r)}).catch(l.oe),i(null,o)})},save:function(e,t,i){t=$(t);const n=t.get(0).elements;if(f.check(n)&&t.length){const o=a.serializeForm(t);a.whenReady(function(){const r=t.find("[data-sorted-list]");r.length&&r.each((g,c)=>{u(c,"set").call(f,$(c),o)})});const d=t.attr("data-socket-set");socket.emit(d||"admin.settings.set",{hash:e,values:o},function(r){if(app.flags._unsaved=!1,ajaxify.data[d?e:"settings"]=o,typeof i=="function")i(r);else if(r)y.alert({title:"[[admin/admin:changes-not-saved]]",message:`[[admin/admin:changes-not-saved-message, ${r.message}]]`,type:"error",timeout:2500});else{const g=document.getElementById("save");g.classList.toggle("saved",!0),setTimeout(()=>{g.classList.toggle("saved",!1)},1500)}})}},check:function(e){const t=i=>{const n=i.target.closest(".form-group");n&&n.classList.add("has-error"),i.target.removeEventListener("invalid",t)};return Array.prototype.map.call(e,i=>{const n=i.closest(".form-group");return n&&n.classList.remove("has-error"),i.addEventListener("invalid",t),i.reportValidity()}).every(Boolean)}},a.registerReadyJobs(1),Promise.all([l.e(66177),l.e(62526),l.e(26069)]).then(function(){var e=[l(16631),l(73143),l(7448),l(15101),l(846),l(88839),l(53411),l(66370)];(function(){for(let t=0;t<arguments.length;t+=1)f.registerPlugin(arguments[t]);a.beforeReadyJobsDecreased()}).apply(null,e)}).catch(l.oe),f}.apply(v,k),m!==void 0&&(R.exports=m)},3343:(R,v,l)=>{"use strict";var k,m;k=[l(18340),l(7927)],m=function(x,y){var f={};return f.init=function(){x.load("markdown",$(".markdown-settings"),function(p,h){p&&(h={});var a={html:!1,langPrefix:"language-",highlight:!0,highlightTheme:"default.css",probe:!0,probeCacheSize:256,xhtmlOut:!0,breaks:!0,linkify:!0,typographer:!1,externalBlank:!1,nofollow:!0,allowRTLO:!1,checkboxes:!0,multimdTables:!0};for(var u in a)h.hasOwnProperty(u)||(typeof a[u]=="boolean"?$("#"+u).prop("checked",a[u]):$("#"+u).val(a[u]))}),$("#save").on("click",function(){x.save("markdown",$(".markdown-settings"),function(){y.alert({type:"success",alert_id:"markdown-saved",title:"Reload Required",message:"Please reload your NodeBB to have your changes take effect",clickfn:function(){socket.emit("admin.reload")},timeout:2500})})}),$("#html").on("change",function(){var p=$(this);p.prop("checked")&&bootbox.confirm("Are you sure you wish to disable sanitisation of HTML? <strong>Doing so compromises your forum&apos;s client-side security, and allows malicious users to execute arbitrary javascript on other users&apos; browsers.</strong>",function(h){h||p.prop("checked",!1)})})},f}.apply(v,k),m!==void 0&&(R.exports=m)}}]);
