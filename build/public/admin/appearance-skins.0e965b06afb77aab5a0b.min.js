"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[4773,25655],{48777:(R,C,r)=>{var A,h;A=[r(32230),r(7927),r(18340),r(85233)],h=function(S,g,c,y){const m={};m.init=function(){$.ajax({method:"get",url:"https://bootswatch.com/api/5.json"}).done(l=>{y.on("action:settings.sorted-list.loaded",n=>{n.hash==="custom-skins"&&($('.custom-skin-settings [data-type="list"] [data-theme]').each((t,e)=>{$(e).attr("data-theme",$(e).attr("data-theme").toLowerCase())}),o(app.config.bootswatchSkin))}),c.load("custom-skins",$(".custom-skin-settings")),m.render(l)}),$("#save-custom-skins").on("click",function(){return c.save("custom-skins",$(".custom-skin-settings"),function(){g.success("[[admin/appearance/skins:save-custom-skins-success]]")}),!1}),$("#skins").on("click",function(l){let n=$(l.target);n.attr("data-action")||(n=n.parents("[data-action]"));const t=n.attr("data-action");if(t&&t==="use"){const e=n.parents("[data-theme]"),s=e.attr("data-css"),a=e.attr("data-theme"),i=e.attr("data-theme-name");socket.emit("admin.themes.set",{type:"bootswatch",id:a,src:s},function(f){if(f)return g.error(f);o(a),g.alert({alert_id:"admin:theme",type:"info",title:"[[admin/appearance/skins:skin-updated]]",message:a?"[[admin/appearance/skins:applied-success, "+i+"]]":"[[admin/appearance/skins:revert-success]]",timeout:5e3})})}})},m.render=function(l){const n=$("#bootstrap_themes");app.parseAndTranslate("admin/partials/theme_list",{themes:l.themes.map(function(t){return{type:"bootswatch",id:t.name.toLowerCase(),name:t.name,description:t.description,screenshot_url:t.thumbnail,url:t.preview,css:t.cssCdn,skin:!0}}),showRevert:!0},function(t){n.html(t),o(app.config.bootswatchSkin)})};function o(l){S.translate("[[admin/appearance/skins:select-skin]]  ||  [[admin/appearance/skins:current-skin]]",function(n){n=n.split("  ||  ");const t=n[0],e=n[1];$("[data-theme]").removeClass("selected").find('[data-action="use"]').each(function(){$(this).parents("[data-theme]").attr("data-theme")&&$(this).html(t).removeClass("btn-success").addClass("btn-primary")}),l&&$('[data-theme="'+l+'"]').addClass("selected").find('[data-action="use"]').html(e).removeClass("btn-primary").addClass("btn-success")})}return m}.apply(C,A),h!==void 0&&(R.exports=h)},18340:(R,C,r)=>{var A,h;A=[r(85233),r(7927)],h=function(S,g){let c,y=[],m=0,o;function l(n,t){typeof n!="string"&&(n=$(n),n=n.data("type")||n.attr("type")||n.prop("tagName"));const e=c.plugins[n.toLowerCase()];if(e==null)return;const s=e[t];return typeof s=="function"?s:null}return o={deepClone:function(n){return typeof n=="object"?JSON.parse(JSON.stringify(n)):n},createElement:function(n,t,e){const s=document.createElement(n);for(const a in t)t.hasOwnProperty(a)&&s.setAttribute(a,t[a]);return e&&s.appendChild(document.createTextNode(e)),s},initElement:function(n){const t=l(n,"init");t?.call(c,$(n))},destructElement:function(n){const t=l(n,"destruct");t?.call(c,$(n))},createElementOfType:function(n,t,e){let s;const a=l(n,"create");return a!=null?s=$(a.call(c,n,t,e)):(e==null&&(e={}),n!=null&&(e.type=n),s=$(o.createElement(t||"input",e))),s.data("type",n),o.initElement(s),s},cleanArray:function(n,t,e){const s=[];if(!t&&e)return n;for(let a=0;a<n.length;a+=1){let i=n[a];t&&(i===!!i?i=+i:i&&typeof i.trim=="function"&&(i=i.trim())),(e||i!=null&&i.length)&&s.push(i)}return s},isTrue:function(n){return n==="true"||+n==1},isFalse:function(n){return n==="false"||+n==0},readValue:function(n){let t=!o.isFalse(n.data("empty"));const e=!o.isFalse(n.data("trim")),s=n.data("split"),a=l(n,"get");let i;if(a!=null)return a.call(c,n,e,t);if(s!=null){t=o.isTrue(n.data("empty")),i=n.val();const f=i!=null&&i.split(s||",")||[];return o.cleanArray(f,e,t)}if(i=n.val(),e&&i!=null&&typeof i.trim=="function"&&(i=i.trim()),t||i!==void 0&&(i==null||i.length!==0))return i},fillField:function(n,t){const e=l(n,"set");let s=n.data("trim");if(s=s!=="false"&&+s!=0,e!=null)return e.call(c,n,t,s);t instanceof Array&&(t=t.join(n.data("split")||(s?", ":","))),s&&t&&typeof t.trim=="function"?(t=t.trim(),typeof t.toString=="function"&&(t=t.toString())):t!=null?(typeof t.toString=="function"&&(t=t.toString()),s&&(t=t.trim())):t="",t!==void 0&&n.val(t)},initFields:function(n){$("[data-key]",n).each(function(t,e){e=$(e);const s=l(e,"init"),a=e.data("key").split(".");let i=c.get();s?.call(c,e);for(let f=0;f<a.length;f+=1){const u=a[f];u&&i!=null&&(i=i[u])}o.fillField(e,i)})},registerReadyJobs:function(n){return m+=n,m},beforeReadyJobsDecreased:function(n){if(n==null&&(n=1),m>0&&(m-=n,m<=0)){for(let t=0;t<y.length;t+=1)y[t]();y=[]}},whenReady:function(n){m<=0?n():y.push(n)},serializeForm:function(n){const t=n.serializeObject();return n.find('input[type="checkbox"]').each(function(e,s){s=$(s),s.is(":checked")||(t[s.attr("name")]="off")}),n.find("select[multiple]").each(function(e,s){s=$(s),t[s.attr("name")]=JSON.stringify(s.val())}),t},persistSettings:function(n,t,e,s){t!=null&&t._!=null&&typeof t._!="string"&&(t=o.deepClone(t),t._=JSON.stringify(t._)),socket.emit("admin.settings.set",{hash:n,values:t},function(a){e&&(a?g.alert({title:"[[admin/admin:changes-not-saved]]",type:"danger",message:`[[admin/admin/changes-not-saved-message, ${a.message}]]`,timeout:5e3}):g.alert({title:"[[admin/admin:changes-saved]]",type:"success",message:"[[admin/admin:changes-saved-message]]",timeout:2500})),typeof s=="function"&&s(a)})},use:function(n){try{n._=JSON.parse(n._)}catch{}c.cfg=n}},c={helper:o,plugins:{},cfg:{},get:function(){return c.cfg!=null&&c.cfg._!==void 0?c.cfg._:c.cfg},registerPlugin:function(n,t){t==null?t=n.types:n.types=t,typeof n.use=="function"&&n.use.call(c);for(let e=0;e<t.length;e+=1){const s=t[e].toLowerCase();c.plugins[s]==null&&(c.plugins[s]=n)}},set:function(n,t,e,s,a){a==null&&(a=!0),o.whenReady(function(){o.use(t),o.initFields(e||"form"),o.persistSettings(n,t,a,s)})},sync:function(n,t,e){socket.emit("admin.settings.get",{hash:n},function(s,a){s?typeof e=="function"&&e(s):o.whenReady(function(){o.use(a),o.initFields(t||"form"),typeof e=="function"&&e()})})},persist:function(n,t,e,s){const a=[],i=$("[data-key]",t||"form").toArray();s==null&&(s=!0);for(let f=0;f<i.length;f+=1){const u=$(i[f]),p=o.readValue(u);let d=c.get();const k=u.data("key").split("."),F=k[k.length-1];if(k.length>1)for(let v=0;v<k.length-1;v+=1){const P=k[v];P&&d!=null&&(d=d[P])}d!=null?p!=null?d[F]=p:delete d[F]:a.push(u.data("key"))}a.length&&g.alert({title:"Attributes Not Saved",message:"'"+a.join(", ")+"' could not be saved. Please contact the plugin-author!",type:"danger",timeout:5e3}),o.persistSettings(n,c.cfg,s,e)},load:function(n,t,e){e=e||function(){};const s=t.attr("data-socket-get");socket.emit(s||"admin.settings.get",{hash:n},function(a,i){if(a)return e(a);$(t).find("select[multiple]").each(function(u,p){const d=$(p).attr("name");if(d&&i.hasOwnProperty(d))try{i[d]=JSON.parse(i[d])}catch{}}),ajaxify.data[s?n:"settings"]=i,o.whenReady(function(){$(t).find("[data-sorted-list]").each(function(u,p){l(p,"get").call(c,$(p),n)})}),$(t).deserialize(i),S.fire("action:admin.settingsLoaded"),$(t).on("change","input, select, textarea",function(){app.flags=app.flags||{},app.flags._unsaved=!0});const f=document.getElementById("save");f&&r.e(42441).then(function(){var u=[r(42441)];(function(p){p.bind("ctrl+s",function(d){f.click(),d.preventDefault()})}).apply(null,u)}).catch(r.oe),e(null,i)})},save:function(n,t,e){t=$(t);const s=t.get(0).elements;if(c.check(s)&&t.length){const i=o.serializeForm(t);o.whenReady(function(){const u=t.find("[data-sorted-list]");u.length&&u.each((p,d)=>{l(d,"set").call(c,$(d),i)})});const f=t.attr("data-socket-set");socket.emit(f||"admin.settings.set",{hash:n,values:i},function(u){if(app.flags._unsaved=!1,ajaxify.data[f?n:"settings"]=i,typeof e=="function")e(u);else if(u)g.alert({title:"[[admin/admin:changes-not-saved]]",message:`[[admin/admin:changes-not-saved-message, ${u.message}]]`,type:"error",timeout:2500});else{const p=document.getElementById("save");p.classList.toggle("saved",!0),setTimeout(()=>{p.classList.toggle("saved",!1)},1500)}})}},check:function(n){const t=e=>{const s=e.target.closest(".form-group");s&&s.classList.add("has-error"),e.target.removeEventListener("invalid",t)};return Array.prototype.map.call(n,e=>{const s=e.closest(".form-group");return s&&s.classList.remove("has-error"),e.addEventListener("invalid",t),e.reportValidity()}).every(Boolean)}},o.registerReadyJobs(1),Promise.all([r.e(66177),r.e(62526),r.e(26069)]).then(function(){var n=[r(16631),r(73143),r(7448),r(15101),r(846),r(88839),r(53411),r(66370)];(function(){for(let t=0;t<arguments.length;t+=1)c.registerPlugin(arguments[t]);o.beforeReadyJobsDecreased()}).apply(null,n)}).catch(r.oe),c}.apply(C,A),h!==void 0&&(R.exports=h)}}]);
