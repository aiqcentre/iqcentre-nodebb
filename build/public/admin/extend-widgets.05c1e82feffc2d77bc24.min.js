(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[94834],{8196:(A,y,m)=>{"use strict";var w,b;w=[m(63281),m(7927),m(62526),m(87285),m(66709),m(84414)],b=function(_,s){const e={};e.init=function(){$("#widgets .dropdown .dropdown-menu a").on("click",function(c){const o=$(this);$("#widgets .tab-pane").removeClass("active");const n=o.attr("data-template");return $('#widgets .tab-pane[data-template="'+n+'"]').addClass("active"),$("#widgets .selected-template").text(n),$("#widgets .dropdown").trigger("click"),c.preventDefault(),!1}),$("#widget-selector").on("change",function(){$(".available-widgets [data-widget]").addClass("hide"),$('.available-widgets [data-widget="'+$(this).val()+'"]').removeClass("hide")}),$("#widget-selector").trigger("change"),r(),f()};function t(){$('[data-location="drafts"]').insertAfter($('[data-location="drafts"]').closest(".tab-content")),$("#widgets .available-widgets .widget-panel").draggable({helper:function(o){return $(o.target).parents(".widget-panel").clone()},distance:10,connectToSortable:".widget-area"}),$("#widgets .available-containers .containers > [data-container-html]").draggable({helper:function(o){let n=$(o.target);return n=n.attr("data-container-html")?n:n.parents("[data-container-html]"),n.clone().addClass("block").width(n.width()).css("opacity","0.5")},distance:10}).each(function(){$(this).attr("data-container-html",$(this).attr("data-container-html").replace(/\\\{([\s\S]*?)\\\}/g,"{$1}"))}),$("#widgets .widget-area").sortable({update:function(o,n){i(n.item),p(n.item)},connectWith:"div"}).on("click",".delete-widget",function(){const o=$(this).parents(".widget-panel");_.confirm("[[admin/extend/widgets:alert.confirm-delete]]",function(n){n&&o.remove()})}).on("mouseup","> .card > .card-header",function(o){$(this).parent().is(".ui-sortable-helper")||$(o.target).closest(".delete-widget").length||$(this).parent().children(".card-body").toggleClass("hidden")}),$("#save").on("click",c);function c(){const o=[];$("#widgets [data-template][data-location]").each(function(n,a){a=$(a);const d=a.attr("data-template"),g=a.attr("data-location"),h=a.children(".widget-area"),C=[];h.find(".widget-panel[data-widget]").each(function(){const l={},u=$(this).find("form").serializeArray();for(const v in u)u.hasOwnProperty(v)&&u[v].name&&(l[u[v].name]?(Array.isArray(l[u[v].name])||(l[u[v].name]=[l[u[v].name]]),l[u[v].name].push(u[v].value)):l[u[v].name]=u[v].value);C.push({widget:$(this).attr("data-widget"),data:l})}),o.push({template:d,location:g,widgets:C})}),socket.emit("admin.widgets.set",o,function(n){if(n)return s.error(n);const a=document.getElementById("save");a.classList.toggle("saved",!0),setTimeout(()=>{a.classList.toggle("saved",!1)},5e3)})}$(".color-selector").on("click",".btn",function(){const o=$(this),n=o.parents(".color-selector"),a=n.parents("[data-container-html]"),d=[];n.children().each(function(){d.push($(this).attr("data-class"))}),a.removeClass(d.join(" ")).addClass(o.attr("data-class")),a.attr("data-container-html",a.attr("data-container-html").replace(/class="[a-zA-Z0-9-\s]+"/,'class="'+a[0].className.replace(" pointer ui-draggable ui-draggable-handle","")+'"'))})}function i(c){const o=new Date().getFullYear();c.find(".date-selector").datepicker({changeMonth:!0,changeYear:!0,yearRange:o+":"+(o+100)})}function p(c){c.hasClass("block")||c.addClass("block").css("width","").css("height","").droppable({accept:"[data-container-html]",drop:function(o,n){const a=$(this);a.find(".card-body .container-html").val(n.draggable.attr("data-container-html")),a.find(".card-body").removeClass("hidden")},hoverClass:"container-hover"}).children(".card-header").append('<div class="float-end pointer"><span class="delete-widget"><i class="fa fa-times-circle"></i></span></div><div class="float-start pointer"><span class="toggle-widget"><i class="fa fa-chevron-circle-down"></i></span>&nbsp;</div>').children("small").html("")}function r(){function c(o,n){if(n.title){const a=o.find(".card-header strong");a.text(a.text()+" - "+n.title)}return o.find("input, textarea, select").each(function(){const a=$(this),d=n[a.attr("name")];a.attr("type")==="checkbox"?a.prop("checked",!!d).trigger("change"):a.val(d)}),o}$.get(config.relative_path+"/api/admin/extend/widgets",function(o){const n=o.areas;for(let a=0;a<n.length;a+=1){const d=n[a],g=$('#widgets .area[data-template="'+d.template+'"][data-location="'+d.location+'"]').find(".widget-area");g.html("");for(let h=0;h<d.data.length;h+=1){const C=d.data[h],l=$('.available-widgets [data-widget="'+C.widget+'"]').clone(!0).removeClass("hide");g.append(c(l,C.data)),p(l),i(l)}}t()})}function f(){const c=$('[component="clone"]'),o=$('[component="clone/button"]');c.find(".dropdown-menu li").on("click",function(){const n=$(this).find("a").text();o.translateHtml("[[admin/extend/widgets:clone-from]] <strong>"+n+"</strong>"),o.attr("data-template",n)}),o.on("click",function(){const n=o.attr("data-template");if(!n)return s.error("[[admin/extend/widgets:error.select-clone]]");const a=$("#active-widgets .active.tab-pane[data-template] .area"),d=$('#active-widgets .tab-pane[data-template="'+n+'"] .area'),g=a.map(function(){return $(this).attr("data-location")}).get(),h=d.map(function(){const l=$(this).attr("data-location");return g.indexOf(l)!==-1?l:void 0}).get().filter(function(l){return l});function C(l){$('#active-widgets .tab-pane[data-template="'+n+'"] [data-location="'+l+'"]').each(function(){$(this).find("[data-widget]").each(function(){const u=$(this).clone(!0);$('#active-widgets .active.tab-pane[data-template]:not([data-template="global"]) [data-location="'+l+'"] .widget-area').append(u)})})}for(let l=0,u=h.length;l<u;l++){const v=h[l];C(v)}s.success("[[admin/extend/widgets:alert.clone-success]]")})}return e}.apply(y,w),b!==void 0&&(A.exports=b)},66709:(A,y,m)=>{var w,b,_;/*!
* jQuery UI Droppable 1.13.2
* http://jqueryui.com
*
* Copyright jQuery Foundation and other contributors
* Released under the MIT license.
* http://jquery.org/license
*/(function(s){"use strict";b=[m(19755),m(87285),m(66177),m(85592),m(26891)],w=s,_=typeof w=="function"?w.apply(y,b):w,_!==void 0&&(A.exports=_)})(function(s){"use strict";return s.widget("ui.droppable",{version:"1.13.2",widgetEventPrefix:"drop",options:{accept:"*",addClasses:!0,greedy:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var e,t=this.options,i=t.accept;this.isover=!1,this.isout=!0,this.accept=typeof i=="function"?i:function(p){return p.is(i)},this.proportions=function(){if(arguments.length)e=arguments[0];else return e||(e={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight})},this._addToManager(t.scope),t.addClasses&&this._addClass("ui-droppable")},_addToManager:function(e){s.ui.ddmanager.droppables[e]=s.ui.ddmanager.droppables[e]||[],s.ui.ddmanager.droppables[e].push(this)},_splice:function(e){for(var t=0;t<e.length;t++)e[t]===this&&e.splice(t,1)},_destroy:function(){var e=s.ui.ddmanager.droppables[this.options.scope];this._splice(e)},_setOption:function(e,t){if(e==="accept")this.accept=typeof t=="function"?t:function(p){return p.is(t)};else if(e==="scope"){var i=s.ui.ddmanager.droppables[this.options.scope];this._splice(i),this._addToManager(t)}this._super(e,t)},_activate:function(e){var t=s.ui.ddmanager.current;this._addActiveClass(),t&&this._trigger("activate",e,this.ui(t))},_deactivate:function(e){var t=s.ui.ddmanager.current;this._removeActiveClass(),t&&this._trigger("deactivate",e,this.ui(t))},_over:function(e){var t=s.ui.ddmanager.current;!t||(t.currentItem||t.element)[0]===this.element[0]||this.accept.call(this.element[0],t.currentItem||t.element)&&(this._addHoverClass(),this._trigger("over",e,this.ui(t)))},_out:function(e){var t=s.ui.ddmanager.current;!t||(t.currentItem||t.element)[0]===this.element[0]||this.accept.call(this.element[0],t.currentItem||t.element)&&(this._removeHoverClass(),this._trigger("out",e,this.ui(t)))},_drop:function(e,t){var i=t||s.ui.ddmanager.current,p=!1;return!i||(i.currentItem||i.element)[0]===this.element[0]||(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var r=s(this).droppable("instance");if(r.options.greedy&&!r.options.disabled&&r.options.scope===i.options.scope&&r.accept.call(r.element[0],i.currentItem||i.element)&&s.ui.intersect(i,s.extend(r,{offset:r.element.offset()}),r.options.tolerance,e))return p=!0,!1}),p)?!1:this.accept.call(this.element[0],i.currentItem||i.element)?(this._removeActiveClass(),this._removeHoverClass(),this._trigger("drop",e,this.ui(i)),this.element):!1},ui:function(e){return{draggable:e.currentItem||e.element,helper:e.helper,position:e.position,offset:e.positionAbs}},_addHoverClass:function(){this._addClass("ui-droppable-hover")},_removeHoverClass:function(){this._removeClass("ui-droppable-hover")},_addActiveClass:function(){this._addClass("ui-droppable-active")},_removeActiveClass:function(){this._removeClass("ui-droppable-active")}}),s.ui.intersect=function(){function e(t,i,p){return t>=i&&t<i+p}return function(t,i,p,r){if(!i.offset)return!1;var f=(t.positionAbs||t.position.absolute).left+t.margins.left,c=(t.positionAbs||t.position.absolute).top+t.margins.top,o=f+t.helperProportions.width,n=c+t.helperProportions.height,a=i.offset.left,d=i.offset.top,g=a+i.proportions().width,h=d+i.proportions().height;switch(p){case"fit":return a<=f&&o<=g&&d<=c&&n<=h;case"intersect":return a<f+t.helperProportions.width/2&&o-t.helperProportions.width/2<g&&d<c+t.helperProportions.height/2&&n-t.helperProportions.height/2<h;case"pointer":return e(r.pageY,d,i.proportions().height)&&e(r.pageX,a,i.proportions().width);case"touch":return(c>=d&&c<=h||n>=d&&n<=h||c<d&&n>h)&&(f>=a&&f<=g||o>=a&&o<=g||f<a&&o>g);default:return!1}}}(),s.ui.ddmanager={current:null,droppables:{default:[]},prepareOffsets:function(e,t){var i,p,r=s.ui.ddmanager.droppables[e.options.scope]||[],f=t?t.type:null,c=(e.currentItem||e.element).find(":data(ui-droppable)").addBack();t:for(i=0;i<r.length;i++)if(!(r[i].options.disabled||e&&!r[i].accept.call(r[i].element[0],e.currentItem||e.element))){for(p=0;p<c.length;p++)if(c[p]===r[i].element[0]){r[i].proportions().height=0;continue t}r[i].visible=r[i].element.css("display")!=="none",r[i].visible&&(f==="mousedown"&&r[i]._activate.call(r[i],t),r[i].offset=r[i].element.offset(),r[i].proportions({width:r[i].element[0].offsetWidth,height:r[i].element[0].offsetHeight}))}},drop:function(e,t){var i=!1;return s.each((s.ui.ddmanager.droppables[e.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&s.ui.intersect(e,this,this.options.tolerance,t)&&(i=this._drop.call(this,t)||i),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],e.currentItem||e.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,t)))}),i},dragStart:function(e,t){e.element.parentsUntil("body").on("scroll.droppable",function(){e.options.refreshPositions||s.ui.ddmanager.prepareOffsets(e,t)})},drag:function(e,t){e.options.refreshPositions&&s.ui.ddmanager.prepareOffsets(e,t),s.each(s.ui.ddmanager.droppables[e.options.scope]||[],function(){if(!(this.options.disabled||this.greedyChild||!this.visible)){var i,p,r,f=s.ui.intersect(e,this,this.options.tolerance,t),c=!f&&this.isover?"isout":f&&!this.isover?"isover":null;c&&(this.options.greedy&&(p=this.options.scope,r=this.element.parents(":data(ui-droppable)").filter(function(){return s(this).droppable("instance").options.scope===p}),r.length&&(i=s(r[0]).droppable("instance"),i.greedyChild=c==="isover")),i&&c==="isover"&&(i.isover=!1,i.isout=!0,i._out.call(i,t)),this[c]=!0,this[c==="isout"?"isover":"isout"]=!1,this[c==="isover"?"_over":"_out"].call(this,t),i&&c==="isout"&&(i.isout=!1,i.isover=!0,i._over.call(i,t)))}})},dragStop:function(e,t){e.element.parentsUntil("body").off("scroll.droppable"),e.options.refreshPositions||s.ui.ddmanager.prepareOffsets(e,t)}},s.uiBackCompat!==!1&&s.widget("ui.droppable",s.ui.droppable,{options:{hoverClass:!1,activeClass:!1},_addActiveClass:function(){this._super(),this.options.activeClass&&this.element.addClass(this.options.activeClass)},_removeActiveClass:function(){this._super(),this.options.activeClass&&this.element.removeClass(this.options.activeClass)},_addHoverClass:function(){this._super(),this.options.hoverClass&&this.element.addClass(this.options.hoverClass)},_removeHoverClass:function(){this._super(),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass)}}),s.ui.droppable})}}]);
