(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[86347,25655],{75520:(R,v,c)=>{R.exports=c(76932)},18340:(R,v,c)=>{"use strict";var S,h;S=[c(85233),c(7927)],h=function(P,y){let a,m=[],p=0,f;function g(n,t){typeof n!="string"&&(n=$(n),n=n.data("type")||n.attr("type")||n.prop("tagName"));const i=a.plugins[n.toLowerCase()];if(i==null)return;const e=i[t];return typeof e=="function"?e:null}return f={deepClone:function(n){return typeof n=="object"?JSON.parse(JSON.stringify(n)):n},createElement:function(n,t,i){const e=document.createElement(n);for(const o in t)t.hasOwnProperty(o)&&e.setAttribute(o,t[o]);return i&&e.appendChild(document.createTextNode(i)),e},initElement:function(n){const t=g(n,"init");t?.call(a,$(n))},destructElement:function(n){const t=g(n,"destruct");t?.call(a,$(n))},createElementOfType:function(n,t,i){let e;const o=g(n,"create");return o!=null?e=$(o.call(a,n,t,i)):(i==null&&(i={}),n!=null&&(i.type=n),e=$(f.createElement(t||"input",i))),e.data("type",n),f.initElement(e),e},cleanArray:function(n,t,i){const e=[];if(!t&&i)return n;for(let o=0;o<n.length;o+=1){let s=n[o];t&&(s===!!s?s=+s:s&&typeof s.trim=="function"&&(s=s.trim())),(i||s!=null&&s.length)&&e.push(s)}return e},isTrue:function(n){return n==="true"||+n==1},isFalse:function(n){return n==="false"||+n==0},readValue:function(n){let t=!f.isFalse(n.data("empty"));const i=!f.isFalse(n.data("trim")),e=n.data("split"),o=g(n,"get");let s;if(o!=null)return o.call(a,n,i,t);if(e!=null){t=f.isTrue(n.data("empty")),s=n.val();const r=s!=null&&s.split(e||",")||[];return f.cleanArray(r,i,t)}if(s=n.val(),i&&s!=null&&typeof s.trim=="function"&&(s=s.trim()),t||s!==void 0&&(s==null||s.length!==0))return s},fillField:function(n,t){const i=g(n,"set");let e=n.data("trim");if(e=e!=="false"&&+e!=0,i!=null)return i.call(a,n,t,e);t instanceof Array&&(t=t.join(n.data("split")||(e?", ":","))),e&&t&&typeof t.trim=="function"?(t=t.trim(),typeof t.toString=="function"&&(t=t.toString())):t!=null?(typeof t.toString=="function"&&(t=t.toString()),e&&(t=t.trim())):t="",t!==void 0&&n.val(t)},initFields:function(n){$("[data-key]",n).each(function(t,i){i=$(i);const e=g(i,"init"),o=i.data("key").split(".");let s=a.get();e?.call(a,i);for(let r=0;r<o.length;r+=1){const l=o[r];l&&s!=null&&(s=s[l])}f.fillField(i,s)})},registerReadyJobs:function(n){return p+=n,p},beforeReadyJobsDecreased:function(n){if(n==null&&(n=1),p>0&&(p-=n,p<=0)){for(let t=0;t<m.length;t+=1)m[t]();m=[]}},whenReady:function(n){p<=0?n():m.push(n)},serializeForm:function(n){const t=n.serializeObject();return n.find('input[type="checkbox"]').each(function(i,e){e=$(e),e.is(":checked")||(t[e.attr("name")]="off")}),n.find("select[multiple]").each(function(i,e){e=$(e),t[e.attr("name")]=JSON.stringify(e.val())}),t},persistSettings:function(n,t,i,e){t!=null&&t._!=null&&typeof t._!="string"&&(t=f.deepClone(t),t._=JSON.stringify(t._)),socket.emit("admin.settings.set",{hash:n,values:t},function(o){i&&(o?y.alert({title:"[[admin/admin:changes-not-saved]]",type:"danger",message:`[[admin/admin/changes-not-saved-message, ${o.message}]]`,timeout:5e3}):y.alert({title:"[[admin/admin:changes-saved]]",type:"success",message:"[[admin/admin:changes-saved-message]]",timeout:2500})),typeof e=="function"&&e(o)})},use:function(n){try{n._=JSON.parse(n._)}catch{}a.cfg=n}},a={helper:f,plugins:{},cfg:{},get:function(){return a.cfg!=null&&a.cfg._!==void 0?a.cfg._:a.cfg},registerPlugin:function(n,t){t==null?t=n.types:n.types=t,typeof n.use=="function"&&n.use.call(a);for(let i=0;i<t.length;i+=1){const e=t[i].toLowerCase();a.plugins[e]==null&&(a.plugins[e]=n)}},set:function(n,t,i,e,o){o==null&&(o=!0),f.whenReady(function(){f.use(t),f.initFields(i||"form"),f.persistSettings(n,t,o,e)})},sync:function(n,t,i){socket.emit("admin.settings.get",{hash:n},function(e,o){e?typeof i=="function"&&i(e):f.whenReady(function(){f.use(o),f.initFields(t||"form"),typeof i=="function"&&i()})})},persist:function(n,t,i,e){const o=[],s=$("[data-key]",t||"form").toArray();e==null&&(e=!0);for(let r=0;r<s.length;r+=1){const l=$(s[r]),d=f.readValue(l);let u=a.get();const A=l.data("key").split("."),F=A[A.length-1];if(A.length>1)for(let C=0;C<A.length-1;C+=1){const D=A[C];D&&u!=null&&(u=u[D])}u!=null?d!=null?u[F]=d:delete u[F]:o.push(l.data("key"))}o.length&&y.alert({title:"Attributes Not Saved",message:"'"+o.join(", ")+"' could not be saved. Please contact the plugin-author!",type:"danger",timeout:5e3}),f.persistSettings(n,a.cfg,e,i)},load:function(n,t,i){i=i||function(){};const e=t.attr("data-socket-get");socket.emit(e||"admin.settings.get",{hash:n},function(o,s){if(o)return i(o);$(t).find("select[multiple]").each(function(l,d){const u=$(d).attr("name");if(u&&s.hasOwnProperty(u))try{s[u]=JSON.parse(s[u])}catch{}}),ajaxify.data[e?n:"settings"]=s,f.whenReady(function(){$(t).find("[data-sorted-list]").each(function(l,d){g(d,"get").call(a,$(d),n)})}),$(t).deserialize(s),P.fire("action:admin.settingsLoaded"),$(t).on("change","input, select, textarea",function(){app.flags=app.flags||{},app.flags._unsaved=!0});const r=document.getElementById("save");r&&c.e(42441).then(function(){var l=[c(42441)];(function(d){d.bind("ctrl+s",function(u){r.click(),u.preventDefault()})}).apply(null,l)}).catch(c.oe),i(null,s)})},save:function(n,t,i){t=$(t);const e=t.get(0).elements;if(a.check(e)&&t.length){const s=f.serializeForm(t);f.whenReady(function(){const l=t.find("[data-sorted-list]");l.length&&l.each((d,u)=>{g(u,"set").call(a,$(u),s)})});const r=t.attr("data-socket-set");socket.emit(r||"admin.settings.set",{hash:n,values:s},function(l){if(app.flags._unsaved=!1,ajaxify.data[r?n:"settings"]=s,typeof i=="function")i(l);else if(l)y.alert({title:"[[admin/admin:changes-not-saved]]",message:`[[admin/admin:changes-not-saved-message, ${l.message}]]`,type:"error",timeout:2500});else{const d=document.getElementById("save");d.classList.toggle("saved",!0),setTimeout(()=>{d.classList.toggle("saved",!1)},1500)}})}},check:function(n){const t=i=>{const e=i.target.closest(".form-group");e&&e.classList.add("has-error"),i.target.removeEventListener("invalid",t)};return Array.prototype.map.call(n,i=>{const e=i.closest(".form-group");return e&&e.classList.remove("has-error"),i.addEventListener("invalid",t),i.reportValidity()}).every(Boolean)}},f.registerReadyJobs(1),Promise.all([c.e(66177),c.e(62526),c.e(26069)]).then(function(){var n=[c(16631),c(73143),c(7448),c(15101),c(846),c(88839),c(53411),c(66370)];(function(){for(let t=0;t<arguments.length;t+=1)a.registerPlugin(arguments[t]);f.beforeReadyJobsDecreased()}).apply(null,n)}).catch(c.oe),a}.apply(v,S),h!==void 0&&(R.exports=h)},76932:(R,v,c)=>{"use strict";var S,h;S=[c(18340),c(32230),c(7927)],h=function(P,y,a){const m={};return m.init=function(){P.load("question-and-answer",$(".question-and-answer-settings")),p(ajaxify.data.categories,$(".all-categories")),$("#save").on("click",function(){P.save("question-and-answer",$(".question-and-answer-settings"),function(){a.alert({type:"success",alert_id:"question-and-answer-saved",title:"Settings Saved",message:"Please reload your NodeBB to apply these settings",clickfn:function(){socket.emit("admin.reload")}})})});function p(f,g){n(f,g,0);function n(t,i,e){if(!t||!t.length)return;var o=0;t.forEach(function(r,l,d){y.translate(r.name,function(u){r.name!==u&&(r.name=u),o+=1,o===d.length&&s()})}),t.length||s();function s(){app.parseAndTranslate("admin/plugins/question-and-answer-items",{cid:e,categories:t},function(r){i.append(r);for(var l=0,d=t.length;l<d;l+=1)n(t[l].children,$('li[data-cid="'+t[l].cid+'"]'),t[l].cid);$(".question-and-answer-settings").deserialize(ajaxify.data.settings)})}}}},m}.apply(v,S),h!==void 0&&(R.exports=h)}}]);
