(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[59330,62735,10882,28306,43034,3564],{45482:(v,w,c)=>{v.exports=c(35729)},83713:(v,w,c)=>{v.exports=c(51077)},38259:(v,w,c)=>{v.exports=c(65616)},66603:(v,w,c)=>{"use strict";var g;g=function(){function m(){this._store={},this._keys=[]}m.prototype.isMock=!0,m.prototype.setItem=function(t,o){t=String(t),this._keys.indexOf(t)===-1&&this._keys.push(t),this._store[t]=o},m.prototype.getItem=function(t){return t=String(t),this._keys.indexOf(t)===-1?null:this._store[t]},m.prototype.removeItem=function(t){t=String(t),this._keys=this._keys.filter(function(o){return o!==t}),this._store[t]=null},m.prototype.clear=function(){this._keys=[],this._store={}},m.prototype.key=function(t){return t=parseInt(t,10)||0,this._keys[t]},Object.defineProperty&&Object.defineProperty(m.prototype,"length",{get:function(){return this._keys.length}});let f;const a=Date.now().toString();try{if(f=window.localStorage,f.setItem(a,a),f.getItem(a)!==a)throw Error("localStorage behaved unexpectedly");return f.removeItem(a),f}catch(t){console.warn(t),console.warn("localStorage failed, falling back on sessionStorage");try{if(f=window.sessionStorage,f.setItem(a,a),f.getItem(a)!==a)throw Error("sessionStorage behaved unexpectedly");return f.removeItem(a),f}catch(o){return console.warn(o),console.warn("sessionStorage failed, falling back on memory storage"),new m}}}.call(w,c,w,v),g!==void 0&&(v.exports=g)},27145:(v,w,c)=>{"use strict";v=c.nmd(v);var g,m;g=[c(32230),c(85233)],m=function(f,a){const t={};let o=!1;t.init=function(){if(t.taskbar=$('[component="taskbar"]'),t.tasklist=t.taskbar.find("ul"),!t.taskbar.length||!t.tasklist.length){o=!0;return}t.taskbar.on("click","li",async function(){const e=$(this),n=e.attr("data-module"),s=e.attr("data-uuid"),r=await app.require(n);return e.hasClass("active")?r.minimize(s):(i(),r.load(s),t.toggleNew(s,!1),t.tasklist.removeClass("active"),e.addClass("active")),!1}),$(window).on("action:app.loggedOut",function(){t.closeAll()})},t.close=async function(e,n){if(o)return;if(t.tasklist.find('[data-module="'+v+'"][data-uuid="'+n+'"]').length){const r=await app.require(e);r&&typeof r.close=="function"&&r.close(n)}},t.closeAll=function(e){if(o)return;let n="[data-uuid]";e&&(n='[data-module="'+e+'"]'+n),t.tasklist.find(n).each(function(s,r){t.close(e||r.getAttribute("data-module"),r.getAttribute("data-uuid"))})},t.discard=function(e,n){if(o)return;t.tasklist.find('[data-module="'+e+'"][data-uuid="'+n+'"]').remove(),d()},t.push=function(e,n,s,r){if(r=r||function(){},o)return r();const p=t.tasklist.find('li[data-uuid="'+n+'"]'),b={module:e,uuid:n,options:s,element:p};a.fire("filter:taskbar.push",b),!p.length&&b.module?l(b,r):r(p)},t.get=function(e){return o?[]:$('[data-module="'+e+'"]').map(function(s,r){return $(r).data()})},t.minimize=function(e,n){if(o)return;t.tasklist.find('[data-module="'+e+'"][data-uuid="'+n+'"]').toggleClass("active",!1)},t.toggleNew=function(e,n,s){if(o)return;t.tasklist.find('[data-uuid="'+e+'"]').toggleClass("new",n),s||a.fire("action:taskbar.toggleNew",e)},t.updateActive=function(e){if(o)return;const n=t.tasklist.find("li");n.removeClass("active"),n.filter('[data-uuid="'+e+'"]').addClass("active"),$("[data-uuid]:not([data-module])").toggleClass("modal-unfocused",!0),$('[data-uuid="'+e+'"]:not([data-module])').toggleClass("modal-unfocused",!1)},t.isActive=function(e){return o?!1:t.tasklist.find('li[data-uuid="'+e+'"]').hasClass("active")};function d(){if(o)return;t.tasklist.find("li").length>0?t.taskbar.attr("data-active","1"):t.taskbar.removeAttr("data-active")}function i(){o||t.tasklist.find(".active").removeClass("active")}function l(e,n){if(o)return n();f.translate(e.options.title,function(s){const r=$("<div></div>").text(s||"NodeBB Task").html(),p=$("<li></li>").addClass(e.options.className).html('<a href="#"'+(e.options.image?` style="background-image: url('`+e.options.image.replace(/&#x2F;/g,"/")+`'); background-size: cover;"`:"")+">"+(e.options.icon?'<i class="fa '+e.options.icon+'"></i> ':"")+'<span aria-label="'+r+'" component="taskbar/title">'+r+"</span></a>").attr({title:r,"data-module":e.module,"data-uuid":e.uuid}).addClass(e.options.state!==void 0?e.options.state:"active");(!e.options.state||e.options.state==="active")&&i(),t.tasklist.append(p),d(),e.element=p,p.data(e),a.fire("action:taskbar.pushed",e),n(p)})}const u=function(e,n,s){switch(n){case"title":e.find('[component="taskbar/title"]').text(s);break;case"icon":e.find("i").attr("class","fa fa-"+s);break;case"image":e.find("a").css("background-image",s?'url("'+s.replace(/&#x2F;/g,"/")+'")':"");break;case"background-color":e.find("a").css("background-color",s);break;case"color":e.find("a").css("color",s);break}};return t.update=function(e,n,s){if(o)return;const r=t.tasklist.find('[data-module="'+e+'"][data-uuid="'+n+'"]');if(!r.length)return;const p=r.data();Object.keys(s).forEach(function(b){p[b]=s[b],u(r,b,s[b])}),r.data(p)},t}.apply(w,g),m!==void 0&&(v.exports=m)},62023:(v,w,c)=>{"use strict";var g,m;g=[c(74344),c(63281),c(7927),c(50431),c(59006),c(32230),c(62526)],m=function(f,a,t,o,d,i){const l={};return l.get=u=>f.get(`/topics/${u}/thumbs`,{}),l.getByPid=u=>f.get(`/posts/${u}`,{}).then(e=>l.get(e.tid)),l.delete=(u,e)=>f.del(`/topics/${u}/thumbs`,{path:e}),l.deleteAll=u=>{l.get(u).then(e=>{Promise.all(e.map(n=>l.delete(u,n.url)))})},l.upload=u=>new Promise(e=>{o.show({title:"[[topic:composer.thumb_title]]",method:"put",route:config.relative_path+`/api/v3/topics/${u}/thumbs`},function(n){e(n)})}),l.modal={},l.modal.open=function(u){const{id:e,pid:n}=u;let{modal:s}=u,r;return new Promise(p=>{Promise.all([l.get(e),n?l.getByPid(n):[]]).then(b=>new Promise(E=>{const F=b.reduce((I,h)=>I.concat(h));r=F.length,E(F)})).then(b=>d.render("modals/topic-thumbs",{thumbs:b})).then(b=>{s?i.translate(b,function(E){s.find(".bootbox-body").html(E),l.modal.handleSort({modal:s,numThumbs:r})}):(s=a.dialog({title:"[[modules:thumbs.modal.title]]",message:b,onEscape:!0,backdrop:!0,buttons:{add:{label:'<i class="fa fa-plus"></i> [[modules:thumbs.modal.add]]',className:"btn-success",callback:()=>(l.upload(e).then(()=>{l.modal.open({...u,modal:s}),Promise.all([c.e(61006),c.e(42265),c.e(49915),c.e(8311)]).then(function(){var E=[c(44541)];(F=>{F.updateThumbCount(e,$(`[component="composer"][data-uuid="${e}"]`)),p()}).apply(null,E)}).catch(c.oe)}),!1)},close:{label:"[[global:close]]",className:"btn-primary"}}}),l.modal.handleDelete({...u,modal:s}),l.modal.handleSort({modal:s,numThumbs:r}))})})},l.modal.handleDelete=u=>{u.modal.get(0).addEventListener("click",n=>{n.target.closest('button[data-action="remove"]')&&a.confirm("[[modules:thumbs.modal.confirm-remove]]",s=>{if(!s)return;const r=n.target.closest("[data-id]").getAttribute("data-id"),p=n.target.closest("[data-path]").getAttribute("data-path");f.del(`/topics/${r}/thumbs`,{path:p}).then(()=>{l.modal.open(u)}).catch(t.error)})})},l.modal.handleSort=({modal:u,numThumbs:e})=>{if(e>1){const n=u.find(".topic-thumbs-modal");n.sortable({items:"[data-id]"}),n.on("sortupdate",l.modal.handleSortChange)}},l.modal.handleSortChange=(u,e)=>{const n=e.item.get(0).parentNode.querySelectorAll("[data-id]");Array.from(n).forEach((s,r)=>{const p=s.getAttribute("data-id");let b=s.getAttribute("data-path");b=b.replace(new RegExp(`^${config.upload_url}`),""),f.put(`/topics/${p}/thumbs/order`,{path:b,order:r}).catch(t.error)})},l}.apply(w,g),m!==void 0&&(v.exports=m)},50431:(v,w,c)=>{"use strict";var g,m;g=[c(86569)],m=function(){const f={};f.show=function(i,l){const u=i.hasOwnProperty("fileSize")&&i.fileSize!==void 0?parseInt(i.fileSize,10):!1;app.parseAndTranslate("modals/upload-file",{showHelp:i.hasOwnProperty("showHelp")&&i.showHelp!==void 0?i.showHelp:!0,fileSize:u,title:i.title||"[[global:upload_file]]",description:i.description||"",button:i.button||"[[global:upload]]",accept:i.accept?i.accept.replace(/,/g,"&#44; "):""},function(e){e.modal("show"),e.on("hidden.bs.modal",function(){e.remove()});const n=e.find("#uploadForm");n.attr("action",i.route),n.find("#params").val(JSON.stringify(i.params)),e.find("#fileUploadSubmitBtn").on("click",function(){$(this).addClass("disabled"),n.submit()}),n.submit(function(){return a(e,u,l),!1})})},f.hideAlerts=function(i){$(i).find("#alert-status, #alert-success, #alert-error, #upload-progress-box").addClass("hide")};function a(i,l,u){t(i,"status","[[uploads:uploading-file]]"),i.find("#upload-progress-bar").css("width","0%"),i.find("#upload-progress-box").show().removeClass("hide");const e=i.find("#fileInput");if(!e.val())return t(i,"error","[[uploads:select-file-to-upload]]");if(!d(e[0],l))return t(i,"error","[[error:file-too-big, "+l+"]]");f.ajaxSubmit(i,u)}function t(i,l,u){f.hideAlerts(i),l==="error"&&i.find("#fileUploadSubmitBtn").removeClass("disabled"),u=u.replace(/&amp;#44/g,"&#44"),i.find("#alert-"+l).translateText(u).removeClass("hide")}f.ajaxSubmit=function(i,l){i.find("#uploadForm").ajaxSubmit({headers:{"x-csrf-token":config.csrf_token},error:function(e){e=o(e),t(i,"error",e.responseJSON?.status?.message||e.responseJSON?.error||`[[error:upload-error-fallback, ${e.status} ${e.statusText}]]`)},uploadProgress:function(e,n,s,r){i.find("#upload-progress-bar").css("width",r+"%")},success:function(e){let n=o(e);e.hasOwnProperty("response")&&e.hasOwnProperty("status")&&e.status.code==="ok"&&(n=e.response.images),l(n[0].url),t(i,"success","[[uploads:upload-success]]"),setTimeout(function(){f.hideAlerts(i),i.modal("hide")},750)}})};function o(i){if(typeof i=="string")try{return JSON.parse(i)}catch{return{error:"[[error:parse-error]]"}}return i}function d(i,l){return window.FileReader&&l?i.files[0].size<=l*1e3:!0}return f}.apply(w,g),m!==void 0&&(v.exports=m)},35729:(v,w,c)=>{"use strict";var g,m;g=[c(83713),c(38259),c(62023),c(10577)],m=function(f,a,t,o){var d={},i={picture:function(){var e=this;e.find("#files").click()},upload:function(){var e=this;e.find("#files").click()},thumbs:function(){d.exitFullscreen();var e=this;Promise.all([c.e(61006),c.e(42265),c.e(49915),c.e(92497)]).then(function(){var n=[c(44541)];(function(s){const r=e.get(0).getAttribute("data-uuid"),p=s.posts[r];(p.action==="topics.post"||p.action==="posts.edit"&&p.isMain)&&t.modal.open({id:r,pid:p.pid}).then(()=>{e.trigger("thumb.uploaded"),s.updateThumbCount(r,e)})}).apply(null,n)}).catch(c.oe)},tags:function(){var e=this;e.find(".tags-container").toggleClass("hidden")},zen:function(){var e=this;$(window).one("resize",function(){function n(){o.isFullscreen||(app.toggleNavbar(!0),$("html").removeClass("zen-mode"),a.reposition(e),$(window).off("resize",n))}o.isFullscreen&&(app.toggleNavbar(!1),$("html").addClass("zen-mode"),e.find(".write").focus(),$(window).on("resize",n),$(window).one("action:composer.topics.post action:composer.posts.reply action:composer.posts.edit action:composer.discard",o.exit))}),o.toggle(e.get(0)),$(window).trigger("action:composer.fullscreen",{postContainer:e})}},l=[];d.exitFullscreen=function(){o.isEnabled&&o.isFullscreen&&o.exit()},d.addComposerButtons=function(){const e=$(".formatting-bar .formatting-group #fileForm");l.forEach(n=>{let s="";Array.isArray(n.dropdownItems)&&n.dropdownItems.length?s=u(n):s=`
					<li data-format="${n.name}" title="${n.title||""}" href="#" class="btn btn-sm btn-link text-reset position-relative" tabindex="-1">
						<i class="${n.iconClass}"></i>
					</li>
				`,e.before(s)})};function u(e){const n=e.dropdownItems.map(function(s){let r="";return s.badge&&(r='<span class="px-1 position-absolute top-0 start-100 translate-middle-x badge rounded text-bg-info"></span>'),`
				<li data-format="${s.name}">
					<a href="#" class="dropdown-item rounded-1 position-relative">
						<i class="${s.iconClass} text-secondary"></i> ${s.text}
						${r}
					</a>
				</li>
			`});return`
			<li class="dropdown bottom-sheet" tab-index="-1">
				<button class="btn btn-sm btn-link text-reset" data-bs-toggle="dropdown" title="${e.title}">
					<i class="${e.iconClass}"></i>
				</button>
				<ul class="dropdown-menu p-1">
				${n}
				</ul>
			</li>
		`}return d.addButton=function(e,n,s,r){r=r||e.replace("fa fa-",""),i[r]=n,l.push({name:r,iconClass:e,title:s})},d.addDropdown=function(e){l.push({iconClass:e.iconClass,title:e.title,dropdownItems:e.dropdownItems}),e.dropdownItems.forEach(n=>{n.name&&n.onClick&&(i[n.name]=n.onClick)})},d.getDispatchTable=function(){return i},d.addButtonDispatch=function(e,n){i[e]=n},d.addHandler=function(e){e.on("click",".formatting-bar li[data-format]",function(n){var s=$(this).attr("data-format"),r=$(this).parents('[component="composer"]').find("textarea")[0];i.hasOwnProperty(s)&&(i[s].call(e,r,r.selectionStart,r.selectionEnd,n),f.render(e))})},d}.apply(w,g),m!==void 0&&(v.exports=m)},51077:(v,w,c)=>{"use strict";var g,m;g=[c(85233)],m=function(f){var a={};return a.render=function(t,o){if(o=o||function(){},!t.find(".preview-container").is(":visible"))return o();var d=t.find("textarea");socket.emit("plugins.composer.renderPreview",d.val(),function(i,l){i||(l=$("<div>"+l+"</div>"),l.find("img:not(.not-responsive)").addClass("img-fluid"),t.find(".preview").html(l),f.fire("action:composer.preview",{postContainer:t,preview:l}),o())})},a.matchScroll=function(t){if(t.find(".preview-container").is(":visible")){var o=t.find("textarea"),d=t.find(".preview");if(o.length&&d.length){var i=o[0].scrollHeight-o.height();if(i===0)return;var l=o.scrollTop()/i;d.scrollTop(Math.max(d[0].scrollHeight-d.height(),0)*l)}}},a.handleToggler=function(t){const o=t.get(0);a.env=utils.findBootstrapEnvironment();const d=["xs","sm"].includes(a.env),i=o.querySelector('.formatting-bar [data-action="preview"]'),l=i.querySelector(".show-text"),u=i.querySelector(".hide-text"),e=localStorage.getItem("composer:previewToggled"),n=config["composer-default"].hidePreviewOnOpen==="on";let s=!d&&(e===null&&!n||e);const r=o.querySelector(".preview-container"),p=o.querySelector(".write-container");if(!i)return;function b(E){d?(r.classList.toggle("hide",!1),p.classList.toggle("maximized",!1),r.classList.toggle("d-none",!E),r.classList.toggle("d-flex",E),r.classList.toggle("w-100",E),p.classList.toggle("d-flex",!E),p.classList.toggle("d-none",E),p.classList.toggle("w-100",!E)):(r.classList.toggle("hide",!E),p.classList.toggle("w-50",E),p.classList.toggle("w-100",!E),localStorage.setItem("composer:previewToggled",E)),l.classList.toggle("hide",E),u.classList.toggle("hide",!E),E&&a.render(t),a.matchScroll(t)}a.toggle=b,i.addEventListener("click",E=>{E.button===0&&(s=!s,b(s))}),b(s)},a}.apply(w,g),m!==void 0&&(v.exports=m)},65616:(v,w,c)=>{"use strict";var g,m;g=[c(27145)],m=function(f){var a={},t=0,o=.3,d=.05,i=768,l=$("body"),u=$(window),e=$('[component="navbar"]');const n=document.getElementById("content");var s=e[0];function r(){return localStorage.getItem("composer:resizeRatio")||.5}function p(h){localStorage.setItem("composer:resizeRatio",Math.min(h,1))}function b(){var h;s?h=s.getBoundingClientRect():h={bottom:0};var A=Math.max(h.bottom,0),x={top:0,left:0,right:window.innerWidth,bottom:window.innerHeight};return x.width=x.right,x.height=x.bottom,x.boundedTop=A,x.boundedHeight=x.bottom-A,x}function E(h,A){var x=b(),y=h[0],D=window.getComputedStyle(y),T=parseInt(D.getPropertyValue("min-height"),10),B=Math.max(T/window.innerHeight,o);if(x.width>=i){const N=(x.height-x.boundedHeight)/x.height;A=Math.min(Math.max(A,B+N),1);var P=A*x.boundedHeight/x.height;y.style.top=((1-P)*100).toString()+"%";var z=y.getBoundingClientRect();n.style.paddingBottom=(z.bottom-z.top).toString()+"px"}else y.style.top=0,n.style.paddingBottom=0;h.ratio=A,f.updateActive(h.attr("data-uuid"))}var F=E,I=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame;return I&&(F=function(h,A){I(function(){E(h,A),setTimeout(function(){u.trigger("action:composer.resize"),h.trigger("action:composer.resize")},0)})}),a.reposition=function(h){var A=r();A>=1-d&&(A=1,h.addClass("maximized")),F(h,A)},a.maximize=function(h,A){A?F(h,1):a.reposition(h)},a.handleResize=function(h){var A=0,x=0,y=0,D=h.find(".resizer"),T=D[0];function B(S){var R=T.getBoundingClientRect(),k=(R.top+R.bottom)/2;A=(k-S.clientY)/2,x=S.clientY,u.on("mousemove",P),u.on("mouseup",z),l.on("touchmove",N)}function P(S){var R=S.clientY-A,k=b(),C=(k.height-R)/k.boundedHeight;F(h,C)}function z(S){S.preventDefault(),y=S.clientY,h.find("textarea").focus(),u.off("mousemove",P),u.off("mouseup",z),l.off("touchmove",N);var R=y-A,k=b(),C=(k.height-R)/k.boundedHeight;y-x===0&&h.hasClass("maximized")?(h.removeClass("maximized"),C=!t||t>=1-d?.5:t,F(h,C)):y-x===0||C>=1-d?(F(h,1),h.addClass("maximized"),t=C):h.removeClass("maximized"),p(C)}function N(S){S.preventDefault(),P(S.touches[0])}D.on("mousedown",function(S){S.button===0&&(S.preventDefault(),B(S))}).on("touchstart",function(S){S.preventDefault(),B(S.touches[0])}).on("touchend",z)},a}.apply(w,g),m!==void 0&&(v.exports=m)},10577:v=>{/*!
* screenfull
* v5.2.0 - 2021-11-03
* (c) Sindre Sorhus; MIT License
*/(function(){"use strict";var w=typeof window<"u"&&typeof window.document<"u"?window.document:{},c=v.exports,g=function(){for(var a,t=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],o=0,d=t.length,i={};o<d;o++)if(a=t[o],a&&a[1]in w){for(o=0;o<a.length;o++)i[t[0][o]]=a[o];return i}return!1}(),m={change:g.fullscreenchange,error:g.fullscreenerror},f={request:function(a,t){return new Promise(function(o,d){var i=function(){this.off("change",i),o()}.bind(this);this.on("change",i),a=a||w.documentElement;var l=a[g.requestFullscreen](t);l instanceof Promise&&l.then(i).catch(d)}.bind(this))},exit:function(){return new Promise(function(a,t){if(!this.isFullscreen){a();return}var o=function(){this.off("change",o),a()}.bind(this);this.on("change",o);var d=w[g.exitFullscreen]();d instanceof Promise&&d.then(o).catch(t)}.bind(this))},toggle:function(a,t){return this.isFullscreen?this.exit():this.request(a,t)},onchange:function(a){this.on("change",a)},onerror:function(a){this.on("error",a)},on:function(a,t){var o=m[a];o&&w.addEventListener(o,t,!1)},off:function(a,t){var o=m[a];o&&w.removeEventListener(o,t,!1)},raw:g};if(!g){c?v.exports={isEnabled:!1}:window.screenfull={isEnabled:!1};return}Object.defineProperties(f,{isFullscreen:{get:function(){return!!w[g.fullscreenElement]}},element:{enumerable:!0,get:function(){return w[g.fullscreenElement]}},isEnabled:{enumerable:!0,get:function(){return!!w[g.fullscreenEnabled]}}}),c?v.exports=f:window.screenfull=f})()}}]);
