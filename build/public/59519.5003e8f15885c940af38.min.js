(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[59519,70565,83014,99617,89743,93230,588,62735,10882,80560,73382,10999,28306,43034,79191,3564,74344,92497,8311,59330,76830],{74344:(x,E,a)=>{"use strict";a.r(E),a.d(E,{del:()=>r,get:()=>c,head:()=>f,patch:()=>e,post:()=>g,put:()=>t});var h=a(85233),v=a.n(h),p=a(63281),u=a.n(p);const n=config.relative_path+"/api/v3";function l(i,s){if(i.url=i.url.startsWith("/api")?config.relative_path+i.url:n+i.url,typeof s=="function"){b(i,s);return}return new Promise((m,w)=>{b(i,function(A,R){if(A)return A.message==="A valid login session was not found. Please log in and try again."?(0,p.confirm)("[[error:api.reauth-required]]",S=>{S&&ajaxify.go("login")}):w(A);m(R)})})}async function b(i,s){const{url:m}=i;delete i.url,i.data&&!(i.data instanceof FormData)&&(i.data=JSON.stringify(i.data||{}),i.headers["content-type"]="application/json; charset=utf-8"),{options:i}=await(0,h.fire)("filter:api.options",{options:i}),i.data&&(i.body=i.data,delete i.data);const w=await fetch(m,i),{headers:A}=w,R=A.get("content-type"),S=R&&R.startsWith("application/json");let I;if(S?I=await w.json():I=await w.text(),!w.ok)return s(new Error(S?I.status.message:I));s(null,S&&I.hasOwnProperty("status")&&I.hasOwnProperty("response")?I.response:I)}function c(i,s,m){return l({url:i+(s&&Object.keys(s).length?"?"+$.param(s):"")},m)}function f(i,s,m){return l({url:i+(s&&Object.keys(s).length?"?"+$.param(s):""),method:"head"},m)}function g(i,s,m){return l({url:i,method:"post",data:s,headers:{"x-csrf-token":config.csrf_token}},m)}function e(i,s,m){return l({url:i,method:"patch",data:s,headers:{"x-csrf-token":config.csrf_token}},m)}function t(i,s,m){return l({url:i,method:"put",data:s,headers:{"x-csrf-token":config.csrf_token}},m)}function r(i,s,m){return l({url:i,method:"delete",data:s,headers:{"x-csrf-token":config.csrf_token}},m)}},47913:(x,E,a)=>{x.exports=a(66485)},45482:(x,E,a)=>{x.exports=a(35729)},83713:(x,E,a)=>{x.exports=a(51077)},38259:(x,E,a)=>{x.exports=a(65616)},11120:x=>{"use strict";x.exports=function(E,a,h){a.setGlobal("true",!0),a.setGlobal("false",!1);const v=24*60*60*1e3,p={displayMenuItem:n,buildMetaTag:l,buildLinkTag:b,stringify:c,escape:f,stripTags:g,buildCategoryIcon:e,buildCategoryLabel:t,generateCategoryBackground:r,generateChildrenCategories:i,generateTopicClass:s,membershipBtn:m,spawnPrivilegeStates:w,localeToHTML:A,renderTopicImage:R,renderDigestAvatar:S,userAgentIcons:I,buildAvatar:D,increment:k,generateRepliedTo:N,generateWrote:H,isoTimeToLocaleString:M,shouldHideReplyContainer:T,humanReadableNumber:L,formattedNumber:O,register:P,__escape:u};function u(o){return o}function n(o,d){const y=o.navigation[d];return!(!y||y.route.match("/users")&&o.user&&!o.user.privileges["view:users"]||y.route.match("/tags")&&o.user&&!o.user.privileges["view:tags"]||y.route.match("/groups")&&o.user&&!o.user.privileges["view:groups"])}function l(o){const d=o.name?'name="'+o.name+'" ':"",y=o.property?'property="'+o.property+'" ':"",C=o.content?'content="'+o.content.replace(/\n/g," ")+'" ':"";return"<meta "+d+y+C+`/>
	`}function b(o){const d=["link","rel","as","type","href","sizes","title","crossorigin"],[y,C,z,F,B,W,U,Y]=d.map(K=>o[K]?`${K}="${o[K]}" `:"");return"<link "+y+C+z+F+W+U+B+Y+`/>
	`}function c(o){return JSON.stringify(o).replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/g,"&quot;")}function f(o){return E.escapeHTML(o)}function g(o){return E.stripHTMLTags(o)}function e(o,d,y){return o?`<span class="icon d-inline-flex justify-content-center align-items-center align-middle ${y}" style="${r(o)} width:${d}; height: ${d}; font-size: ${parseInt(d,10)/2}px;">${o.icon?`<i class="fa fa-fw ${o.icon}"></i>`:""}</span>`:""}function t(o,d=""){return o?`<span class="badge px-1 ${d}" style="color: ${o.color};background-color: ${o.bgColor};border-color: ${o.bgColor}!important;">
			${o.icon&&o.icon!=="fa-nbb-none"?`<i class="fa fa-fw ${o.icon}"></i>`:""}
			${o.name}
		</span>`:""}function r(o){if(!o)return"";const d=[];return o.bgColor&&(d.push("background-color: "+o.bgColor),d.push(`border-color: ${o.bgColor}!important`)),o.color&&d.push("color: "+o.color),o.backgroundImage&&(d.push("background-image: url("+o.backgroundImage+")"),o.imageClass&&d.push("background-size: "+o.imageClass)),d.join("; ")+";"}function i(o){let d="";return!o||!o.children||!o.children.length||(o.children.forEach(function(y){if(y&&!y.isSection){const C=y.link?y.link:h+"/category/"+y.slug;d+='<span class="category-children-item float-start"><div role="presentation" class="icon float-start" style="'+r(y)+'"><i class="fa fa-fw '+y.icon+'"></i></div><a href="'+C+'"><small>'+y.name+"</small></a></span>"}}),d=d&&'<span class="category-children">'+d+"</span>"),d}function s(o){return["locked","pinned","deleted","unread","scheduled"].filter(y=>!!o[y]).join(" ")}function m(o,d=""){return o.isMember&&o.name!=="administrators"?`<button class="btn btn-danger ${d}" data-action="leave" data-group="${o.displayName}" ${o.disableLeave?" disabled":""}><i class="fa fa-times"></i> [[groups:membership.leave-group]]</button>`:o.isPending&&o.name!=="administrators"?`<button class="btn btn-warning disabled ${d}"><i class="fa fa-clock-o"></i> [[groups:membership.invitation-pending]]</button>`:o.isInvited?`<button class="btn btn-link" data-action="rejectInvite" data-group="${o.displayName}">[[groups:membership.reject]]</button><button class="btn btn-success" data-action="acceptInvite" data-group="${o.name}"><i class="fa fa-plus"></i> [[groups:membership.accept-invitation]]</button>`:!o.disableJoinRequests&&o.name!=="administrators"?`<button class="btn btn-success" data-action="join" data-group="${o.displayName}"><i class="fa fa-plus"></i> [[groups:membership.join-group]]</button>`:""}function w(o,d){const y=[];for(const C in d)d.hasOwnProperty(C)&&y.push({name:C,state:d[C]});return y.map(function(C){const z=["groups:moderate","groups:posts:upvote","groups:posts:downvote","groups:local:login","groups:group:create"],F=["groups:find","groups:read","groups:topics:read","groups:view:users","groups:view:tags","groups:view:groups"],B=["groups:moderate"],W=o==="guests"&&(z.includes(C.name)||C.name.startsWith("groups:admin:"))||o==="spiders"&&!F.includes(C.name)||o==="Global Moderators"&&B.includes(C.name);return`
				<td data-privilege="${C.name}" data-value="${C.state}">
					<div class="form-check text-center">
						<input class="form-check-input float-none" autocomplete="off" type="checkbox"${C.state?" checked":""}${W?' disabled="disabled"':""} />
					</div>
				</td>
			`}).join("")}function A(o,d){return o=o||d||"en-GB",o.replace("_","-")}function R(o){return o.thumb?'<img src="'+o.thumb+'" class="img-circle user-img" title="'+o.user.username+'" />':'<img component="user/picture" data-uid="'+o.user.uid+'" src="'+o.user.picture+'" class="user-img" title="'+o.user.username+'" />'}function S(o){return o.teaser?o.teaser.user.picture?'<img style="vertical-align: middle; width: 32px; height: 32px; border-radius: 50%;" src="'+o.teaser.user.picture+'" title="'+o.teaser.user.username+'" />':'<div style="vertical-align: middle; width: 32px; height: 32px; line-height: 32px; font-size: 16px; background-color: '+o.teaser.user["icon:bgColor"]+'; color: white; text-align: center; display: inline-block; border-radius: 50%;">'+o.teaser.user["icon:text"]+"</div>":o.user.picture?'<img style="vertical-align: middle; width: 32px; height: 32px; border-radius: 50%;" src="'+o.user.picture+'" title="'+o.user.username+'" />':'<div style="vertical-align: middle; width: 32px; height: 32px; line-height: 32px; font-size: 16px; background-color: '+o.user["icon:bgColor"]+'; color: white; text-align: center; display: inline-block; border-radius: 50%;">'+o.user["icon:text"]+"</div>"}function I(o){let d="";switch(o.platform){case"Linux":d+='<i class="fa fa-fw fa-linux"></i>';break;case"Microsoft Windows":d+='<i class="fa fa-fw fa-windows"></i>';break;case"Apple Mac":d+='<i class="fa fa-fw fa-apple"></i>';break;case"Android":d+='<i class="fa fa-fw fa-android"></i>';break;case"iPad":d+='<i class="fa fa-fw fa-tablet"></i>';break;case"iPod":case"iPhone":d+='<i class="fa fa-fw fa-mobile"></i>';break;default:d+='<i class="fa fa-fw fa-question-circle"></i>';break}switch(o.browser){case"Chrome":d+='<i class="fa fa-fw fa-chrome"></i>';break;case"Firefox":d+='<i class="fa fa-fw fa-firefox"></i>';break;case"Safari":d+='<i class="fa fa-fw fa-safari"></i>';break;case"IE":d+='<i class="fa fa-fw fa-internet-explorer"></i>';break;case"Edge":d+='<i class="fa fa-fw fa-edge"></i>';break;default:d+='<i class="fa fa-fw fa-question-circle"></i>';break}return d}function D(o,d,y,C,z){o||(o=this);const F=new Map([["alt",o.username],["title",o.username],["data-uid",o.uid],["loading","lazy"]]),B=[`--avatar-size: ${d};`],W=Y=>Array.from(Y).reduce((K,[J,_])=>(K+=` ${J}="${_}"`,K),"");C=C||"",F.set("class",`avatar ${C}${y?" avatar-rounded":""}`);let U="";return o.picture&&(F.set("component",z||"avatar/picture"),U+="<img "+W(F)+' src="'+o.picture+'" style="'+B.join(" ")+'" onError="this.remove();" itemprop="image" />'),F.set("component",z||"avatar/icon"),B.push("background-color: "+o["icon:bgColor"]+";"),U+="<span "+W(F)+' style="'+B.join(" ")+'">'+o["icon:text"]+"</span>",U}function k(o,d){return o+parseInt(d,10)}function N(o,d){const y=o.parent&&o.parent.displayname?o.parent.displayname:"[[global:guest]]";return`[[topic:replied-to-user-${o.timestamp<Date.now()-d*v?"on":"ago"}, ${o.toPid}, ${h}/post/${o.toPid}, ${y}, ${h}/post/${o.pid}, ${o.timestampISO}]]`}function H(o,d){return`[[topic:wrote-${o.timestamp<Date.now()-d*v?"on":"ago"}, ${h}/post/${o.pid}, ${o.timestampISO}]]`}function M(o){return new Date(o).toLocaleString().replace(/,/g,"&#44;")}function T(o){return!!(o.replies.count<=0||o.replies.hasSingleImmediateReply)}function L(o,d=1){return E.makeNumberHumanReadable(o,d)}function O(o){return E.addCommas(o)}function P(){Object.keys(p).forEach(function(o){a.registerHelper(o,p[o])})}return p}},59265:(x,E,a)=>{"use strict";var h,v;const p=a(11120);h=[a(96795),a(59006)],v=function(u,n){return p(u,n,config.relative_path)}.apply(E,h),v!==void 0&&(x.exports=v)},22568:(x,E,a)=>{"use strict";var h,v,p;(function(u){v=[a(20648)],h=u,p=typeof h=="function"?h.apply(E,v):h,p!==void 0&&(x.exports=p)})(function(u){const n=u("[^\\p{L}\\s\\d\\-_]","g"),l=/[^\w\s\d\-_]/g,b=/^\s+|\s+$/g,c=/\s+/g,f=/-+/g,g=/-$/g,e=/^-/g,t=/^[\w\d\s.,\-@]+$/;return function(i,s){return i?(i=String(i).replace(b,""),t.test(i)?i=i.replace(l,"-"):i=u.replace(i,n,"-"),i=s?i:i.toLocaleLowerCase(),i=i.replace(c,"-"),i=i.replace(f,"-"),i=i.replace(g,""),i=i.replace(e,""),i):""}})},66603:(x,E,a)=>{"use strict";var h;h=function(){function v(){this._store={},this._keys=[]}v.prototype.isMock=!0,v.prototype.setItem=function(n,l){n=String(n),this._keys.indexOf(n)===-1&&this._keys.push(n),this._store[n]=l},v.prototype.getItem=function(n){return n=String(n),this._keys.indexOf(n)===-1?null:this._store[n]},v.prototype.removeItem=function(n){n=String(n),this._keys=this._keys.filter(function(l){return l!==n}),this._store[n]=null},v.prototype.clear=function(){this._keys=[],this._store={}},v.prototype.key=function(n){return n=parseInt(n,10)||0,this._keys[n]},Object.defineProperty&&Object.defineProperty(v.prototype,"length",{get:function(){return this._keys.length}});let p;const u=Date.now().toString();try{if(p=window.localStorage,p.setItem(u,u),p.getItem(u)!==u)throw Error("localStorage behaved unexpectedly");return p.removeItem(u),p}catch(n){console.warn(n),console.warn("localStorage failed, falling back on sessionStorage");try{if(p=window.sessionStorage,p.setItem(u,u),p.getItem(u)!==u)throw Error("sessionStorage behaved unexpectedly");return p.removeItem(u),p}catch(l){return console.warn(l),console.warn("sessionStorage failed, falling back on memory storage"),new v}}}.call(E,a,E,x),h!==void 0&&(x.exports=h)},27145:(x,E,a)=>{"use strict";x=a.nmd(x);var h,v;h=[a(32230),a(85233)],v=function(p,u){const n={};let l=!1;n.init=function(){if(n.taskbar=$('[component="taskbar"]'),n.tasklist=n.taskbar.find("ul"),!n.taskbar.length||!n.tasklist.length){l=!0;return}n.taskbar.on("click","li",async function(){const e=$(this),t=e.attr("data-module"),r=e.attr("data-uuid"),i=await app.require(t);return e.hasClass("active")?i.minimize(r):(c(),i.load(r),n.toggleNew(r,!1),n.tasklist.removeClass("active"),e.addClass("active")),!1}),$(window).on("action:app.loggedOut",function(){n.closeAll()})},n.close=async function(e,t){if(l)return;if(n.tasklist.find('[data-module="'+x+'"][data-uuid="'+t+'"]').length){const i=await app.require(e);i&&typeof i.close=="function"&&i.close(t)}},n.closeAll=function(e){if(l)return;let t="[data-uuid]";e&&(t='[data-module="'+e+'"]'+t),n.tasklist.find(t).each(function(r,i){n.close(e||i.getAttribute("data-module"),i.getAttribute("data-uuid"))})},n.discard=function(e,t){if(l)return;n.tasklist.find('[data-module="'+e+'"][data-uuid="'+t+'"]').remove(),b()},n.push=function(e,t,r,i){if(i=i||function(){},l)return i();const s=n.tasklist.find('li[data-uuid="'+t+'"]'),m={module:e,uuid:t,options:r,element:s};u.fire("filter:taskbar.push",m),!s.length&&m.module?f(m,i):i(s)},n.get=function(e){return l?[]:$('[data-module="'+e+'"]').map(function(r,i){return $(i).data()})},n.minimize=function(e,t){if(l)return;n.tasklist.find('[data-module="'+e+'"][data-uuid="'+t+'"]').toggleClass("active",!1)},n.toggleNew=function(e,t,r){if(l)return;n.tasklist.find('[data-uuid="'+e+'"]').toggleClass("new",t),r||u.fire("action:taskbar.toggleNew",e)},n.updateActive=function(e){if(l)return;const t=n.tasklist.find("li");t.removeClass("active"),t.filter('[data-uuid="'+e+'"]').addClass("active"),$("[data-uuid]:not([data-module])").toggleClass("modal-unfocused",!0),$('[data-uuid="'+e+'"]:not([data-module])').toggleClass("modal-unfocused",!1)},n.isActive=function(e){return l?!1:n.tasklist.find('li[data-uuid="'+e+'"]').hasClass("active")};function b(){if(l)return;n.tasklist.find("li").length>0?n.taskbar.attr("data-active","1"):n.taskbar.removeAttr("data-active")}function c(){l||n.tasklist.find(".active").removeClass("active")}function f(e,t){if(l)return t();p.translate(e.options.title,function(r){const i=$("<div></div>").text(r||"NodeBB Task").html(),s=$("<li></li>").addClass(e.options.className).html('<a href="#"'+(e.options.image?` style="background-image: url('`+e.options.image.replace(/&#x2F;/g,"/")+`'); background-size: cover;"`:"")+">"+(e.options.icon?'<i class="fa '+e.options.icon+'"></i> ':"")+'<span aria-label="'+i+'" component="taskbar/title">'+i+"</span></a>").attr({title:i,"data-module":e.module,"data-uuid":e.uuid}).addClass(e.options.state!==void 0?e.options.state:"active");(!e.options.state||e.options.state==="active")&&c(),n.tasklist.append(s),b(),e.element=s,s.data(e),u.fire("action:taskbar.pushed",e),t(s)})}const g=function(e,t,r){switch(t){case"title":e.find('[component="taskbar/title"]').text(r);break;case"icon":e.find("i").attr("class","fa fa-"+r);break;case"image":e.find("a").css("background-image",r?'url("'+r.replace(/&#x2F;/g,"/")+'")':"");break;case"background-color":e.find("a").css("background-color",r);break;case"color":e.find("a").css("color",r);break}};return n.update=function(e,t,r){if(l)return;const i=n.tasklist.find('[data-module="'+e+'"][data-uuid="'+t+'"]');if(!i.length)return;const s=i.data();Object.keys(r).forEach(function(m){s[m]=r[m],g(i,m,r[m])}),i.data(s)},n}.apply(E,h),v!==void 0&&(x.exports=v)},62023:(x,E,a)=>{"use strict";var h,v;h=[a(74344),a(63281),a(7927),a(50431),a(59006),a(32230),a(62526)],v=function(p,u,n,l,b,c){const f={};return f.get=g=>p.get(`/topics/${g}/thumbs`,{}),f.getByPid=g=>p.get(`/posts/${g}`,{}).then(e=>f.get(e.tid)),f.delete=(g,e)=>p.del(`/topics/${g}/thumbs`,{path:e}),f.deleteAll=g=>{f.get(g).then(e=>{Promise.all(e.map(t=>f.delete(g,t.url)))})},f.upload=g=>new Promise(e=>{l.show({title:"[[topic:composer.thumb_title]]",method:"put",route:config.relative_path+`/api/v3/topics/${g}/thumbs`},function(t){e(t)})}),f.modal={},f.modal.open=function(g){const{id:e,pid:t}=g;let{modal:r}=g,i;return new Promise(s=>{Promise.all([f.get(e),t?f.getByPid(t):[]]).then(m=>new Promise(w=>{const A=m.reduce((R,S)=>R.concat(S));i=A.length,w(A)})).then(m=>b.render("modals/topic-thumbs",{thumbs:m})).then(m=>{r?c.translate(m,function(w){r.find(".bootbox-body").html(w),f.modal.handleSort({modal:r,numThumbs:i})}):(r=u.dialog({title:"[[modules:thumbs.modal.title]]",message:m,onEscape:!0,backdrop:!0,buttons:{add:{label:'<i class="fa fa-plus"></i> [[modules:thumbs.modal.add]]',className:"btn-success",callback:()=>(f.upload(e).then(()=>{f.modal.open({...g,modal:r}),Promise.all([a.e(61006),a.e(42265),a.e(49915),a.e(8311)]).then(function(){var w=[a(44541)];(A=>{A.updateThumbCount(e,$(`[component="composer"][data-uuid="${e}"]`)),s()}).apply(null,w)}).catch(a.oe)}),!1)},close:{label:"[[global:close]]",className:"btn-primary"}}}),f.modal.handleDelete({...g,modal:r}),f.modal.handleSort({modal:r,numThumbs:i}))})})},f.modal.handleDelete=g=>{g.modal.get(0).addEventListener("click",t=>{t.target.closest('button[data-action="remove"]')&&u.confirm("[[modules:thumbs.modal.confirm-remove]]",r=>{if(!r)return;const i=t.target.closest("[data-id]").getAttribute("data-id"),s=t.target.closest("[data-path]").getAttribute("data-path");p.del(`/topics/${i}/thumbs`,{path:s}).then(()=>{f.modal.open(g)}).catch(n.error)})})},f.modal.handleSort=({modal:g,numThumbs:e})=>{if(e>1){const t=g.find(".topic-thumbs-modal");t.sortable({items:"[data-id]"}),t.on("sortupdate",f.modal.handleSortChange)}},f.modal.handleSortChange=(g,e)=>{const t=e.item.get(0).parentNode.querySelectorAll("[data-id]");Array.from(t).forEach((r,i)=>{const s=r.getAttribute("data-id");let m=r.getAttribute("data-path");m=m.replace(new RegExp(`^${config.upload_url}`),""),p.put(`/topics/${s}/thumbs/order`,{path:m,order:i}).catch(n.error)})},f}.apply(E,h),v!==void 0&&(x.exports=v)},50431:(x,E,a)=>{"use strict";var h,v;h=[a(86569)],v=function(){const p={};p.show=function(c,f){const g=c.hasOwnProperty("fileSize")&&c.fileSize!==void 0?parseInt(c.fileSize,10):!1;app.parseAndTranslate("modals/upload-file",{showHelp:c.hasOwnProperty("showHelp")&&c.showHelp!==void 0?c.showHelp:!0,fileSize:g,title:c.title||"[[global:upload_file]]",description:c.description||"",button:c.button||"[[global:upload]]",accept:c.accept?c.accept.replace(/,/g,"&#44; "):""},function(e){e.modal("show"),e.on("hidden.bs.modal",function(){e.remove()});const t=e.find("#uploadForm");t.attr("action",c.route),t.find("#params").val(JSON.stringify(c.params)),e.find("#fileUploadSubmitBtn").on("click",function(){$(this).addClass("disabled"),t.submit()}),t.submit(function(){return u(e,g,f),!1})})},p.hideAlerts=function(c){$(c).find("#alert-status, #alert-success, #alert-error, #upload-progress-box").addClass("hide")};function u(c,f,g){n(c,"status","[[uploads:uploading-file]]"),c.find("#upload-progress-bar").css("width","0%"),c.find("#upload-progress-box").show().removeClass("hide");const e=c.find("#fileInput");if(!e.val())return n(c,"error","[[uploads:select-file-to-upload]]");if(!b(e[0],f))return n(c,"error","[[error:file-too-big, "+f+"]]");p.ajaxSubmit(c,g)}function n(c,f,g){p.hideAlerts(c),f==="error"&&c.find("#fileUploadSubmitBtn").removeClass("disabled"),g=g.replace(/&amp;#44/g,"&#44"),c.find("#alert-"+f).translateText(g).removeClass("hide")}p.ajaxSubmit=function(c,f){c.find("#uploadForm").ajaxSubmit({headers:{"x-csrf-token":config.csrf_token},error:function(e){e=l(e),n(c,"error",e.responseJSON?.status?.message||e.responseJSON?.error||`[[error:upload-error-fallback, ${e.status} ${e.statusText}]]`)},uploadProgress:function(e,t,r,i){c.find("#upload-progress-bar").css("width",i+"%")},success:function(e){let t=l(e);e.hasOwnProperty("response")&&e.hasOwnProperty("status")&&e.status.code==="ok"&&(t=e.response.images),f(t[0].url),n(c,"success","[[uploads:upload-success]]"),setTimeout(function(){p.hideAlerts(c),c.modal("hide")},750)}})};function l(c){if(typeof c=="string")try{return JSON.parse(c)}catch{return{error:"[[error:parse-error]]"}}return c}function b(c,f){return window.FileReader&&f?c.files[0].size<=f*1e3:!0}return p}.apply(E,h),v!==void 0&&(x.exports=v)},66485:(x,E,a)=>{"use strict";var h,v;h=[a(74344),a(7927)],v=function(p,u){const n={};n.init=function(e,t){const r=e.find(".draft-icon"),i=e.attr("data-uuid");function s(){$(`[component="composer"][data-uuid="${i}"]`).length&&(t.save_id||(t.save_id=utils.generateSaveId(app.user.uid)),n.addToDraftList("available",t.save_id),n.addToDraftList("open",t.save_id),c(e,r,t))}e.on("keyup","textarea, input.handle, input.title",utils.debounce(s,1e3)),e.on("click",'input[type="checkbox"]',utils.debounce(s,1e3)),e.on("click",'[component="category/list"] [data-cid]',utils.debounce(s,1e3)),e.on("itemAdded",".tags",utils.debounce(s,1e3)),e.on("thumb.uploaded",s),r.on("animationend",function(){$(this).toggleClass("active",!1)}),$(window).on("unload",function(){const m=n.getList("open");m.length&&m.forEach(w=>n.removeFromDraftList("open",w))}),n.migrateGuest(),n.migrateThumbs(...arguments)};function b(e){return parseInt(e,10)>0?localStorage:sessionStorage}n.get=function(e){if(!e)return null;const t=e.split(":")[1],r=b(t);try{const i=r.getItem(e),s=JSON.parse(i)||null;if(!s)throw new Error(`can't parse draft json for ${e}`);return s.save_id=e,s.timestamp&&(s.timestampISO=utils.toISOString(s.timestamp)),$(window).trigger("action:composer.drafts.get",{save_id:e,draft:s,storage:r}),s}catch{return console.warn(`[composer/drafts] Could not get draft ${e}, removing`),n.removeFromDraftList("available"),n.removeFromDraftList("open"),null}};function c(e,t,r){if(g(app.user.uid?"localStorage":"sessionStorage")&&r&&r.save_id&&e.length){const i=e.find("input.title"),s=i&&i.length&&i.val(),m=e.find("textarea").val(),w=b(app.user.uid);if(m.length||s&&s.length){const A={save_id:r.save_id,action:r.action,text:m,uuid:e.attr("data-uuid"),timestamp:Date.now()};if(r.action==="topics.post"){const R=e.find("input.tags").val();A.tags=R,A.title=s,A.cid=r.cid}else r.action==="posts.reply"?(A.title=r.title,A.tid=r.tid,A.toPid=r.toPid):r.action==="posts.edit"&&(A.pid=r.pid,A.title=s||r.title);app.user.uid||(A.handle=e.find("input.handle").val()),w.setItem(r.save_id,JSON.stringify(A)),$(window).trigger("action:composer.drafts.save",{storage:w,postData:r,postContainer:e}),t.toggleClass("active",!0)}else n.removeDraft(r.save_id)}}n.removeDraft=function(e){if(!e)return;n.removeFromDraftList("available",e),n.removeFromDraftList("open",e);const t=e.split(":")[1],r=b(t);r.removeItem(e),$(window).trigger("action:composer.drafts.remove",{storage:r,save_id:e})},n.getList=function(e){try{const t=localStorage.getItem(`drafts:${e}`);return JSON.parse(t)||[]}catch{return console.warn("[composer/drafts] Could not read list of available drafts"),[]}},n.addToDraftList=function(e,t){if(!g(app.user.uid?"localStorage":"sessionStorage")||!t)return;const r=n.getList(e);r.includes(t)||(r.push(t),localStorage.setItem("drafts:"+e,JSON.stringify(r)))},n.removeFromDraftList=function(e,t){if(!g(app.user.uid?"localStorage":"sessionStorage")||!t)return;const r=n.getList(e);r.includes(t)&&(r.splice(r.indexOf(t),1),localStorage.setItem("drafts:"+e,JSON.stringify(r)))},n.migrateGuest=function(){if(g("localStorage")&&app.user.uid){const e=/^composer:\d+:\d$/,t=Object.keys(sessionStorage).filter(function(s){return e.test(s)}),r=new Set([]),i=t.map(function(s){const m=s.split(":");return m[1]=app.user.uid,r.add(m.join(":")),m.join(":")});return t.forEach(function(s,m){localStorage.setItem(i[m],sessionStorage.getItem(s)),sessionStorage.removeItem(s)}),r.forEach(function(s){n.addToDraftList("available",s)}),r}},n.migrateThumbs=function(e,t){if(!app.uid)return;const r=e.attr("data-uuid"),i=n.get(t.save_id);i&&i.uuid&&p.put(`/topics/${i.uuid}/thumbs`,{tid:r}).then(()=>{Promise.all([a.e(66177),a.e(62526),a.e(61006),a.e(42265),a.e(49915),a.e(59330)]).then(function(){var s=[a(44541)];(function(m){m.updateThumbCount(r,e)}).apply(null,s)}).catch(a.oe)})},n.listAvailable=function(){return n.getList("available").map(n.get)},n.getAvailableCount=function(){return n.listAvailable().length},n.open=function(e){if(!e)return;const t=n.get(e);f(e,t)},n.loadOpen=function(){if(ajaxify.data.template.login||ajaxify.data.template.register||config.hasOwnProperty("openDraftsOnPageLoad")&&!config.openDraftsOnPageLoad)return;const e=n.getList("available"),t=n.getList("open");e.length&&e.forEach(function(r){if(!r||t.includes(r))return;const i=n.get(r);if(!i||!i.text&&!i.title){n.removeFromDraftList("available",r),n.removeFromDraftList("open",r);return}f(r,i)})};function f(e,t){const i=e.split(":")[1];parseInt(app.user.uid,10)===parseInt(i,10)&&Promise.all([a.e(66177),a.e(62526),a.e(61006),a.e(42265),a.e(49915),a.e(59330)]).then(function(){var s=[a(44541)];(function(m){t.action==="topics.post"?m.newTopic({save_id:t.save_id,cid:t.cid,handle:app.user&&app.user.uid?void 0:utils.escapeHTML(t.handle),title:utils.escapeHTML(t.title),body:t.text,tags:String(t.tags||"").split(",")}):t.action==="posts.reply"?p.get("/topics/"+t.tid,{},function(w,A){if(w)return u.error(w);m.newReply({save_id:t.save_id,tid:t.tid,toPid:t.toPid,title:A.title,body:t.text})}):t.action==="posts.edit"&&m.editPost({save_id:t.save_id,pid:t.pid,title:t.title?utils.escapeHTML(t.title):void 0,body:t.text})}).apply(null,s)}).catch(a.oe)}function g(e){var t;try{t=window[e];var r="__storage_test__";return t.setItem(r,r),t.removeItem(r),!0}catch(i){return i instanceof DOMException&&(i.code===22||i.code===1014||i.name==="QuotaExceededError"||i.name==="NS_ERROR_DOM_QUOTA_REACHED")&&t&&t.length!==0}}return n}.apply(E,h),v!==void 0&&(x.exports=v)},35729:(x,E,a)=>{"use strict";var h,v;h=[a(83713),a(38259),a(62023),a(10577)],v=function(p,u,n,l){var b={},c={picture:function(){var e=this;e.find("#files").click()},upload:function(){var e=this;e.find("#files").click()},thumbs:function(){b.exitFullscreen();var e=this;Promise.all([a.e(61006),a.e(42265),a.e(49915),a.e(92497)]).then(function(){var t=[a(44541)];(function(r){const i=e.get(0).getAttribute("data-uuid"),s=r.posts[i];(s.action==="topics.post"||s.action==="posts.edit"&&s.isMain)&&n.modal.open({id:i,pid:s.pid}).then(()=>{e.trigger("thumb.uploaded"),r.updateThumbCount(i,e)})}).apply(null,t)}).catch(a.oe)},tags:function(){var e=this;e.find(".tags-container").toggleClass("hidden")},zen:function(){var e=this;$(window).one("resize",function(){function t(){l.isFullscreen||(app.toggleNavbar(!0),$("html").removeClass("zen-mode"),u.reposition(e),$(window).off("resize",t))}l.isFullscreen&&(app.toggleNavbar(!1),$("html").addClass("zen-mode"),e.find(".write").focus(),$(window).on("resize",t),$(window).one("action:composer.topics.post action:composer.posts.reply action:composer.posts.edit action:composer.discard",l.exit))}),l.toggle(e.get(0)),$(window).trigger("action:composer.fullscreen",{postContainer:e})}},f=[];b.exitFullscreen=function(){l.isEnabled&&l.isFullscreen&&l.exit()},b.addComposerButtons=function(){const e=$(".formatting-bar .formatting-group #fileForm");f.forEach(t=>{let r="";Array.isArray(t.dropdownItems)&&t.dropdownItems.length?r=g(t):r=`
					<li data-format="${t.name}" title="${t.title||""}" href="#" class="btn btn-sm btn-link text-reset position-relative" tabindex="-1">
						<i class="${t.iconClass}"></i>
					</li>
				`,e.before(r)})};function g(e){const t=e.dropdownItems.map(function(r){let i="";return r.badge&&(i='<span class="px-1 position-absolute top-0 start-100 translate-middle-x badge rounded text-bg-info"></span>'),`
				<li data-format="${r.name}">
					<a href="#" class="dropdown-item rounded-1 position-relative">
						<i class="${r.iconClass} text-secondary"></i> ${r.text}
						${i}
					</a>
				</li>
			`});return`
			<li class="dropdown bottom-sheet" tab-index="-1">
				<button class="btn btn-sm btn-link text-reset" data-bs-toggle="dropdown" title="${e.title}">
					<i class="${e.iconClass}"></i>
				</button>
				<ul class="dropdown-menu p-1">
				${t}
				</ul>
			</li>
		`}return b.addButton=function(e,t,r,i){i=i||e.replace("fa fa-",""),c[i]=t,f.push({name:i,iconClass:e,title:r})},b.addDropdown=function(e){f.push({iconClass:e.iconClass,title:e.title,dropdownItems:e.dropdownItems}),e.dropdownItems.forEach(t=>{t.name&&t.onClick&&(c[t.name]=t.onClick)})},b.getDispatchTable=function(){return c},b.addButtonDispatch=function(e,t){c[e]=t},b.addHandler=function(e){e.on("click",".formatting-bar li[data-format]",function(t){var r=$(this).attr("data-format"),i=$(this).parents('[component="composer"]').find("textarea")[0];c.hasOwnProperty(r)&&(c[r].call(e,i,i.selectionStart,i.selectionEnd,t),p.render(e))})},b}.apply(E,h),v!==void 0&&(x.exports=v)},51077:(x,E,a)=>{"use strict";var h,v;h=[a(85233)],v=function(p){var u={};return u.render=function(n,l){if(l=l||function(){},!n.find(".preview-container").is(":visible"))return l();var b=n.find("textarea");socket.emit("plugins.composer.renderPreview",b.val(),function(c,f){c||(f=$("<div>"+f+"</div>"),f.find("img:not(.not-responsive)").addClass("img-fluid"),n.find(".preview").html(f),p.fire("action:composer.preview",{postContainer:n,preview:f}),l())})},u.matchScroll=function(n){if(n.find(".preview-container").is(":visible")){var l=n.find("textarea"),b=n.find(".preview");if(l.length&&b.length){var c=l[0].scrollHeight-l.height();if(c===0)return;var f=l.scrollTop()/c;b.scrollTop(Math.max(b[0].scrollHeight-b.height(),0)*f)}}},u.handleToggler=function(n){const l=n.get(0);u.env=utils.findBootstrapEnvironment();const b=["xs","sm"].includes(u.env),c=l.querySelector('.formatting-bar [data-action="preview"]'),f=c.querySelector(".show-text"),g=c.querySelector(".hide-text"),e=localStorage.getItem("composer:previewToggled"),t=config["composer-default"].hidePreviewOnOpen==="on";let r=!b&&(e===null&&!t||e);const i=l.querySelector(".preview-container"),s=l.querySelector(".write-container");if(!c)return;function m(w){b?(i.classList.toggle("hide",!1),s.classList.toggle("maximized",!1),i.classList.toggle("d-none",!w),i.classList.toggle("d-flex",w),i.classList.toggle("w-100",w),s.classList.toggle("d-flex",!w),s.classList.toggle("d-none",w),s.classList.toggle("w-100",!w)):(i.classList.toggle("hide",!w),s.classList.toggle("w-50",w),s.classList.toggle("w-100",!w),localStorage.setItem("composer:previewToggled",w)),f.classList.toggle("hide",w),g.classList.toggle("hide",!w),w&&u.render(n),u.matchScroll(n)}u.toggle=m,c.addEventListener("click",w=>{w.button===0&&(r=!r,m(r))}),m(r)},u}.apply(E,h),v!==void 0&&(x.exports=v)},65616:(x,E,a)=>{"use strict";var h,v;h=[a(27145)],v=function(p){var u={},n=0,l=.3,b=.05,c=768,f=$("body"),g=$(window),e=$('[component="navbar"]');const t=document.getElementById("content");var r=e[0];function i(){return localStorage.getItem("composer:resizeRatio")||.5}function s(S){localStorage.setItem("composer:resizeRatio",Math.min(S,1))}function m(){var S;r?S=r.getBoundingClientRect():S={bottom:0};var I=Math.max(S.bottom,0),D={top:0,left:0,right:window.innerWidth,bottom:window.innerHeight};return D.width=D.right,D.height=D.bottom,D.boundedTop=I,D.boundedHeight=D.bottom-I,D}function w(S,I){var D=m(),k=S[0],N=window.getComputedStyle(k),H=parseInt(N.getPropertyValue("min-height"),10),M=Math.max(H/window.innerHeight,l);if(D.width>=c){const O=(D.height-D.boundedHeight)/D.height;I=Math.min(Math.max(I,M+O),1);var T=I*D.boundedHeight/D.height;k.style.top=((1-T)*100).toString()+"%";var L=k.getBoundingClientRect();t.style.paddingBottom=(L.bottom-L.top).toString()+"px"}else k.style.top=0,t.style.paddingBottom=0;S.ratio=I,p.updateActive(S.attr("data-uuid"))}var A=w,R=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame;return R&&(A=function(S,I){R(function(){w(S,I),setTimeout(function(){g.trigger("action:composer.resize"),S.trigger("action:composer.resize")},0)})}),u.reposition=function(S){var I=i();I>=1-b&&(I=1,S.addClass("maximized")),A(S,I)},u.maximize=function(S,I){I?A(S,1):u.reposition(S)},u.handleResize=function(S){var I=0,D=0,k=0,N=S.find(".resizer"),H=N[0];function M(P){var o=H.getBoundingClientRect(),d=(o.top+o.bottom)/2;I=(d-P.clientY)/2,D=P.clientY,g.on("mousemove",T),g.on("mouseup",L),f.on("touchmove",O)}function T(P){var o=P.clientY-I,d=m(),y=(d.height-o)/d.boundedHeight;A(S,y)}function L(P){P.preventDefault(),k=P.clientY,S.find("textarea").focus(),g.off("mousemove",T),g.off("mouseup",L),f.off("touchmove",O);var o=k-I,d=m(),y=(d.height-o)/d.boundedHeight;k-D===0&&S.hasClass("maximized")?(S.removeClass("maximized"),y=!n||n>=1-b?.5:n,A(S,y)):k-D===0||y>=1-b?(A(S,1),S.addClass("maximized"),n=y):S.removeClass("maximized"),s(y)}function O(P){P.preventDefault(),T(P.touches[0])}N.on("mousedown",function(P){P.button===0&&(P.preventDefault(),M(P))}).on("touchstart",function(P){P.preventDefault(),M(P.touches[0])}).on("touchend",L)},u}.apply(E,h),v!==void 0&&(x.exports=v)},10577:x=>{/*!
* screenfull
* v5.2.0 - 2021-11-03
* (c) Sindre Sorhus; MIT License
*/(function(){"use strict";var E=typeof window<"u"&&typeof window.document<"u"?window.document:{},a=x.exports,h=function(){for(var u,n=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],l=0,b=n.length,c={};l<b;l++)if(u=n[l],u&&u[1]in E){for(l=0;l<u.length;l++)c[n[0][l]]=u[l];return c}return!1}(),v={change:h.fullscreenchange,error:h.fullscreenerror},p={request:function(u,n){return new Promise(function(l,b){var c=function(){this.off("change",c),l()}.bind(this);this.on("change",c),u=u||E.documentElement;var f=u[h.requestFullscreen](n);f instanceof Promise&&f.then(c).catch(b)}.bind(this))},exit:function(){return new Promise(function(u,n){if(!this.isFullscreen){u();return}var l=function(){this.off("change",l),u()}.bind(this);this.on("change",l);var b=E[h.exitFullscreen]();b instanceof Promise&&b.then(l).catch(n)}.bind(this))},toggle:function(u,n){return this.isFullscreen?this.exit():this.request(u,n)},onchange:function(u){this.on("change",u)},onerror:function(u){this.on("error",u)},on:function(u,n){var l=v[u];l&&E.addEventListener(l,n,!1)},off:function(u,n){var l=v[u];l&&E.removeEventListener(l,n,!1)},raw:h};if(!h){a?x.exports={isEnabled:!1}:window.screenfull={isEnabled:!1};return}Object.defineProperties(p,{isFullscreen:{get:function(){return!!E[h.fullscreenElement]}},element:{enumerable:!0,get:function(){return E[h.fullscreenElement]}},isEnabled:{enumerable:!0,get:function(){return!!E[h.fullscreenEnabled]}}}),a?x.exports=p:window.screenfull=p})()}}]);
