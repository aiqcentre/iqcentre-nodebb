(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[588,70565,83014,99617,62735,10882,43034,79191,3564,74344],{74344:(x,w,c)=>{"use strict";c.r(w),c.d(w,{del:()=>s,get:()=>o,head:()=>a,patch:()=>e,post:()=>d,put:()=>n});var p=c(85233),E=c.n(p),v=c(63281),u=c.n(v);const i=config.relative_path+"/api/v3";function r(t,l){if(t.url=t.url.startsWith("/api")?config.relative_path+t.url:i+t.url,typeof l=="function"){m(t,l);return}return new Promise((f,h)=>{m(t,function(F,S){if(F)return F.message==="A valid login session was not found. Please log in and try again."?(0,v.confirm)("[[error:api.reauth-required]]",g=>{g&&ajaxify.go("login")}):h(F);f(S)})})}async function m(t,l){const{url:f}=t;delete t.url,t.data&&!(t.data instanceof FormData)&&(t.data=JSON.stringify(t.data||{}),t.headers["content-type"]="application/json; charset=utf-8"),{options:t}=await(0,p.fire)("filter:api.options",{options:t}),t.data&&(t.body=t.data,delete t.data);const h=await fetch(f,t),{headers:F}=h,S=F.get("content-type"),g=S&&S.startsWith("application/json");let b;if(g?b=await h.json():b=await h.text(),!h.ok)return l(new Error(g?b.status.message:b));l(null,g&&b.hasOwnProperty("status")&&b.hasOwnProperty("response")?b.response:b)}function o(t,l,f){return r({url:t+(l&&Object.keys(l).length?"?"+$.param(l):"")},f)}function a(t,l,f){return r({url:t+(l&&Object.keys(l).length?"?"+$.param(l):""),method:"head"},f)}function d(t,l,f){return r({url:t,method:"post",data:l,headers:{"x-csrf-token":config.csrf_token}},f)}function e(t,l,f){return r({url:t,method:"patch",data:l,headers:{"x-csrf-token":config.csrf_token}},f)}function n(t,l,f){return r({url:t,method:"put",data:l,headers:{"x-csrf-token":config.csrf_token}},f)}function s(t,l,f){return r({url:t,method:"delete",data:l,headers:{"x-csrf-token":config.csrf_token}},f)}},45482:(x,w,c)=>{x.exports=c(35729)},83713:(x,w,c)=>{x.exports=c(51077)},38259:(x,w,c)=>{x.exports=c(65616)},27145:(x,w,c)=>{"use strict";x=c.nmd(x);var p,E;p=[c(32230),c(85233)],E=function(v,u){const i={};let r=!1;i.init=function(){if(i.taskbar=$('[component="taskbar"]'),i.tasklist=i.taskbar.find("ul"),!i.taskbar.length||!i.tasklist.length){r=!0;return}i.taskbar.on("click","li",async function(){const e=$(this),n=e.attr("data-module"),s=e.attr("data-uuid"),t=await app.require(n);return e.hasClass("active")?t.minimize(s):(o(),t.load(s),i.toggleNew(s,!1),i.tasklist.removeClass("active"),e.addClass("active")),!1}),$(window).on("action:app.loggedOut",function(){i.closeAll()})},i.close=async function(e,n){if(r)return;if(i.tasklist.find('[data-module="'+x+'"][data-uuid="'+n+'"]').length){const t=await app.require(e);t&&typeof t.close=="function"&&t.close(n)}},i.closeAll=function(e){if(r)return;let n="[data-uuid]";e&&(n='[data-module="'+e+'"]'+n),i.tasklist.find(n).each(function(s,t){i.close(e||t.getAttribute("data-module"),t.getAttribute("data-uuid"))})},i.discard=function(e,n){if(r)return;i.tasklist.find('[data-module="'+e+'"][data-uuid="'+n+'"]').remove(),m()},i.push=function(e,n,s,t){if(t=t||function(){},r)return t();const l=i.tasklist.find('li[data-uuid="'+n+'"]'),f={module:e,uuid:n,options:s,element:l};u.fire("filter:taskbar.push",f),!l.length&&f.module?a(f,t):t(l)},i.get=function(e){return r?[]:$('[data-module="'+e+'"]').map(function(s,t){return $(t).data()})},i.minimize=function(e,n){if(r)return;i.tasklist.find('[data-module="'+e+'"][data-uuid="'+n+'"]').toggleClass("active",!1)},i.toggleNew=function(e,n,s){if(r)return;i.tasklist.find('[data-uuid="'+e+'"]').toggleClass("new",n),s||u.fire("action:taskbar.toggleNew",e)},i.updateActive=function(e){if(r)return;const n=i.tasklist.find("li");n.removeClass("active"),n.filter('[data-uuid="'+e+'"]').addClass("active"),$("[data-uuid]:not([data-module])").toggleClass("modal-unfocused",!0),$('[data-uuid="'+e+'"]:not([data-module])').toggleClass("modal-unfocused",!1)},i.isActive=function(e){return r?!1:i.tasklist.find('li[data-uuid="'+e+'"]').hasClass("active")};function m(){if(r)return;i.tasklist.find("li").length>0?i.taskbar.attr("data-active","1"):i.taskbar.removeAttr("data-active")}function o(){r||i.tasklist.find(".active").removeClass("active")}function a(e,n){if(r)return n();v.translate(e.options.title,function(s){const t=$("<div></div>").text(s||"NodeBB Task").html(),l=$("<li></li>").addClass(e.options.className).html('<a href="#"'+(e.options.image?` style="background-image: url('`+e.options.image.replace(/&#x2F;/g,"/")+`'); background-size: cover;"`:"")+">"+(e.options.icon?'<i class="fa '+e.options.icon+'"></i> ':"")+'<span aria-label="'+t+'" component="taskbar/title">'+t+"</span></a>").attr({title:t,"data-module":e.module,"data-uuid":e.uuid}).addClass(e.options.state!==void 0?e.options.state:"active");(!e.options.state||e.options.state==="active")&&o(),i.tasklist.append(l),m(),e.element=l,l.data(e),u.fire("action:taskbar.pushed",e),n(l)})}const d=function(e,n,s){switch(n){case"title":e.find('[component="taskbar/title"]').text(s);break;case"icon":e.find("i").attr("class","fa fa-"+s);break;case"image":e.find("a").css("background-image",s?'url("'+s.replace(/&#x2F;/g,"/")+'")':"");break;case"background-color":e.find("a").css("background-color",s);break;case"color":e.find("a").css("color",s);break}};return i.update=function(e,n,s){if(r)return;const t=i.tasklist.find('[data-module="'+e+'"][data-uuid="'+n+'"]');if(!t.length)return;const l=t.data();Object.keys(s).forEach(function(f){l[f]=s[f],d(t,f,s[f])}),t.data(l)},i}.apply(w,p),E!==void 0&&(x.exports=E)},62023:(x,w,c)=>{"use strict";var p,E;p=[c(74344),c(63281),c(7927),c(50431),c(59006),c(32230),c(62526)],E=function(v,u,i,r,m,o){const a={};return a.get=d=>v.get(`/topics/${d}/thumbs`,{}),a.getByPid=d=>v.get(`/posts/${d}`,{}).then(e=>a.get(e.tid)),a.delete=(d,e)=>v.del(`/topics/${d}/thumbs`,{path:e}),a.deleteAll=d=>{a.get(d).then(e=>{Promise.all(e.map(n=>a.delete(d,n.url)))})},a.upload=d=>new Promise(e=>{r.show({title:"[[topic:composer.thumb_title]]",method:"put",route:config.relative_path+`/api/v3/topics/${d}/thumbs`},function(n){e(n)})}),a.modal={},a.modal.open=function(d){const{id:e,pid:n}=d;let{modal:s}=d,t;return new Promise(l=>{Promise.all([a.get(e),n?a.getByPid(n):[]]).then(f=>new Promise(h=>{const F=f.reduce((S,g)=>S.concat(g));t=F.length,h(F)})).then(f=>m.render("modals/topic-thumbs",{thumbs:f})).then(f=>{s?o.translate(f,function(h){s.find(".bootbox-body").html(h),a.modal.handleSort({modal:s,numThumbs:t})}):(s=u.dialog({title:"[[modules:thumbs.modal.title]]",message:f,onEscape:!0,backdrop:!0,buttons:{add:{label:'<i class="fa fa-plus"></i> [[modules:thumbs.modal.add]]',className:"btn-success",callback:()=>(a.upload(e).then(()=>{a.modal.open({...d,modal:s}),Promise.all([c.e(61006),c.e(42265),c.e(49915),c.e(8311)]).then(function(){var h=[c(44541)];(F=>{F.updateThumbCount(e,$(`[component="composer"][data-uuid="${e}"]`)),l()}).apply(null,h)}).catch(c.oe)}),!1)},close:{label:"[[global:close]]",className:"btn-primary"}}}),a.modal.handleDelete({...d,modal:s}),a.modal.handleSort({modal:s,numThumbs:t}))})})},a.modal.handleDelete=d=>{d.modal.get(0).addEventListener("click",n=>{n.target.closest('button[data-action="remove"]')&&u.confirm("[[modules:thumbs.modal.confirm-remove]]",s=>{if(!s)return;const t=n.target.closest("[data-id]").getAttribute("data-id"),l=n.target.closest("[data-path]").getAttribute("data-path");v.del(`/topics/${t}/thumbs`,{path:l}).then(()=>{a.modal.open(d)}).catch(i.error)})})},a.modal.handleSort=({modal:d,numThumbs:e})=>{if(e>1){const n=d.find(".topic-thumbs-modal");n.sortable({items:"[data-id]"}),n.on("sortupdate",a.modal.handleSortChange)}},a.modal.handleSortChange=(d,e)=>{const n=e.item.get(0).parentNode.querySelectorAll("[data-id]");Array.from(n).forEach((s,t)=>{const l=s.getAttribute("data-id");let f=s.getAttribute("data-path");f=f.replace(new RegExp(`^${config.upload_url}`),""),v.put(`/topics/${l}/thumbs/order`,{path:f,order:t}).catch(i.error)})},a}.apply(w,p),E!==void 0&&(x.exports=E)},50431:(x,w,c)=>{"use strict";var p,E;p=[c(86569)],E=function(){const v={};v.show=function(o,a){const d=o.hasOwnProperty("fileSize")&&o.fileSize!==void 0?parseInt(o.fileSize,10):!1;app.parseAndTranslate("modals/upload-file",{showHelp:o.hasOwnProperty("showHelp")&&o.showHelp!==void 0?o.showHelp:!0,fileSize:d,title:o.title||"[[global:upload_file]]",description:o.description||"",button:o.button||"[[global:upload]]",accept:o.accept?o.accept.replace(/,/g,"&#44; "):""},function(e){e.modal("show"),e.on("hidden.bs.modal",function(){e.remove()});const n=e.find("#uploadForm");n.attr("action",o.route),n.find("#params").val(JSON.stringify(o.params)),e.find("#fileUploadSubmitBtn").on("click",function(){$(this).addClass("disabled"),n.submit()}),n.submit(function(){return u(e,d,a),!1})})},v.hideAlerts=function(o){$(o).find("#alert-status, #alert-success, #alert-error, #upload-progress-box").addClass("hide")};function u(o,a,d){i(o,"status","[[uploads:uploading-file]]"),o.find("#upload-progress-bar").css("width","0%"),o.find("#upload-progress-box").show().removeClass("hide");const e=o.find("#fileInput");if(!e.val())return i(o,"error","[[uploads:select-file-to-upload]]");if(!m(e[0],a))return i(o,"error","[[error:file-too-big, "+a+"]]");v.ajaxSubmit(o,d)}function i(o,a,d){v.hideAlerts(o),a==="error"&&o.find("#fileUploadSubmitBtn").removeClass("disabled"),d=d.replace(/&amp;#44/g,"&#44"),o.find("#alert-"+a).translateText(d).removeClass("hide")}v.ajaxSubmit=function(o,a){o.find("#uploadForm").ajaxSubmit({headers:{"x-csrf-token":config.csrf_token},error:function(e){e=r(e),i(o,"error",e.responseJSON?.status?.message||e.responseJSON?.error||`[[error:upload-error-fallback, ${e.status} ${e.statusText}]]`)},uploadProgress:function(e,n,s,t){o.find("#upload-progress-bar").css("width",t+"%")},success:function(e){let n=r(e);e.hasOwnProperty("response")&&e.hasOwnProperty("status")&&e.status.code==="ok"&&(n=e.response.images),a(n[0].url),i(o,"success","[[uploads:upload-success]]"),setTimeout(function(){v.hideAlerts(o),o.modal("hide")},750)}})};function r(o){if(typeof o=="string")try{return JSON.parse(o)}catch{return{error:"[[error:parse-error]]"}}return o}function m(o,a){return window.FileReader&&a?o.files[0].size<=a*1e3:!0}return v}.apply(w,p),E!==void 0&&(x.exports=E)},35729:(x,w,c)=>{"use strict";var p,E;p=[c(83713),c(38259),c(62023),c(10577)],E=function(v,u,i,r){var m={},o={picture:function(){var e=this;e.find("#files").click()},upload:function(){var e=this;e.find("#files").click()},thumbs:function(){m.exitFullscreen();var e=this;Promise.all([c.e(61006),c.e(42265),c.e(49915),c.e(92497)]).then(function(){var n=[c(44541)];(function(s){const t=e.get(0).getAttribute("data-uuid"),l=s.posts[t];(l.action==="topics.post"||l.action==="posts.edit"&&l.isMain)&&i.modal.open({id:t,pid:l.pid}).then(()=>{e.trigger("thumb.uploaded"),s.updateThumbCount(t,e)})}).apply(null,n)}).catch(c.oe)},tags:function(){var e=this;e.find(".tags-container").toggleClass("hidden")},zen:function(){var e=this;$(window).one("resize",function(){function n(){r.isFullscreen||(app.toggleNavbar(!0),$("html").removeClass("zen-mode"),u.reposition(e),$(window).off("resize",n))}r.isFullscreen&&(app.toggleNavbar(!1),$("html").addClass("zen-mode"),e.find(".write").focus(),$(window).on("resize",n),$(window).one("action:composer.topics.post action:composer.posts.reply action:composer.posts.edit action:composer.discard",r.exit))}),r.toggle(e.get(0)),$(window).trigger("action:composer.fullscreen",{postContainer:e})}},a=[];m.exitFullscreen=function(){r.isEnabled&&r.isFullscreen&&r.exit()},m.addComposerButtons=function(){const e=$(".formatting-bar .formatting-group #fileForm");a.forEach(n=>{let s="";Array.isArray(n.dropdownItems)&&n.dropdownItems.length?s=d(n):s=`
					<li data-format="${n.name}" title="${n.title||""}" href="#" class="btn btn-sm btn-link text-reset position-relative" tabindex="-1">
						<i class="${n.iconClass}"></i>
					</li>
				`,e.before(s)})};function d(e){const n=e.dropdownItems.map(function(s){let t="";return s.badge&&(t='<span class="px-1 position-absolute top-0 start-100 translate-middle-x badge rounded text-bg-info"></span>'),`
				<li data-format="${s.name}">
					<a href="#" class="dropdown-item rounded-1 position-relative">
						<i class="${s.iconClass} text-secondary"></i> ${s.text}
						${t}
					</a>
				</li>
			`});return`
			<li class="dropdown bottom-sheet" tab-index="-1">
				<button class="btn btn-sm btn-link text-reset" data-bs-toggle="dropdown" title="${e.title}">
					<i class="${e.iconClass}"></i>
				</button>
				<ul class="dropdown-menu p-1">
				${n}
				</ul>
			</li>
		`}return m.addButton=function(e,n,s,t){t=t||e.replace("fa fa-",""),o[t]=n,a.push({name:t,iconClass:e,title:s})},m.addDropdown=function(e){a.push({iconClass:e.iconClass,title:e.title,dropdownItems:e.dropdownItems}),e.dropdownItems.forEach(n=>{n.name&&n.onClick&&(o[n.name]=n.onClick)})},m.getDispatchTable=function(){return o},m.addButtonDispatch=function(e,n){o[e]=n},m.addHandler=function(e){e.on("click",".formatting-bar li[data-format]",function(n){var s=$(this).attr("data-format"),t=$(this).parents('[component="composer"]').find("textarea")[0];o.hasOwnProperty(s)&&(o[s].call(e,t,t.selectionStart,t.selectionEnd,n),v.render(e))})},m}.apply(w,p),E!==void 0&&(x.exports=E)},51077:(x,w,c)=>{"use strict";var p,E;p=[c(85233)],E=function(v){var u={};return u.render=function(i,r){if(r=r||function(){},!i.find(".preview-container").is(":visible"))return r();var m=i.find("textarea");socket.emit("plugins.composer.renderPreview",m.val(),function(o,a){o||(a=$("<div>"+a+"</div>"),a.find("img:not(.not-responsive)").addClass("img-fluid"),i.find(".preview").html(a),v.fire("action:composer.preview",{postContainer:i,preview:a}),r())})},u.matchScroll=function(i){if(i.find(".preview-container").is(":visible")){var r=i.find("textarea"),m=i.find(".preview");if(r.length&&m.length){var o=r[0].scrollHeight-r.height();if(o===0)return;var a=r.scrollTop()/o;m.scrollTop(Math.max(m[0].scrollHeight-m.height(),0)*a)}}},u.handleToggler=function(i){const r=i.get(0);u.env=utils.findBootstrapEnvironment();const m=["xs","sm"].includes(u.env),o=r.querySelector('.formatting-bar [data-action="preview"]'),a=o.querySelector(".show-text"),d=o.querySelector(".hide-text"),e=localStorage.getItem("composer:previewToggled"),n=config["composer-default"].hidePreviewOnOpen==="on";let s=!m&&(e===null&&!n||e);const t=r.querySelector(".preview-container"),l=r.querySelector(".write-container");if(!o)return;function f(h){m?(t.classList.toggle("hide",!1),l.classList.toggle("maximized",!1),t.classList.toggle("d-none",!h),t.classList.toggle("d-flex",h),t.classList.toggle("w-100",h),l.classList.toggle("d-flex",!h),l.classList.toggle("d-none",h),l.classList.toggle("w-100",!h)):(t.classList.toggle("hide",!h),l.classList.toggle("w-50",h),l.classList.toggle("w-100",!h),localStorage.setItem("composer:previewToggled",h)),a.classList.toggle("hide",h),d.classList.toggle("hide",!h),h&&u.render(i),u.matchScroll(i)}u.toggle=f,o.addEventListener("click",h=>{h.button===0&&(s=!s,f(s))}),f(s)},u}.apply(w,p),E!==void 0&&(x.exports=E)},65616:(x,w,c)=>{"use strict";var p,E;p=[c(27145)],E=function(v){var u={},i=0,r=.3,m=.05,o=768,a=$("body"),d=$(window),e=$('[component="navbar"]');const n=document.getElementById("content");var s=e[0];function t(){return localStorage.getItem("composer:resizeRatio")||.5}function l(g){localStorage.setItem("composer:resizeRatio",Math.min(g,1))}function f(){var g;s?g=s.getBoundingClientRect():g={bottom:0};var b=Math.max(g.bottom,0),A={top:0,left:0,right:window.innerWidth,bottom:window.innerHeight};return A.width=A.right,A.height=A.bottom,A.boundedTop=b,A.boundedHeight=A.bottom-b,A}function h(g,b){var A=f(),C=g[0],B=window.getComputedStyle(C),N=parseInt(B.getPropertyValue("min-height"),10),I=Math.max(N/window.innerHeight,r);if(A.width>=o){const T=(A.height-A.boundedHeight)/A.height;b=Math.min(Math.max(b,I+T),1);var D=b*A.boundedHeight/A.height;C.style.top=((1-D)*100).toString()+"%";var R=C.getBoundingClientRect();n.style.paddingBottom=(R.bottom-R.top).toString()+"px"}else C.style.top=0,n.style.paddingBottom=0;g.ratio=b,v.updateActive(g.attr("data-uuid"))}var F=h,S=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame;return S&&(F=function(g,b){S(function(){h(g,b),setTimeout(function(){d.trigger("action:composer.resize"),g.trigger("action:composer.resize")},0)})}),u.reposition=function(g){var b=t();b>=1-m&&(b=1,g.addClass("maximized")),F(g,b)},u.maximize=function(g,b){b?F(g,1):u.reposition(g)},u.handleResize=function(g){var b=0,A=0,C=0,B=g.find(".resizer"),N=B[0];function I(k){var z=N.getBoundingClientRect(),y=(z.top+z.bottom)/2;b=(y-k.clientY)/2,A=k.clientY,d.on("mousemove",D),d.on("mouseup",R),a.on("touchmove",T)}function D(k){var z=k.clientY-b,y=f(),P=(y.height-z)/y.boundedHeight;F(g,P)}function R(k){k.preventDefault(),C=k.clientY,g.find("textarea").focus(),d.off("mousemove",D),d.off("mouseup",R),a.off("touchmove",T);var z=C-b,y=f(),P=(y.height-z)/y.boundedHeight;C-A===0&&g.hasClass("maximized")?(g.removeClass("maximized"),P=!i||i>=1-m?.5:i,F(g,P)):C-A===0||P>=1-m?(F(g,1),g.addClass("maximized"),i=P):g.removeClass("maximized"),l(P)}function T(k){k.preventDefault(),D(k.touches[0])}B.on("mousedown",function(k){k.button===0&&(k.preventDefault(),I(k))}).on("touchstart",function(k){k.preventDefault(),I(k.touches[0])}).on("touchend",R)},u}.apply(w,p),E!==void 0&&(x.exports=E)},10577:x=>{/*!
* screenfull
* v5.2.0 - 2021-11-03
* (c) Sindre Sorhus; MIT License
*/(function(){"use strict";var w=typeof window<"u"&&typeof window.document<"u"?window.document:{},c=x.exports,p=function(){for(var u,i=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],r=0,m=i.length,o={};r<m;r++)if(u=i[r],u&&u[1]in w){for(r=0;r<u.length;r++)o[i[0][r]]=u[r];return o}return!1}(),E={change:p.fullscreenchange,error:p.fullscreenerror},v={request:function(u,i){return new Promise(function(r,m){var o=function(){this.off("change",o),r()}.bind(this);this.on("change",o),u=u||w.documentElement;var a=u[p.requestFullscreen](i);a instanceof Promise&&a.then(o).catch(m)}.bind(this))},exit:function(){return new Promise(function(u,i){if(!this.isFullscreen){u();return}var r=function(){this.off("change",r),u()}.bind(this);this.on("change",r);var m=w[p.exitFullscreen]();m instanceof Promise&&m.then(r).catch(i)}.bind(this))},toggle:function(u,i){return this.isFullscreen?this.exit():this.request(u,i)},onchange:function(u){this.on("change",u)},onerror:function(u){this.on("error",u)},on:function(u,i){var r=E[u];r&&w.addEventListener(r,i,!1)},off:function(u,i){var r=E[u];r&&w.removeEventListener(r,i,!1)},raw:p};if(!p){c?x.exports={isEnabled:!1}:window.screenfull={isEnabled:!1};return}Object.defineProperties(v,{isFullscreen:{get:function(){return!!w[p.fullscreenElement]}},element:{enumerable:!0,get:function(){return w[p.fullscreenElement]}},isEnabled:{enumerable:!0,get:function(){return!!w[p.fullscreenEnabled]}}}),c?x.exports=v:window.screenfull=v})()}}]);
