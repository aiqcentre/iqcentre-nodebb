"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[96673,70565,83014,99617,74344,41803],{74344:(O,E,o)=>{o.r(E),o.d(E,{del:()=>r,get:()=>a,head:()=>f,patch:()=>A,post:()=>d,put:()=>b});var m=o(85233),v=o.n(m),h=o(63281),P=o.n(h);const y=config.relative_path+"/api/v3";function s(e,t){if(e.url=e.url.startsWith("/api")?config.relative_path+e.url:y+e.url,typeof t=="function"){g(e,t);return}return new Promise((n,l)=>{g(e,function(c,u){if(c)return c.message==="A valid login session was not found. Please log in and try again."?(0,h.confirm)("[[error:api.reauth-required]]",p=>{p&&ajaxify.go("login")}):l(c);n(u)})})}async function g(e,t){const{url:n}=e;delete e.url,e.data&&!(e.data instanceof FormData)&&(e.data=JSON.stringify(e.data||{}),e.headers["content-type"]="application/json; charset=utf-8"),{options:e}=await(0,m.fire)("filter:api.options",{options:e}),e.data&&(e.body=e.data,delete e.data);const l=await fetch(n,e),{headers:c}=l,u=c.get("content-type"),p=u&&u.startsWith("application/json");let i;if(p?i=await l.json():i=await l.text(),!l.ok)return t(new Error(p?i.status.message:i));t(null,p&&i.hasOwnProperty("status")&&i.hasOwnProperty("response")?i.response:i)}function a(e,t,n){return s({url:e+(t&&Object.keys(t).length?"?"+$.param(t):"")},n)}function f(e,t,n){return s({url:e+(t&&Object.keys(t).length?"?"+$.param(t):""),method:"head"},n)}function d(e,t,n){return s({url:e,method:"post",data:t,headers:{"x-csrf-token":config.csrf_token}},n)}function A(e,t,n){return s({url:e,method:"patch",data:t,headers:{"x-csrf-token":config.csrf_token}},n)}function b(e,t,n){return s({url:e,method:"put",data:t,headers:{"x-csrf-token":config.csrf_token}},n)}function r(e,t,n){return s({url:e,method:"delete",data:t,headers:{"x-csrf-token":config.csrf_token}},n)}},41803:(O,E,o)=>{var m,v;m=[o(85233),o(7237),o(74344),o(7927)],v=function(h,P,y,s){const g={};let a,f,d;g.showFlagModal=function(r){app.parseAndTranslate("modals/flag",r,function(e){a=e,a.on("hidden.bs.modal",function(){a.remove()}),f=a.find("#flag-post-commit"),d=a.find("#flag-reason-custom"),a.on("click",'input[name="flag-reason"]',function(){$(this).attr("id")==="flag-reason-other"?(d.removeAttr("disabled"),d.val().length||f.attr("disabled",!0)):(d.attr("disabled",!0),f.removeAttr("disabled"))}),f.on("click",function(){const t=$('input[name="flag-reason"]:checked');let n=t.val();t.attr("id")==="flag-reason-other"&&(n=d.val()),A(r.type,r.id,n)}),a.on("click","#flag-reason-other",function(){d.focus()}),a.modal("show"),h.fire("action:flag.showModal",{modalEl:a,type:r.type,id:r.id}),a.find("#flag-reason-custom").on("keyup blur change",b)})},g.resolve=function(r){y.put(`/flags/${r}`,{state:"resolved"}).then(()=>{s.success("[[flags:resolved]]"),h.fire("action:flag.resolved",{flagId:r})}).catch(s.error)};function A(r,e,t){if(!r||!e||!t)return;const n={type:r,id:e,reason:t};y.post("/flags",n,function(l,c){if(l)return s.error(l);if(a.modal("hide"),s.success("[[flags:modal-submit-success]]"),r==="post"){const u=P.get("post","pid",e);u.find('[component="post/flag"]').addClass("hidden").parent().attr("hidden",""),u.find('[component="post/already-flagged"]').removeClass("hidden").parent().attr("hidden",null)}h.fire("action:flag.create",{flagId:c,data:n})})}function b(){a.find("#flag-reason-custom").val()?f.removeAttr("disabled"):f.attr("disabled",!0)}return g}.apply(E,m),v!==void 0&&(O.exports=v)}}]);
