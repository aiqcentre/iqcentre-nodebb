(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[89743,70565,83014,99617,93230,588,62735,10882,28306,43034,79191,3564,74344,92497,8311,59330,76830],{74344:(E,w,l)=>{"use strict";l.r(w),l.d(w,{del:()=>o,get:()=>a,head:()=>c,patch:()=>t,post:()=>f,put:()=>e});var v=l(85233),p=l.n(v),g=l(63281),u=l.n(g);const n=config.relative_path+"/api/v3";function s(i,r){if(i.url=i.url.startsWith("/api")?config.relative_path+i.url:n+i.url,typeof r=="function"){m(i,r);return}return new Promise((d,h)=>{m(i,function(S,F){if(S)return S.message==="A valid login session was not found. Please log in and try again."?(0,g.confirm)("[[error:api.reauth-required]]",b=>{b&&ajaxify.go("login")}):h(S);d(F)})})}async function m(i,r){const{url:d}=i;delete i.url,i.data&&!(i.data instanceof FormData)&&(i.data=JSON.stringify(i.data||{}),i.headers["content-type"]="application/json; charset=utf-8"),{options:i}=await(0,v.fire)("filter:api.options",{options:i}),i.data&&(i.body=i.data,delete i.data);const h=await fetch(d,i),{headers:S}=h,F=S.get("content-type"),b=F&&F.startsWith("application/json");let A;if(b?A=await h.json():A=await h.text(),!h.ok)return r(new Error(b?A.status.message:A));r(null,b&&A.hasOwnProperty("status")&&A.hasOwnProperty("response")?A.response:A)}function a(i,r,d){return s({url:i+(r&&Object.keys(r).length?"?"+$.param(r):"")},d)}function c(i,r,d){return s({url:i+(r&&Object.keys(r).length?"?"+$.param(r):""),method:"head"},d)}function f(i,r,d){return s({url:i,method:"post",data:r,headers:{"x-csrf-token":config.csrf_token}},d)}function t(i,r,d){return s({url:i,method:"patch",data:r,headers:{"x-csrf-token":config.csrf_token}},d)}function e(i,r,d){return s({url:i,method:"put",data:r,headers:{"x-csrf-token":config.csrf_token}},d)}function o(i,r,d){return s({url:i,method:"delete",data:r,headers:{"x-csrf-token":config.csrf_token}},d)}},47913:(E,w,l)=>{E.exports=l(66485)},45482:(E,w,l)=>{E.exports=l(35729)},83713:(E,w,l)=>{E.exports=l(51077)},38259:(E,w,l)=>{E.exports=l(65616)},66603:(E,w,l)=>{"use strict";var v;v=function(){function p(){this._store={},this._keys=[]}p.prototype.isMock=!0,p.prototype.setItem=function(n,s){n=String(n),this._keys.indexOf(n)===-1&&this._keys.push(n),this._store[n]=s},p.prototype.getItem=function(n){return n=String(n),this._keys.indexOf(n)===-1?null:this._store[n]},p.prototype.removeItem=function(n){n=String(n),this._keys=this._keys.filter(function(s){return s!==n}),this._store[n]=null},p.prototype.clear=function(){this._keys=[],this._store={}},p.prototype.key=function(n){return n=parseInt(n,10)||0,this._keys[n]},Object.defineProperty&&Object.defineProperty(p.prototype,"length",{get:function(){return this._keys.length}});let g;const u=Date.now().toString();try{if(g=window.localStorage,g.setItem(u,u),g.getItem(u)!==u)throw Error("localStorage behaved unexpectedly");return g.removeItem(u),g}catch(n){console.warn(n),console.warn("localStorage failed, falling back on sessionStorage");try{if(g=window.sessionStorage,g.setItem(u,u),g.getItem(u)!==u)throw Error("sessionStorage behaved unexpectedly");return g.removeItem(u),g}catch(s){return console.warn(s),console.warn("sessionStorage failed, falling back on memory storage"),new p}}}.call(w,l,w,E),v!==void 0&&(E.exports=v)},27145:(E,w,l)=>{"use strict";E=l.nmd(E);var v,p;v=[l(32230),l(85233)],p=function(g,u){const n={};let s=!1;n.init=function(){if(n.taskbar=$('[component="taskbar"]'),n.tasklist=n.taskbar.find("ul"),!n.taskbar.length||!n.tasklist.length){s=!0;return}n.taskbar.on("click","li",async function(){const t=$(this),e=t.attr("data-module"),o=t.attr("data-uuid"),i=await app.require(e);return t.hasClass("active")?i.minimize(o):(a(),i.load(o),n.toggleNew(o,!1),n.tasklist.removeClass("active"),t.addClass("active")),!1}),$(window).on("action:app.loggedOut",function(){n.closeAll()})},n.close=async function(t,e){if(s)return;if(n.tasklist.find('[data-module="'+E+'"][data-uuid="'+e+'"]').length){const i=await app.require(t);i&&typeof i.close=="function"&&i.close(e)}},n.closeAll=function(t){if(s)return;let e="[data-uuid]";t&&(e='[data-module="'+t+'"]'+e),n.tasklist.find(e).each(function(o,i){n.close(t||i.getAttribute("data-module"),i.getAttribute("data-uuid"))})},n.discard=function(t,e){if(s)return;n.tasklist.find('[data-module="'+t+'"][data-uuid="'+e+'"]').remove(),m()},n.push=function(t,e,o,i){if(i=i||function(){},s)return i();const r=n.tasklist.find('li[data-uuid="'+e+'"]'),d={module:t,uuid:e,options:o,element:r};u.fire("filter:taskbar.push",d),!r.length&&d.module?c(d,i):i(r)},n.get=function(t){return s?[]:$('[data-module="'+t+'"]').map(function(o,i){return $(i).data()})},n.minimize=function(t,e){if(s)return;n.tasklist.find('[data-module="'+t+'"][data-uuid="'+e+'"]').toggleClass("active",!1)},n.toggleNew=function(t,e,o){if(s)return;n.tasklist.find('[data-uuid="'+t+'"]').toggleClass("new",e),o||u.fire("action:taskbar.toggleNew",t)},n.updateActive=function(t){if(s)return;const e=n.tasklist.find("li");e.removeClass("active"),e.filter('[data-uuid="'+t+'"]').addClass("active"),$("[data-uuid]:not([data-module])").toggleClass("modal-unfocused",!0),$('[data-uuid="'+t+'"]:not([data-module])').toggleClass("modal-unfocused",!1)},n.isActive=function(t){return s?!1:n.tasklist.find('li[data-uuid="'+t+'"]').hasClass("active")};function m(){if(s)return;n.tasklist.find("li").length>0?n.taskbar.attr("data-active","1"):n.taskbar.removeAttr("data-active")}function a(){s||n.tasklist.find(".active").removeClass("active")}function c(t,e){if(s)return e();g.translate(t.options.title,function(o){const i=$("<div></div>").text(o||"NodeBB Task").html(),r=$("<li></li>").addClass(t.options.className).html('<a href="#"'+(t.options.image?` style="background-image: url('`+t.options.image.replace(/&#x2F;/g,"/")+`'); background-size: cover;"`:"")+">"+(t.options.icon?'<i class="fa '+t.options.icon+'"></i> ':"")+'<span aria-label="'+i+'" component="taskbar/title">'+i+"</span></a>").attr({title:i,"data-module":t.module,"data-uuid":t.uuid}).addClass(t.options.state!==void 0?t.options.state:"active");(!t.options.state||t.options.state==="active")&&a(),n.tasklist.append(r),m(),t.element=r,r.data(t),u.fire("action:taskbar.pushed",t),e(r)})}const f=function(t,e,o){switch(e){case"title":t.find('[component="taskbar/title"]').text(o);break;case"icon":t.find("i").attr("class","fa fa-"+o);break;case"image":t.find("a").css("background-image",o?'url("'+o.replace(/&#x2F;/g,"/")+'")':"");break;case"background-color":t.find("a").css("background-color",o);break;case"color":t.find("a").css("color",o);break}};return n.update=function(t,e,o){if(s)return;const i=n.tasklist.find('[data-module="'+t+'"][data-uuid="'+e+'"]');if(!i.length)return;const r=i.data();Object.keys(o).forEach(function(d){r[d]=o[d],f(i,d,o[d])}),i.data(r)},n}.apply(w,v),p!==void 0&&(E.exports=p)},62023:(E,w,l)=>{"use strict";var v,p;v=[l(74344),l(63281),l(7927),l(50431),l(59006),l(32230),l(62526)],p=function(g,u,n,s,m,a){const c={};return c.get=f=>g.get(`/topics/${f}/thumbs`,{}),c.getByPid=f=>g.get(`/posts/${f}`,{}).then(t=>c.get(t.tid)),c.delete=(f,t)=>g.del(`/topics/${f}/thumbs`,{path:t}),c.deleteAll=f=>{c.get(f).then(t=>{Promise.all(t.map(e=>c.delete(f,e.url)))})},c.upload=f=>new Promise(t=>{s.show({title:"[[topic:composer.thumb_title]]",method:"put",route:config.relative_path+`/api/v3/topics/${f}/thumbs`},function(e){t(e)})}),c.modal={},c.modal.open=function(f){const{id:t,pid:e}=f;let{modal:o}=f,i;return new Promise(r=>{Promise.all([c.get(t),e?c.getByPid(e):[]]).then(d=>new Promise(h=>{const S=d.reduce((F,b)=>F.concat(b));i=S.length,h(S)})).then(d=>m.render("modals/topic-thumbs",{thumbs:d})).then(d=>{o?a.translate(d,function(h){o.find(".bootbox-body").html(h),c.modal.handleSort({modal:o,numThumbs:i})}):(o=u.dialog({title:"[[modules:thumbs.modal.title]]",message:d,onEscape:!0,backdrop:!0,buttons:{add:{label:'<i class="fa fa-plus"></i> [[modules:thumbs.modal.add]]',className:"btn-success",callback:()=>(c.upload(t).then(()=>{c.modal.open({...f,modal:o}),Promise.all([l.e(61006),l.e(42265),l.e(49915),l.e(8311)]).then(function(){var h=[l(44541)];(S=>{S.updateThumbCount(t,$(`[component="composer"][data-uuid="${t}"]`)),r()}).apply(null,h)}).catch(l.oe)}),!1)},close:{label:"[[global:close]]",className:"btn-primary"}}}),c.modal.handleDelete({...f,modal:o}),c.modal.handleSort({modal:o,numThumbs:i}))})})},c.modal.handleDelete=f=>{f.modal.get(0).addEventListener("click",e=>{e.target.closest('button[data-action="remove"]')&&u.confirm("[[modules:thumbs.modal.confirm-remove]]",o=>{if(!o)return;const i=e.target.closest("[data-id]").getAttribute("data-id"),r=e.target.closest("[data-path]").getAttribute("data-path");g.del(`/topics/${i}/thumbs`,{path:r}).then(()=>{c.modal.open(f)}).catch(n.error)})})},c.modal.handleSort=({modal:f,numThumbs:t})=>{if(t>1){const e=f.find(".topic-thumbs-modal");e.sortable({items:"[data-id]"}),e.on("sortupdate",c.modal.handleSortChange)}},c.modal.handleSortChange=(f,t)=>{const e=t.item.get(0).parentNode.querySelectorAll("[data-id]");Array.from(e).forEach((o,i)=>{const r=o.getAttribute("data-id");let d=o.getAttribute("data-path");d=d.replace(new RegExp(`^${config.upload_url}`),""),g.put(`/topics/${r}/thumbs/order`,{path:d,order:i}).catch(n.error)})},c}.apply(w,v),p!==void 0&&(E.exports=p)},50431:(E,w,l)=>{"use strict";var v,p;v=[l(86569)],p=function(){const g={};g.show=function(a,c){const f=a.hasOwnProperty("fileSize")&&a.fileSize!==void 0?parseInt(a.fileSize,10):!1;app.parseAndTranslate("modals/upload-file",{showHelp:a.hasOwnProperty("showHelp")&&a.showHelp!==void 0?a.showHelp:!0,fileSize:f,title:a.title||"[[global:upload_file]]",description:a.description||"",button:a.button||"[[global:upload]]",accept:a.accept?a.accept.replace(/,/g,"&#44; "):""},function(t){t.modal("show"),t.on("hidden.bs.modal",function(){t.remove()});const e=t.find("#uploadForm");e.attr("action",a.route),e.find("#params").val(JSON.stringify(a.params)),t.find("#fileUploadSubmitBtn").on("click",function(){$(this).addClass("disabled"),e.submit()}),e.submit(function(){return u(t,f,c),!1})})},g.hideAlerts=function(a){$(a).find("#alert-status, #alert-success, #alert-error, #upload-progress-box").addClass("hide")};function u(a,c,f){n(a,"status","[[uploads:uploading-file]]"),a.find("#upload-progress-bar").css("width","0%"),a.find("#upload-progress-box").show().removeClass("hide");const t=a.find("#fileInput");if(!t.val())return n(a,"error","[[uploads:select-file-to-upload]]");if(!m(t[0],c))return n(a,"error","[[error:file-too-big, "+c+"]]");g.ajaxSubmit(a,f)}function n(a,c,f){g.hideAlerts(a),c==="error"&&a.find("#fileUploadSubmitBtn").removeClass("disabled"),f=f.replace(/&amp;#44/g,"&#44"),a.find("#alert-"+c).translateText(f).removeClass("hide")}g.ajaxSubmit=function(a,c){a.find("#uploadForm").ajaxSubmit({headers:{"x-csrf-token":config.csrf_token},error:function(t){t=s(t),n(a,"error",t.responseJSON?.status?.message||t.responseJSON?.error||`[[error:upload-error-fallback, ${t.status} ${t.statusText}]]`)},uploadProgress:function(t,e,o,i){a.find("#upload-progress-bar").css("width",i+"%")},success:function(t){let e=s(t);t.hasOwnProperty("response")&&t.hasOwnProperty("status")&&t.status.code==="ok"&&(e=t.response.images),c(e[0].url),n(a,"success","[[uploads:upload-success]]"),setTimeout(function(){g.hideAlerts(a),a.modal("hide")},750)}})};function s(a){if(typeof a=="string")try{return JSON.parse(a)}catch{return{error:"[[error:parse-error]]"}}return a}function m(a,c){return window.FileReader&&c?a.files[0].size<=c*1e3:!0}return g}.apply(w,v),p!==void 0&&(E.exports=p)},66485:(E,w,l)=>{"use strict";var v,p;v=[l(74344),l(7927)],p=function(g,u){const n={};n.init=function(t,e){const o=t.find(".draft-icon"),i=t.attr("data-uuid");function r(){$(`[component="composer"][data-uuid="${i}"]`).length&&(e.save_id||(e.save_id=utils.generateSaveId(app.user.uid)),n.addToDraftList("available",e.save_id),n.addToDraftList("open",e.save_id),a(t,o,e))}t.on("keyup","textarea, input.handle, input.title",utils.debounce(r,1e3)),t.on("click",'input[type="checkbox"]',utils.debounce(r,1e3)),t.on("click",'[component="category/list"] [data-cid]',utils.debounce(r,1e3)),t.on("itemAdded",".tags",utils.debounce(r,1e3)),t.on("thumb.uploaded",r),o.on("animationend",function(){$(this).toggleClass("active",!1)}),$(window).on("unload",function(){const d=n.getList("open");d.length&&d.forEach(h=>n.removeFromDraftList("open",h))}),n.migrateGuest(),n.migrateThumbs(...arguments)};function m(t){return parseInt(t,10)>0?localStorage:sessionStorage}n.get=function(t){if(!t)return null;const e=t.split(":")[1],o=m(e);try{const i=o.getItem(t),r=JSON.parse(i)||null;if(!r)throw new Error(`can't parse draft json for ${t}`);return r.save_id=t,r.timestamp&&(r.timestampISO=utils.toISOString(r.timestamp)),$(window).trigger("action:composer.drafts.get",{save_id:t,draft:r,storage:o}),r}catch{return console.warn(`[composer/drafts] Could not get draft ${t}, removing`),n.removeFromDraftList("available"),n.removeFromDraftList("open"),null}};function a(t,e,o){if(f(app.user.uid?"localStorage":"sessionStorage")&&o&&o.save_id&&t.length){const i=t.find("input.title"),r=i&&i.length&&i.val(),d=t.find("textarea").val(),h=m(app.user.uid);if(d.length||r&&r.length){const S={save_id:o.save_id,action:o.action,text:d,uuid:t.attr("data-uuid"),timestamp:Date.now()};if(o.action==="topics.post"){const F=t.find("input.tags").val();S.tags=F,S.title=r,S.cid=o.cid}else o.action==="posts.reply"?(S.title=o.title,S.tid=o.tid,S.toPid=o.toPid):o.action==="posts.edit"&&(S.pid=o.pid,S.title=r||o.title);app.user.uid||(S.handle=t.find("input.handle").val()),h.setItem(o.save_id,JSON.stringify(S)),$(window).trigger("action:composer.drafts.save",{storage:h,postData:o,postContainer:t}),e.toggleClass("active",!0)}else n.removeDraft(o.save_id)}}n.removeDraft=function(t){if(!t)return;n.removeFromDraftList("available",t),n.removeFromDraftList("open",t);const e=t.split(":")[1],o=m(e);o.removeItem(t),$(window).trigger("action:composer.drafts.remove",{storage:o,save_id:t})},n.getList=function(t){try{const e=localStorage.getItem(`drafts:${t}`);return JSON.parse(e)||[]}catch{return console.warn("[composer/drafts] Could not read list of available drafts"),[]}},n.addToDraftList=function(t,e){if(!f(app.user.uid?"localStorage":"sessionStorage")||!e)return;const o=n.getList(t);o.includes(e)||(o.push(e),localStorage.setItem("drafts:"+t,JSON.stringify(o)))},n.removeFromDraftList=function(t,e){if(!f(app.user.uid?"localStorage":"sessionStorage")||!e)return;const o=n.getList(t);o.includes(e)&&(o.splice(o.indexOf(e),1),localStorage.setItem("drafts:"+t,JSON.stringify(o)))},n.migrateGuest=function(){if(f("localStorage")&&app.user.uid){const t=/^composer:\d+:\d$/,e=Object.keys(sessionStorage).filter(function(r){return t.test(r)}),o=new Set([]),i=e.map(function(r){const d=r.split(":");return d[1]=app.user.uid,o.add(d.join(":")),d.join(":")});return e.forEach(function(r,d){localStorage.setItem(i[d],sessionStorage.getItem(r)),sessionStorage.removeItem(r)}),o.forEach(function(r){n.addToDraftList("available",r)}),o}},n.migrateThumbs=function(t,e){if(!app.uid)return;const o=t.attr("data-uuid"),i=n.get(e.save_id);i&&i.uuid&&g.put(`/topics/${i.uuid}/thumbs`,{tid:o}).then(()=>{Promise.all([l.e(66177),l.e(62526),l.e(61006),l.e(42265),l.e(49915),l.e(59330)]).then(function(){var r=[l(44541)];(function(d){d.updateThumbCount(o,t)}).apply(null,r)}).catch(l.oe)})},n.listAvailable=function(){return n.getList("available").map(n.get)},n.getAvailableCount=function(){return n.listAvailable().length},n.open=function(t){if(!t)return;const e=n.get(t);c(t,e)},n.loadOpen=function(){if(ajaxify.data.template.login||ajaxify.data.template.register||config.hasOwnProperty("openDraftsOnPageLoad")&&!config.openDraftsOnPageLoad)return;const t=n.getList("available"),e=n.getList("open");t.length&&t.forEach(function(o){if(!o||e.includes(o))return;const i=n.get(o);if(!i||!i.text&&!i.title){n.removeFromDraftList("available",o),n.removeFromDraftList("open",o);return}c(o,i)})};function c(t,e){const i=t.split(":")[1];parseInt(app.user.uid,10)===parseInt(i,10)&&Promise.all([l.e(66177),l.e(62526),l.e(61006),l.e(42265),l.e(49915),l.e(59330)]).then(function(){var r=[l(44541)];(function(d){e.action==="topics.post"?d.newTopic({save_id:e.save_id,cid:e.cid,handle:app.user&&app.user.uid?void 0:utils.escapeHTML(e.handle),title:utils.escapeHTML(e.title),body:e.text,tags:String(e.tags||"").split(",")}):e.action==="posts.reply"?g.get("/topics/"+e.tid,{},function(h,S){if(h)return u.error(h);d.newReply({save_id:e.save_id,tid:e.tid,toPid:e.toPid,title:S.title,body:e.text})}):e.action==="posts.edit"&&d.editPost({save_id:e.save_id,pid:e.pid,title:e.title?utils.escapeHTML(e.title):void 0,body:e.text})}).apply(null,r)}).catch(l.oe)}function f(t){var e;try{e=window[t];var o="__storage_test__";return e.setItem(o,o),e.removeItem(o),!0}catch(i){return i instanceof DOMException&&(i.code===22||i.code===1014||i.name==="QuotaExceededError"||i.name==="NS_ERROR_DOM_QUOTA_REACHED")&&e&&e.length!==0}}return n}.apply(w,v),p!==void 0&&(E.exports=p)},35729:(E,w,l)=>{"use strict";var v,p;v=[l(83713),l(38259),l(62023),l(10577)],p=function(g,u,n,s){var m={},a={picture:function(){var t=this;t.find("#files").click()},upload:function(){var t=this;t.find("#files").click()},thumbs:function(){m.exitFullscreen();var t=this;Promise.all([l.e(61006),l.e(42265),l.e(49915),l.e(92497)]).then(function(){var e=[l(44541)];(function(o){const i=t.get(0).getAttribute("data-uuid"),r=o.posts[i];(r.action==="topics.post"||r.action==="posts.edit"&&r.isMain)&&n.modal.open({id:i,pid:r.pid}).then(()=>{t.trigger("thumb.uploaded"),o.updateThumbCount(i,t)})}).apply(null,e)}).catch(l.oe)},tags:function(){var t=this;t.find(".tags-container").toggleClass("hidden")},zen:function(){var t=this;$(window).one("resize",function(){function e(){s.isFullscreen||(app.toggleNavbar(!0),$("html").removeClass("zen-mode"),u.reposition(t),$(window).off("resize",e))}s.isFullscreen&&(app.toggleNavbar(!1),$("html").addClass("zen-mode"),t.find(".write").focus(),$(window).on("resize",e),$(window).one("action:composer.topics.post action:composer.posts.reply action:composer.posts.edit action:composer.discard",s.exit))}),s.toggle(t.get(0)),$(window).trigger("action:composer.fullscreen",{postContainer:t})}},c=[];m.exitFullscreen=function(){s.isEnabled&&s.isFullscreen&&s.exit()},m.addComposerButtons=function(){const t=$(".formatting-bar .formatting-group #fileForm");c.forEach(e=>{let o="";Array.isArray(e.dropdownItems)&&e.dropdownItems.length?o=f(e):o=`
					<li data-format="${e.name}" title="${e.title||""}" href="#" class="btn btn-sm btn-link text-reset position-relative" tabindex="-1">
						<i class="${e.iconClass}"></i>
					</li>
				`,t.before(o)})};function f(t){const e=t.dropdownItems.map(function(o){let i="";return o.badge&&(i='<span class="px-1 position-absolute top-0 start-100 translate-middle-x badge rounded text-bg-info"></span>'),`
				<li data-format="${o.name}">
					<a href="#" class="dropdown-item rounded-1 position-relative">
						<i class="${o.iconClass} text-secondary"></i> ${o.text}
						${i}
					</a>
				</li>
			`});return`
			<li class="dropdown bottom-sheet" tab-index="-1">
				<button class="btn btn-sm btn-link text-reset" data-bs-toggle="dropdown" title="${t.title}">
					<i class="${t.iconClass}"></i>
				</button>
				<ul class="dropdown-menu p-1">
				${e}
				</ul>
			</li>
		`}return m.addButton=function(t,e,o,i){i=i||t.replace("fa fa-",""),a[i]=e,c.push({name:i,iconClass:t,title:o})},m.addDropdown=function(t){c.push({iconClass:t.iconClass,title:t.title,dropdownItems:t.dropdownItems}),t.dropdownItems.forEach(e=>{e.name&&e.onClick&&(a[e.name]=e.onClick)})},m.getDispatchTable=function(){return a},m.addButtonDispatch=function(t,e){a[t]=e},m.addHandler=function(t){t.on("click",".formatting-bar li[data-format]",function(e){var o=$(this).attr("data-format"),i=$(this).parents('[component="composer"]').find("textarea")[0];a.hasOwnProperty(o)&&(a[o].call(t,i,i.selectionStart,i.selectionEnd,e),g.render(t))})},m}.apply(w,v),p!==void 0&&(E.exports=p)},51077:(E,w,l)=>{"use strict";var v,p;v=[l(85233)],p=function(g){var u={};return u.render=function(n,s){if(s=s||function(){},!n.find(".preview-container").is(":visible"))return s();var m=n.find("textarea");socket.emit("plugins.composer.renderPreview",m.val(),function(a,c){a||(c=$("<div>"+c+"</div>"),c.find("img:not(.not-responsive)").addClass("img-fluid"),n.find(".preview").html(c),g.fire("action:composer.preview",{postContainer:n,preview:c}),s())})},u.matchScroll=function(n){if(n.find(".preview-container").is(":visible")){var s=n.find("textarea"),m=n.find(".preview");if(s.length&&m.length){var a=s[0].scrollHeight-s.height();if(a===0)return;var c=s.scrollTop()/a;m.scrollTop(Math.max(m[0].scrollHeight-m.height(),0)*c)}}},u.handleToggler=function(n){const s=n.get(0);u.env=utils.findBootstrapEnvironment();const m=["xs","sm"].includes(u.env),a=s.querySelector('.formatting-bar [data-action="preview"]'),c=a.querySelector(".show-text"),f=a.querySelector(".hide-text"),t=localStorage.getItem("composer:previewToggled"),e=config["composer-default"].hidePreviewOnOpen==="on";let o=!m&&(t===null&&!e||t);const i=s.querySelector(".preview-container"),r=s.querySelector(".write-container");if(!a)return;function d(h){m?(i.classList.toggle("hide",!1),r.classList.toggle("maximized",!1),i.classList.toggle("d-none",!h),i.classList.toggle("d-flex",h),i.classList.toggle("w-100",h),r.classList.toggle("d-flex",!h),r.classList.toggle("d-none",h),r.classList.toggle("w-100",!h)):(i.classList.toggle("hide",!h),r.classList.toggle("w-50",h),r.classList.toggle("w-100",!h),localStorage.setItem("composer:previewToggled",h)),c.classList.toggle("hide",h),f.classList.toggle("hide",!h),h&&u.render(n),u.matchScroll(n)}u.toggle=d,a.addEventListener("click",h=>{h.button===0&&(o=!o,d(o))}),d(o)},u}.apply(w,v),p!==void 0&&(E.exports=p)},65616:(E,w,l)=>{"use strict";var v,p;v=[l(27145)],p=function(g){var u={},n=0,s=.3,m=.05,a=768,c=$("body"),f=$(window),t=$('[component="navbar"]');const e=document.getElementById("content");var o=t[0];function i(){return localStorage.getItem("composer:resizeRatio")||.5}function r(b){localStorage.setItem("composer:resizeRatio",Math.min(b,1))}function d(){var b;o?b=o.getBoundingClientRect():b={bottom:0};var A=Math.max(b.bottom,0),x={top:0,left:0,right:window.innerWidth,bottom:window.innerHeight};return x.width=x.right,x.height=x.bottom,x.boundedTop=A,x.boundedHeight=x.bottom-A,x}function h(b,A){var x=d(),I=b[0],L=window.getComputedStyle(I),T=parseInt(L.getPropertyValue("min-height"),10),k=Math.max(T/window.innerHeight,s);if(x.width>=a){const z=(x.height-x.boundedHeight)/x.height;A=Math.min(Math.max(A,k+z),1);var O=A*x.boundedHeight/x.height;I.style.top=((1-O)*100).toString()+"%";var D=I.getBoundingClientRect();e.style.paddingBottom=(D.bottom-D.top).toString()+"px"}else I.style.top=0,e.style.paddingBottom=0;b.ratio=A,g.updateActive(b.attr("data-uuid"))}var S=h,F=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame;return F&&(S=function(b,A){F(function(){h(b,A),setTimeout(function(){f.trigger("action:composer.resize"),b.trigger("action:composer.resize")},0)})}),u.reposition=function(b){var A=i();A>=1-m&&(A=1,b.addClass("maximized")),S(b,A)},u.maximize=function(b,A){A?S(b,1):u.reposition(b)},u.handleResize=function(b){var A=0,x=0,I=0,L=b.find(".resizer"),T=L[0];function k(y){var C=T.getBoundingClientRect(),P=(C.top+C.bottom)/2;A=(P-y.clientY)/2,x=y.clientY,f.on("mousemove",O),f.on("mouseup",D),c.on("touchmove",z)}function O(y){var C=y.clientY-A,P=d(),R=(P.height-C)/P.boundedHeight;S(b,R)}function D(y){y.preventDefault(),I=y.clientY,b.find("textarea").focus(),f.off("mousemove",O),f.off("mouseup",D),c.off("touchmove",z);var C=I-A,P=d(),R=(P.height-C)/P.boundedHeight;I-x===0&&b.hasClass("maximized")?(b.removeClass("maximized"),R=!n||n>=1-m?.5:n,S(b,R)):I-x===0||R>=1-m?(S(b,1),b.addClass("maximized"),n=R):b.removeClass("maximized"),r(R)}function z(y){y.preventDefault(),O(y.touches[0])}L.on("mousedown",function(y){y.button===0&&(y.preventDefault(),k(y))}).on("touchstart",function(y){y.preventDefault(),k(y.touches[0])}).on("touchend",D)},u}.apply(w,v),p!==void 0&&(E.exports=p)},10577:E=>{/*!
* screenfull
* v5.2.0 - 2021-11-03
* (c) Sindre Sorhus; MIT License
*/(function(){"use strict";var w=typeof window<"u"&&typeof window.document<"u"?window.document:{},l=E.exports,v=function(){for(var u,n=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],s=0,m=n.length,a={};s<m;s++)if(u=n[s],u&&u[1]in w){for(s=0;s<u.length;s++)a[n[0][s]]=u[s];return a}return!1}(),p={change:v.fullscreenchange,error:v.fullscreenerror},g={request:function(u,n){return new Promise(function(s,m){var a=function(){this.off("change",a),s()}.bind(this);this.on("change",a),u=u||w.documentElement;var c=u[v.requestFullscreen](n);c instanceof Promise&&c.then(a).catch(m)}.bind(this))},exit:function(){return new Promise(function(u,n){if(!this.isFullscreen){u();return}var s=function(){this.off("change",s),u()}.bind(this);this.on("change",s);var m=w[v.exitFullscreen]();m instanceof Promise&&m.then(s).catch(n)}.bind(this))},toggle:function(u,n){return this.isFullscreen?this.exit():this.request(u,n)},onchange:function(u){this.on("change",u)},onerror:function(u){this.on("error",u)},on:function(u,n){var s=p[u];s&&w.addEventListener(s,n,!1)},off:function(u,n){var s=p[u];s&&w.removeEventListener(s,n,!1)},raw:v};if(!v){l?E.exports={isEnabled:!1}:window.screenfull={isEnabled:!1};return}Object.defineProperties(g,{isFullscreen:{get:function(){return!!w[v.fullscreenElement]}},element:{enumerable:!0,get:function(){return w[v.fullscreenElement]}},isEnabled:{enumerable:!0,get:function(){return!!w[v.fullscreenEnabled]}}}),l?E.exports=g:window.screenfull=g})()}}]);
