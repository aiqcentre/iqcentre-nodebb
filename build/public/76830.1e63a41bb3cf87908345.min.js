(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[76830],{66485:(y,S,l)=>{"use strict";var p,b;p=[l(74344),l(7927)],b=function(F,a){const i={};i.init=function(e,t){const n=e.find(".draft-icon"),o=e.attr("data-uuid");function s(){$(`[component="composer"][data-uuid="${o}"]`).length&&(t.save_id||(t.save_id=utils.generateSaveId(app.user.uid)),i.addToDraftList("available",t.save_id),i.addToDraftList("open",t.save_id),d(e,n,t))}e.on("keyup","textarea, input.handle, input.title",utils.debounce(s,1e3)),e.on("click",'input[type="checkbox"]',utils.debounce(s,1e3)),e.on("click",'[component="category/list"] [data-cid]',utils.debounce(s,1e3)),e.on("itemAdded",".tags",utils.debounce(s,1e3)),e.on("thumb.uploaded",s),n.on("animationend",function(){$(this).toggleClass("active",!1)}),$(window).on("unload",function(){const g=i.getList("open");g.length&&g.forEach(f=>i.removeFromDraftList("open",f))}),i.migrateGuest(),i.migrateThumbs(...arguments)};function c(e){return parseInt(e,10)>0?localStorage:sessionStorage}i.get=function(e){if(!e)return null;const t=e.split(":")[1],n=c(t);try{const o=n.getItem(e),s=JSON.parse(o)||null;if(!s)throw new Error(`can't parse draft json for ${e}`);return s.save_id=e,s.timestamp&&(s.timestampISO=utils.toISOString(s.timestamp)),$(window).trigger("action:composer.drafts.get",{save_id:e,draft:s,storage:n}),s}catch{return console.warn(`[composer/drafts] Could not get draft ${e}, removing`),i.removeFromDraftList("available"),i.removeFromDraftList("open"),null}};function d(e,t,n){if(x(app.user.uid?"localStorage":"sessionStorage")&&n&&n.save_id&&e.length){const o=e.find("input.title"),s=o&&o.length&&o.val(),g=e.find("textarea").val(),f=c(app.user.uid);if(g.length||s&&s.length){const v={save_id:n.save_id,action:n.action,text:g,uuid:e.attr("data-uuid"),timestamp:Date.now()};if(n.action==="topics.post"){const P=e.find("input.tags").val();v.tags=P,v.title=s,v.cid=n.cid}else n.action==="posts.reply"?(v.title=n.title,v.tid=n.tid,v.toPid=n.toPid):n.action==="posts.edit"&&(v.pid=n.pid,v.title=s||n.title);app.user.uid||(v.handle=e.find("input.handle").val()),f.setItem(n.save_id,JSON.stringify(v)),$(window).trigger("action:composer.drafts.save",{storage:f,postData:n,postContainer:e}),t.toggleClass("active",!0)}else i.removeDraft(n.save_id)}}i.removeDraft=function(e){if(!e)return;i.removeFromDraftList("available",e),i.removeFromDraftList("open",e);const t=e.split(":")[1],n=c(t);n.removeItem(e),$(window).trigger("action:composer.drafts.remove",{storage:n,save_id:e})},i.getList=function(e){try{const t=localStorage.getItem(`drafts:${e}`);return JSON.parse(t)||[]}catch{return console.warn("[composer/drafts] Could not read list of available drafts"),[]}},i.addToDraftList=function(e,t){if(!x(app.user.uid?"localStorage":"sessionStorage")||!t)return;const n=i.getList(e);n.includes(t)||(n.push(t),localStorage.setItem("drafts:"+e,JSON.stringify(n)))},i.removeFromDraftList=function(e,t){if(!x(app.user.uid?"localStorage":"sessionStorage")||!t)return;const n=i.getList(e);n.includes(t)&&(n.splice(n.indexOf(t),1),localStorage.setItem("drafts:"+e,JSON.stringify(n)))},i.migrateGuest=function(){if(x("localStorage")&&app.user.uid){const e=/^composer:\d+:\d$/,t=Object.keys(sessionStorage).filter(function(s){return e.test(s)}),n=new Set([]),o=t.map(function(s){const g=s.split(":");return g[1]=app.user.uid,n.add(g.join(":")),g.join(":")});return t.forEach(function(s,g){localStorage.setItem(o[g],sessionStorage.getItem(s)),sessionStorage.removeItem(s)}),n.forEach(function(s){i.addToDraftList("available",s)}),n}},i.migrateThumbs=function(e,t){if(!app.uid)return;const n=e.attr("data-uuid"),o=i.get(t.save_id);o&&o.uuid&&F.put(`/topics/${o.uuid}/thumbs`,{tid:n}).then(()=>{Promise.all([l.e(66177),l.e(62526),l.e(61006),l.e(42265),l.e(49915),l.e(59330)]).then(function(){var s=[l(44541)];(function(g){g.updateThumbCount(n,e)}).apply(null,s)}).catch(l.oe)})},i.listAvailable=function(){return i.getList("available").map(i.get)},i.getAvailableCount=function(){return i.listAvailable().length},i.open=function(e){if(!e)return;const t=i.get(e);m(e,t)},i.loadOpen=function(){if(ajaxify.data.template.login||ajaxify.data.template.register||config.hasOwnProperty("openDraftsOnPageLoad")&&!config.openDraftsOnPageLoad)return;const e=i.getList("available"),t=i.getList("open");e.length&&e.forEach(function(n){if(!n||t.includes(n))return;const o=i.get(n);if(!o||!o.text&&!o.title){i.removeFromDraftList("available",n),i.removeFromDraftList("open",n);return}m(n,o)})};function m(e,t){const o=e.split(":")[1];parseInt(app.user.uid,10)===parseInt(o,10)&&Promise.all([l.e(66177),l.e(62526),l.e(61006),l.e(42265),l.e(49915),l.e(59330)]).then(function(){var s=[l(44541)];(function(g){t.action==="topics.post"?g.newTopic({save_id:t.save_id,cid:t.cid,handle:app.user&&app.user.uid?void 0:utils.escapeHTML(t.handle),title:utils.escapeHTML(t.title),body:t.text,tags:String(t.tags||"").split(",")}):t.action==="posts.reply"?F.get("/topics/"+t.tid,{},function(f,v){if(f)return a.error(f);g.newReply({save_id:t.save_id,tid:t.tid,toPid:t.toPid,title:v.title,body:t.text})}):t.action==="posts.edit"&&g.editPost({save_id:t.save_id,pid:t.pid,title:t.title?utils.escapeHTML(t.title):void 0,body:t.text})}).apply(null,s)}).catch(l.oe)}function x(e){var t;try{t=window[e];var n="__storage_test__";return t.setItem(n,n),t.removeItem(n),!0}catch(o){return o instanceof DOMException&&(o.code===22||o.code===1014||o.name==="QuotaExceededError"||o.name==="NS_ERROR_DOM_QUOTA_REACHED")&&t&&t.length!==0}}return i}.apply(S,p),b!==void 0&&(y.exports=b)},35729:(y,S,l)=>{"use strict";var p,b;p=[l(83713),l(38259),l(62023),l(10577)],b=function(F,a,i,r){var c={},d={picture:function(){var e=this;e.find("#files").click()},upload:function(){var e=this;e.find("#files").click()},thumbs:function(){c.exitFullscreen();var e=this;Promise.all([l.e(61006),l.e(42265),l.e(49915),l.e(92497)]).then(function(){var t=[l(44541)];(function(n){const o=e.get(0).getAttribute("data-uuid"),s=n.posts[o];(s.action==="topics.post"||s.action==="posts.edit"&&s.isMain)&&i.modal.open({id:o,pid:s.pid}).then(()=>{e.trigger("thumb.uploaded"),n.updateThumbCount(o,e)})}).apply(null,t)}).catch(l.oe)},tags:function(){var e=this;e.find(".tags-container").toggleClass("hidden")},zen:function(){var e=this;$(window).one("resize",function(){function t(){r.isFullscreen||(app.toggleNavbar(!0),$("html").removeClass("zen-mode"),a.reposition(e),$(window).off("resize",t))}r.isFullscreen&&(app.toggleNavbar(!1),$("html").addClass("zen-mode"),e.find(".write").focus(),$(window).on("resize",t),$(window).one("action:composer.topics.post action:composer.posts.reply action:composer.posts.edit action:composer.discard",r.exit))}),r.toggle(e.get(0)),$(window).trigger("action:composer.fullscreen",{postContainer:e})}},m=[];c.exitFullscreen=function(){r.isEnabled&&r.isFullscreen&&r.exit()},c.addComposerButtons=function(){const e=$(".formatting-bar .formatting-group #fileForm");m.forEach(t=>{let n="";Array.isArray(t.dropdownItems)&&t.dropdownItems.length?n=x(t):n=`
					<li data-format="${t.name}" title="${t.title||""}" href="#" class="btn btn-sm btn-link text-reset position-relative" tabindex="-1">
						<i class="${t.iconClass}"></i>
					</li>
				`,e.before(n)})};function x(e){const t=e.dropdownItems.map(function(n){let o="";return n.badge&&(o='<span class="px-1 position-absolute top-0 start-100 translate-middle-x badge rounded text-bg-info"></span>'),`
				<li data-format="${n.name}">
					<a href="#" class="dropdown-item rounded-1 position-relative">
						<i class="${n.iconClass} text-secondary"></i> ${n.text}
						${o}
					</a>
				</li>
			`});return`
			<li class="dropdown bottom-sheet" tab-index="-1">
				<button class="btn btn-sm btn-link text-reset" data-bs-toggle="dropdown" title="${e.title}">
					<i class="${e.iconClass}"></i>
				</button>
				<ul class="dropdown-menu p-1">
				${t}
				</ul>
			</li>
		`}return c.addButton=function(e,t,n,o){o=o||e.replace("fa fa-",""),d[o]=t,m.push({name:o,iconClass:e,title:n})},c.addDropdown=function(e){m.push({iconClass:e.iconClass,title:e.title,dropdownItems:e.dropdownItems}),e.dropdownItems.forEach(t=>{t.name&&t.onClick&&(d[t.name]=t.onClick)})},c.getDispatchTable=function(){return d},c.addButtonDispatch=function(e,t){d[e]=t},c.addHandler=function(e){e.on("click",".formatting-bar li[data-format]",function(t){var n=$(this).attr("data-format"),o=$(this).parents('[component="composer"]').find("textarea")[0];d.hasOwnProperty(n)&&(d[n].call(e,o,o.selectionStart,o.selectionEnd,t),F.render(e))})},c}.apply(S,p),b!==void 0&&(y.exports=b)},51077:(y,S,l)=>{"use strict";var p,b;p=[l(85233)],b=function(F){var a={};return a.render=function(i,r){if(r=r||function(){},!i.find(".preview-container").is(":visible"))return r();var c=i.find("textarea");socket.emit("plugins.composer.renderPreview",c.val(),function(d,m){d||(m=$("<div>"+m+"</div>"),m.find("img:not(.not-responsive)").addClass("img-fluid"),i.find(".preview").html(m),F.fire("action:composer.preview",{postContainer:i,preview:m}),r())})},a.matchScroll=function(i){if(i.find(".preview-container").is(":visible")){var r=i.find("textarea"),c=i.find(".preview");if(r.length&&c.length){var d=r[0].scrollHeight-r.height();if(d===0)return;var m=r.scrollTop()/d;c.scrollTop(Math.max(c[0].scrollHeight-c.height(),0)*m)}}},a.handleToggler=function(i){const r=i.get(0);a.env=utils.findBootstrapEnvironment();const c=["xs","sm"].includes(a.env),d=r.querySelector('.formatting-bar [data-action="preview"]'),m=d.querySelector(".show-text"),x=d.querySelector(".hide-text"),e=localStorage.getItem("composer:previewToggled"),t=config["composer-default"].hidePreviewOnOpen==="on";let n=!c&&(e===null&&!t||e);const o=r.querySelector(".preview-container"),s=r.querySelector(".write-container");if(!d)return;function g(f){c?(o.classList.toggle("hide",!1),s.classList.toggle("maximized",!1),o.classList.toggle("d-none",!f),o.classList.toggle("d-flex",f),o.classList.toggle("w-100",f),s.classList.toggle("d-flex",!f),s.classList.toggle("d-none",f),s.classList.toggle("w-100",!f)):(o.classList.toggle("hide",!f),s.classList.toggle("w-50",f),s.classList.toggle("w-100",!f),localStorage.setItem("composer:previewToggled",f)),m.classList.toggle("hide",f),x.classList.toggle("hide",!f),f&&a.render(i),a.matchScroll(i)}a.toggle=g,d.addEventListener("click",f=>{f.button===0&&(n=!n,g(n))}),g(n)},a}.apply(S,p),b!==void 0&&(y.exports=b)},65616:(y,S,l)=>{"use strict";var p,b;p=[l(27145)],b=function(F){var a={},i=0,r=.3,c=.05,d=768,m=$("body"),x=$(window),e=$('[component="navbar"]');const t=document.getElementById("content");var n=e[0];function o(){return localStorage.getItem("composer:resizeRatio")||.5}function s(u){localStorage.setItem("composer:resizeRatio",Math.min(u,1))}function g(){var u;n?u=n.getBoundingClientRect():u={bottom:0};var h=Math.max(u.bottom,0),E={top:0,left:0,right:window.innerWidth,bottom:window.innerHeight};return E.width=E.right,E.height=E.bottom,E.boundedTop=h,E.boundedHeight=E.bottom-h,E}function f(u,h){var E=g(),A=u[0],M=window.getComputedStyle(A),B=parseInt(M.getPropertyValue("min-height"),10),T=Math.max(B/window.innerHeight,r);if(E.width>=d){const O=(E.height-E.boundedHeight)/E.height;h=Math.min(Math.max(h,T+O),1);var D=h*E.boundedHeight/E.height;A.style.top=((1-D)*100).toString()+"%";var L=A.getBoundingClientRect();t.style.paddingBottom=(L.bottom-L.top).toString()+"px"}else A.style.top=0,t.style.paddingBottom=0;u.ratio=h,F.updateActive(u.attr("data-uuid"))}var v=f,P=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame;return P&&(v=function(u,h){P(function(){f(u,h),setTimeout(function(){x.trigger("action:composer.resize"),u.trigger("action:composer.resize")},0)})}),a.reposition=function(u){var h=o();h>=1-c&&(h=1,u.addClass("maximized")),v(u,h)},a.maximize=function(u,h){h?v(u,1):a.reposition(u)},a.handleResize=function(u){var h=0,E=0,A=0,M=u.find(".resizer"),B=M[0];function T(w){var z=B.getBoundingClientRect(),R=(z.top+z.bottom)/2;h=(R-w.clientY)/2,E=w.clientY,x.on("mousemove",D),x.on("mouseup",L),m.on("touchmove",O)}function D(w){var z=w.clientY-h,R=g(),I=(R.height-z)/R.boundedHeight;v(u,I)}function L(w){w.preventDefault(),A=w.clientY,u.find("textarea").focus(),x.off("mousemove",D),x.off("mouseup",L),m.off("touchmove",O);var z=A-h,R=g(),I=(R.height-z)/R.boundedHeight;A-E===0&&u.hasClass("maximized")?(u.removeClass("maximized"),I=!i||i>=1-c?.5:i,v(u,I)):A-E===0||I>=1-c?(v(u,1),u.addClass("maximized"),i=I):u.removeClass("maximized"),s(I)}function O(w){w.preventDefault(),D(w.touches[0])}M.on("mousedown",function(w){w.button===0&&(w.preventDefault(),T(w))}).on("touchstart",function(w){w.preventDefault(),T(w.touches[0])}).on("touchend",L)},a}.apply(S,p),b!==void 0&&(y.exports=b)},10577:y=>{/*!
* screenfull
* v5.2.0 - 2021-11-03
* (c) Sindre Sorhus; MIT License
*/(function(){"use strict";var S=typeof window<"u"&&typeof window.document<"u"?window.document:{},l=y.exports,p=function(){for(var a,i=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],r=0,c=i.length,d={};r<c;r++)if(a=i[r],a&&a[1]in S){for(r=0;r<a.length;r++)d[i[0][r]]=a[r];return d}return!1}(),b={change:p.fullscreenchange,error:p.fullscreenerror},F={request:function(a,i){return new Promise(function(r,c){var d=function(){this.off("change",d),r()}.bind(this);this.on("change",d),a=a||S.documentElement;var m=a[p.requestFullscreen](i);m instanceof Promise&&m.then(d).catch(c)}.bind(this))},exit:function(){return new Promise(function(a,i){if(!this.isFullscreen){a();return}var r=function(){this.off("change",r),a()}.bind(this);this.on("change",r);var c=S[p.exitFullscreen]();c instanceof Promise&&c.then(r).catch(i)}.bind(this))},toggle:function(a,i){return this.isFullscreen?this.exit():this.request(a,i)},onchange:function(a){this.on("change",a)},onerror:function(a){this.on("error",a)},on:function(a,i){var r=b[a];r&&S.addEventListener(r,i,!1)},off:function(a,i){var r=b[a];r&&S.removeEventListener(r,i,!1)},raw:p};if(!p){l?y.exports={isEnabled:!1}:window.screenfull={isEnabled:!1};return}Object.defineProperties(F,{isFullscreen:{get:function(){return!!S[p.fullscreenElement]}},element:{enumerable:!0,get:function(){return S[p.fullscreenElement]}},isEnabled:{enumerable:!0,get:function(){return!!S[p.fullscreenEnabled]}}}),l?y.exports=F:window.screenfull=F})()}}]);
